function e(e){return Object.keys(e).reduce(((t,r)=>{var s=e[r];return t[r]=Object.assign({},s),!n(s.value)||function(e){return"[object Function]"===Object.prototype.toString.call(e)}(s.value)||Array.isArray(s.value)||(t[r].value=Object.assign({},s.value)),Array.isArray(s.value)&&(t[r].value=s.value.slice(0)),t}),{})}function t(e){if(e)try{return JSON.parse(e)}catch(t){return e}}function r(e,t,r){if(null==r||!1===r)return e.removeAttribute(t);let n=JSON.stringify(r);e.__updating[t]=!0,"true"===n&&(n=""),e.setAttribute(t,n),Promise.resolve().then((()=>delete e.__updating[t]))}function n(e){return null!=e&&("object"==typeof e||"function"==typeof e)}let s;function i(n,i){const o=Object.keys(i);return class extends n{static get observedAttributes(){return o.map((e=>i[e].attribute))}constructor(){super(),this.__initialized=!1,this.__released=!1,this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props={}}connectedCallback(){if(!this.__initialized){this.__releaseCallbacks=[],this.__propertyChangedCallbacks=[],this.__updating={},this.props=function(n,s){const i=e(s);return Object.keys(s).forEach((e=>{const s=i[e],o=n.getAttribute(s.attribute),a=n[e];o&&(s.value=s.parse?t(o):o),null!=a&&(s.value=Array.isArray(a)?a.slice(0):a),s.reflect&&r(n,s.attribute,s.value),Object.defineProperty(n,e,{get:()=>s.value,set(t){var n=s.value;s.value=t,s.reflect&&r(this,s.attribute,s.value);for(let r=0,s=this.__propertyChangedCallbacks.length;r<s;r++)this.__propertyChangedCallbacks[r](e,t,n)},enumerable:!0,configurable:!0})})),i}(this,i);var n=function(e){return Object.keys(e).reduce(((t,r)=>(t[r]=e[r].value,t)),{})}(this.props),o=this.Component,a=s;try{(s=this).__initialized=!0,function(e){return"function"==typeof e&&0===e.toString().indexOf("class")}(o)?new o(n,{element:this}):o(n,{element:this})}finally{s=a}}}async disconnectedCallback(){if(await Promise.resolve(),!this.isConnected){this.__propertyChangedCallbacks.length=0;for(var e=null;e=this.__releaseCallbacks.pop();)e(this);delete this.__initialized,this.__released=!0}}attributeChangedCallback(e,r,n){!this.__initialized||this.__updating[e]||(e=this.lookupProp(e))in i&&(null==n&&!this[e]||(this[e]=i[e].parse?t(n):n))}lookupProp(e){if(i)return o.find((t=>e===t||e===i[t].attribute))}get renderRoot(){return this.shadowRoot||this.attachShadow({mode:"open"})}addReleaseCallback(e){this.__releaseCallbacks.push(e)}addPropertyChangedCallback(e){this.__propertyChangedCallbacks.push(e)}}}function o(e,t={},r={}){const{BaseElement:s=HTMLElement,extension:o}=r;return r=>{if(!e)throw new Error("tag is required to register a Component");let a=customElements.get(e);return a?a.prototype.Component=r:((a=i(s,function(e){return e?Object.keys(e).reduce(((t,r)=>{var s=e[r];return t[r]=n(s)&&"value"in s?s:{value:s},t[r].attribute||(t[r].attribute=function(e){return e.replace(/\.?([A-Z]+)/g,((e,t)=>"-"+t.toLowerCase())).replace("_","-").replace(/^-/,"")}(r)),t[r].parse="parse"in t[r]?t[r].parse:"string"!=typeof t[r].value,t}),{}):{}}(t))).prototype.Component=r,a.prototype.registeredTag=e,customElements.define(e,a,o)),a}}const a=Symbol("solid-proxy"),l=Symbol("solid-track"),h={equals:(e,t)=>e===t};let c=D;const u=1,d=2,p={owned:null,cleanups:null,context:null,owner:null};var f=null;let g=null,m=null,v=null,y=null,w=0;function b(e,t){const r=m,n=f,s=0===e.length,i=s?p:{owned:null,cleanups:null,context:null,owner:void 0===t?n:t},o=s?e:()=>e((()=>x((()=>F(i)))));f=i,m=null;try{return P(o,!0)}finally{m=r,f=n}}function _(e,t){const r={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},h,t):h).equals||void 0};return[S.bind(r),e=>("function"==typeof e&&(e=e(r.value)),A(r,e))]}function k(e,t,r){R(N(e,t,!1,u))}function E(e,t,r){c=L,(e=N(e,t,!1,u)).user=!0,y?y.push(e):R(e)}function T(e,t,r){return r=r?Object.assign({},h,r):h,(e=N(e,t,!0,0)).observers=null,e.observerSlots=null,e.comparator=r.equals||void 0,R(e),S.bind(e)}function x(e){if(null===m)return e();var t=m;m=null;try{return e()}finally{m=t}}function I(e){E((()=>x(e)))}function C(e){return null!==f&&(null===f.cleanups?f.cleanups=[e]:f.cleanups.push(e)),e}function S(){var e;return this.sources&&this.state&&(this.state===u?R(this):(e=v,v=null,P((()=>M(this)),!1),v=e)),m&&(e=this.observers?this.observers.length:0,m.sources?(m.sources.push(this),m.sourceSlots.push(e)):(m.sources=[this],m.sourceSlots=[e]),this.observers?(this.observers.push(m),this.observerSlots.push(m.sources.length-1)):(this.observers=[m],this.observerSlots=[m.sources.length-1])),this.value}function A(e,t,r){var n=e.value;return e.comparator&&e.comparator(n,t)||(e.value=t,e.observers&&e.observers.length&&P((()=>{for(let n=0;n<e.observers.length;n+=1){var t=e.observers[n],r=g&&g.running;r&&g.disposed.has(t),(r?t.tState:t.state)||((t.pure?v:y).push(t),t.observers&&U(t)),r||(t.state=u)}if(1e6<v.length)throw v=[],new Error}),!1)),t}function R(e){var t,r,n;e.fn&&(F(e),t=f,r=m,n=w,function(e,t,r){let n;try{n=e.fn(t)}catch(t){return e.pure&&(e.state=u,e.owned&&e.owned.forEach(F),e.owned=null),e.updatedAt=r+1,j(t)}(!e.updatedAt||e.updatedAt<=r)&&(null!=e.updatedAt&&"observers"in e?A(e,n):e.value=n,e.updatedAt=r)}(m=f=e,e.value,n),m=r,f=t)}function N(e,t,r,n=u,s){return e={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:f,context:null,pure:r},null!==f&&f!==p&&(f.owned?f.owned.push(e):f.owned=[e]),e}function O(e){if(0!==e.state){if(e.state===d)return M(e);if(e.suspense&&x(e.suspense.inFallback))return e.suspense.effects.push(e);const r=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<w);)e.state&&r.push(e);for(let n=r.length-1;0<=n;n--){var t;(e=r[n]).state===u?R(e):e.state===d&&(t=v,v=null,P((()=>M(e,r[0])),!1),v=t)}}}function P(e,t){if(v)return e();let r=!1;t||(v=[]),y?r=!0:y=[],w++;try{var n=e();return function(e){if(v&&(D(v),v=null),!e){const e=y;y=null,e.length&&P((()=>c(e)),!1)}}(r),n}catch(e){r||(y=null),v=null,j(e)}}function D(e){for(let t=0;t<e.length;t++)O(e[t])}function L(e){let t,r=0;for(t=0;t<e.length;t++){var n=e[t];n.user?e[r++]=n:O(n)}for(t=0;t<r;t++)O(e[t])}function M(e,t){for(let s=e.state=0;s<e.sources.length;s+=1){var r,n=e.sources[s];n.sources&&((r=n.state)===u?n!==t&&(!n.updatedAt||n.updatedAt<w)&&O(n):r===d&&M(n,t))}}function U(e){for(let r=0;r<e.observers.length;r+=1){var t=e.observers[r];t.state||(t.state=d,(t.pure?v:y).push(t),t.observers&&U(t))}}function F(e){let t;if(e.sources)for(;e.sources.length;){var r,n,s=e.sources.pop(),i=e.sourceSlots.pop(),o=s.observers;o&&o.length&&(r=o.pop(),n=s.observerSlots.pop(),i<o.length)&&(o[r.sourceSlots[n]=i]=r,s.observerSlots[i]=n)}if(e.owned){for(t=e.owned.length-1;0<=t;t--)F(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;0<=t;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function j(e){throw e}const B=Symbol("fallback");function V(e){for(let t=0;t<e.length;t++)e[t]()}function z(e,t){return x((()=>e(t||{})))}function $(){return!0}const q={get:(e,t,r)=>t===a?r:e.get(t),has:(e,t)=>t===a||e.has(t),set:$,deleteProperty:$,getOwnPropertyDescriptor:(e,t)=>({configurable:!0,enumerable:!0,get:()=>e.get(t),set:$,deleteProperty:$}),ownKeys:e=>e.keys()};function H(e){return(e="function"==typeof e?e():e)||{}}function G(...e){let t=!1;for(let n=0;n<e.length;n++){var r=e[n];t=t||!!r&&a in r,e[n]="function"==typeof r?(t=!0,T(r)):r}if(t)return new Proxy({get(t){for(let n=e.length-1;0<=n;n--){var r=H(e[n])[t];if(void 0!==r)return r}},has(t){for(let r=e.length-1;0<=r;r--)if(t in H(e[r]))return!0;return!1},keys(){var t=[];for(let r=0;r<e.length;r++)t.push(...Object.keys(H(e[r])));return[...new Set(t)]}},q);var n={};for(let t=e.length-1;0<=t;t--)if(e[t])for(const r in Object.getOwnPropertyDescriptors(e[t]))r in n||Object.defineProperty(n,r,{enumerable:!0,get(){for(let n=e.length-1;0<=n;n--){var t=(e[n]||{})[r];if(void 0!==t)return t}}});return n}function K(e,...t){const r=new Set(t.flat());var n;if(a in e)return(n=t.map((t=>new Proxy({get:r=>t.includes(r)?e[r]:void 0,has:r=>t.includes(r)&&r in e,keys:()=>t.filter((t=>t in e))},q)))).push(new Proxy({get:t=>r.has(t)?void 0:e[t],has:t=>!r.has(t)&&t in e,keys:()=>Object.keys(e).filter((e=>!r.has(e)))},q)),n;const s=Object.getOwnPropertyDescriptors(e);return t.push(Object.keys(s).filter((e=>!r.has(e)))),t.map((t=>{var r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&Object.defineProperty(r,i,s[i]||{get:()=>e[i],set:()=>!0,enumerable:!0})}return r}))}function W(e){var t="fallback"in e&&{fallback:()=>e.fallback};return T(function(e,t,r={}){let n=[],s=[],i=[],o=0,a=1<t.length?[]:null;return C((()=>V(i))),()=>{let h,c,u=e()||[];return u[l],x((()=>{let e,t,l,p,f,g,m,v,y,w=u.length;if(0===w)0!==o&&(V(i),i=[],n=[],s=[],o=0,a=a&&[]),r.fallback&&(n=[B],s[0]=b((e=>(i[0]=e,r.fallback()))),o=1);else if(0===o){for(s=new Array(w),c=0;c<w;c++)n[c]=u[c],s[c]=b(d);o=w}else{for(l=new Array(w),p=new Array(w),a&&(f=new Array(w)),g=0,m=Math.min(o,w);g<m&&n[g]===u[g];g++);for(m=o-1,v=w-1;m>=g&&v>=g&&n[m]===u[v];m--,v--)l[v]=s[m],p[v]=i[m],a&&(f[v]=a[m]);for(e=new Map,t=new Array(v+1),c=v;c>=g;c--)y=u[c],h=e.get(y),t[c]=void 0===h?-1:h,e.set(y,c);for(h=g;h<=m;h++)y=n[h],void 0!==(c=e.get(y))&&-1!==c?(l[c]=s[h],p[c]=i[h],a&&(f[c]=a[h]),c=t[c],e.set(y,c)):i[h]();for(c=g;c<w;c++)c in l?(s[c]=l[c],i[c]=p[c],a&&(a[c]=f[c],a[c](c))):s[c]=b(d);s=s.slice(0,o=w),n=u.slice(0)}return s}));function d(e){var r;return i[c]=e,a?([e,r]=_(c),a[c]=r,t(u[c],e)):t(u[c])}}}((()=>e.each),e.children,t||void 0))}function Q(e){const t=e.keyed,r=T((()=>e.when),void 0,{equals:(e,r)=>t?e===r:!e==!r});return T((()=>{const n=r();if(n){const s=e.children;return"function"==typeof s&&0<s.length?x((()=>s(t?n:()=>{if(x(r))return e.when;throw(e=>`Stale read from <${e}>.`)("Show")}))):s}return e.fallback}),void 0,void 0)}const J=new Set(["className","value","readOnly","formNoValidate","isMap","noModule","playsInline","allowfullscreen","async","autofocus","autoplay","checked","controls","default","disabled","formnovalidate","hidden","indeterminate","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","seamless","selected"]),Y=new Set(["innerHTML","textContent","innerText","children"]),X=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Z=Object.assign(Object.create(null),{class:"className",formnovalidate:{$:"formNoValidate",BUTTON:1,INPUT:1},ismap:{$:"isMap",IMG:1},nomodule:{$:"noModule",SCRIPT:1},playsinline:{$:"playsInline",VIDEO:1},readonly:{$:"readOnly",INPUT:1,TEXTAREA:1}});const ee=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),te={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};const re="_$DX_DELEGATE";function ne(e,t,r){let n;const s=()=>{var t=document.createElement("template");return t.innerHTML=e,(r?t.content.firstChild:t.content).firstChild};return(t=t?()=>(n=n||s()).cloneNode(!0):()=>x((()=>document.importNode(n=n||s(),!0)))).cloneNode=t}function se(e,t=window.document){var r=t[re]||(t[re]=new Set);for(let s=0,i=e.length;s<i;s++){var n=e[s];r.has(n)||(r.add(n),t.addEventListener(n,de))}}function ie(e,t,r){null==r?e.removeAttribute(t):e.setAttribute(t,r)}function oe(e,t){null==t?e.removeAttribute("class"):e.className=t}function ae(e,t={},r,n){const s={};return n||k((()=>s.children=pe(e,t.children,s.children))),k((()=>t.ref&&t.ref(e))),k((()=>function(e,t,r,n,s={},i=!1){t=t||{};for(const n in s)n in t||"children"!==n&&(s[n]=ue(e,n,null,s[n],r,i));for(const a in t){var o;"children"===a?n||pe(e,t.children):(o=t[a],s[a]=ue(e,a,o,s[a],r,i))}}(e,t,r,!0,s,!0))),s}function le(e,t,r){return x((()=>e(t,r)))}function he(e,t,r,n){if(void 0!==r&&(n=n||[]),"function"!=typeof t)return pe(e,t,n,r);k((n=>pe(e,t(),n,r)),n)}function ce(e,t,r){var n=t.trim().split(/\s+/);for(let t=0,s=n.length;t<s;t++)e.classList.toggle(n[t],r)}function ue(e,t,r,n,s,i){let o,a,l,h,c;var u;return"style"===t?function(e,t,r){if(!t)return r?ie(e,"style"):t;var n=e.style;if("string"==typeof t)return n.cssText=t;let s,i;for(i in"string"==typeof r&&(n.cssText=r=void 0),t=t||{},r=r||{})null==t[i]&&n.removeProperty(i),delete r[i];for(i in t)(s=t[i])!==r[i]&&(n.setProperty(i,s),r[i]=s);return r}(e,r,n):"classList"===t?function(e,t,r={}){var n=Object.keys(t||{}),s=Object.keys(r);let i,o;for(i=0,o=s.length;i<o;i++){var a=s[i];a&&"undefined"!==a&&!t[a]&&(ce(e,a,!1),delete r[a])}for(i=0,o=n.length;i<o;i++){var l=n[i],h=!!t[l];l&&"undefined"!==l&&r[l]!==h&&h&&(ce(e,l,!0),r[l]=h)}return r}(e,r,n):r===n?n:("ref"===t?i||r(e):"on:"===t.slice(0,3)?(i=t.slice(3),n&&e.removeEventListener(i,n),r&&e.addEventListener(i,r)):"oncapture:"===t.slice(0,10)?(i=t.slice(10),n&&e.removeEventListener(i,n,!0),r&&e.addEventListener(i,r,!0)):"on"===t.slice(0,2)?(i=t.slice(2).toLowerCase(),!(u=ee.has(i))&&n&&(n=Array.isArray(n)?n[0]:n,e.removeEventListener(i,n)),(u||r)&&(function(e,t,r,n){if(n)Array.isArray(r)?(e["$$"+t]=r[0],e[`$$${t}Data`]=r[1]):e["$$"+t]=r;else if(Array.isArray(r)){const n=r[0];e.addEventListener(t,r[0]=t=>n.call(e,r[1],t))}else e.addEventListener(t,r)}(e,i,r,u),u)&&se([i])):"attr:"===t.slice(0,5)?ie(e,t.slice(5),r):(c="prop:"===t.slice(0,5))||(l=Y.has(t))||!s&&((h=function(e,t){return"object"==typeof(e=Z[e])?e[t]?e.$:void 0:e}(t,e.tagName))||(a=J.has(t)))||(o=e.nodeName.includes("-"))?(c&&(t=t.slice(5),a=!0),"class"===t||"className"===t?oe(e,r):!o||a||l?e[h||t]=r:e[function(e){return e.toLowerCase().replace(/-([a-z])/g,((e,t)=>t.toUpperCase()))}(t)]=r):(n=s&&-1<t.indexOf(":")&&te[t.split(":")[0]])?function(e,t,r,n){null==n?e.removeAttributeNS(t,r):e.setAttributeNS(t,r,n)}(e,n,t,r):ie(e,X[t]||t,r),r)}function de(e){var t="$$"+e.type;let r=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==r&&Object.defineProperty(e,"target",{configurable:!0,value:r}),Object.defineProperty(e,"currentTarget",{configurable:!0,get:()=>r||document});r;){var n=r[t];if(n&&!r.disabled){var s=r[t+"Data"];if(void 0!==s?n.call(r,s,e):n.call(r,e),e.cancelBubble)return}r=r._$host||r.parentNode||r.host}}function pe(e,t,r,n,s){for(;"function"==typeof r;)r=r();if(t!==r){var i=typeof t,o=void 0!==n;if(e=o&&r[0]&&r[0].parentNode||e,"string"==i||"number"==i)if("number"==i&&(t=t.toString()),o){let s=r[0];s&&3===s.nodeType?s.data=t:s=document.createTextNode(t),r=me(e,r,n,s)}else r=""!==r&&"string"==typeof r?e.firstChild.data=t:e.textContent=t;else if(null==t||"boolean"==i)r=me(e,r,n);else{if("function"==i)return k((()=>{let s=t();for(;"function"==typeof s;)s=s();r=pe(e,s,r,n)})),()=>r;if(Array.isArray(t)){const a=[];if(i=r&&Array.isArray(r),fe(a,t,r,s))return k((()=>r=pe(e,a,r,n,!0))),()=>r;if(0===a.length){if(r=me(e,r,n),o)return r}else i?0===r.length?ge(e,a,n):function(e,t,r){let n=r.length,s=t.length,i=n,o=0,a=0,l=t[s-1].nextSibling,h=null;for(;o<s||a<i;)if(t[o]===r[a])o++,a++;else{for(;t[s-1]===r[i-1];)s--,i--;if(s===o)for(var c=i<n?a?r[a-1].nextSibling:r[i-a]:l;a<i;)e.insertBefore(r[a++],c);else if(i===a)for(;o<s;)h&&h.has(t[o])||t[o].remove(),o++;else if(t[o]===r[i-1]&&r[a]===t[s-1]){var u=t[--s].nextSibling;e.insertBefore(r[a++],t[o++].nextSibling),e.insertBefore(r[--i],u),t[s]=r[i]}else{if(!h){h=new Map;let e=a;for(;e<i;)h.set(r[e],e++)}var d=h.get(t[o]);if(null!=d)if(a<d&&d<i){let n,l=o,c=1;for(;++l<s&&l<i&&null!=(n=h.get(t[l]))&&n===d+c;)c++;if(c>d-a)for(var p=t[o];a<d;)e.insertBefore(r[a++],p);else e.replaceChild(r[a++],t[o++])}else o++;else t[o++].remove()}}}(e,r,a):(r&&me(e),ge(e,a));r=a}else if(t instanceof Node){if(Array.isArray(r)){if(o)return r=me(e,r,n,t);me(e,r,null,t)}else null!=r&&""!==r&&e.firstChild?e.replaceChild(t,e.firstChild):e.appendChild(t);r=t}else console.warn("Unrecognized value. Skipped inserting",t)}}return r}function fe(e,t,r,n){let s=!1;for(let o=0,a=t.length;o<a;o++){let a=t[o],l=r&&r[o];if(a instanceof Node)e.push(a);else if(null!=a&&!0!==a&&!1!==a)if(Array.isArray(a))s=fe(e,a,l)||s;else if("function"==typeof a)if(n){for(;"function"==typeof a;)a=a();s=fe(e,Array.isArray(a)?a:[a],Array.isArray(l)?l:[l])||s}else e.push(a),s=!0;else{var i=String(a);l&&3===l.nodeType?(l.data=i,e.push(l)):e.push(document.createTextNode(i))}}return s}function ge(e,t,r=null){for(let n=0,s=t.length;n<s;n++)e.insertBefore(t[n],r)}function me(e,t,r,n){if(void 0===r)return e.textContent="";var s=n||document.createTextNode("");if(t.length){let n=!1;for(let a=t.length-1;0<=a;a--){var i,o=t[a];s!==o?(i=o.parentNode===e,n||a?i&&o.remove():i?e.replaceChild(s,o):e.insertBefore(s,r)):n=!0}}else e.insertBefore(s,r);return[s]}function ve(e){return(t,r)=>{const n=r.element;return b((s=>{const i=function(e){var t=Object.keys(e),r={};for(let n=0;n<t.length;n++){const[s,i]=_(e[t[n]]);Object.defineProperty(r,t[n],{get:s,set(e){i((()=>e))}})}return r}(t);n.addPropertyChangedCallback(((e,t)=>i[e]=t)),n.addReleaseCallback((()=>{n.renderRoot.textContent="",s()}));var o=e(i,r);return he(n.renderRoot,o)}),function(e){if(e.assignedSlot&&e.assignedSlot._$owner)return e.assignedSlot._$owner;let t=e.parentNode;for(;t&&!t._$owner&&(!t.assignedSlot||!t.assignedSlot._$owner);)t=t.parentNode;return(t&&t.assignedSlot?t.assignedSlot:e)._$owner}(n))}}function ye(e,t,r){return 2===arguments.length&&(r=t,t={}),o(e,t)(ve(r))}const we={chatflowid:"",apiHost:void 0,chatflowConfig:void 0,theme:void 0,observersConfig:void 0};var be='/*! tailwindcss v3.3.1 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-feature-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-bottom:1.2em;margin-top:1.2em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal;margin-bottom:1.25em;margin-top:1.25em;padding-left:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:disc;margin-bottom:1.25em;margin-top:1.25em;padding-left:1.625em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.25em}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-bottom:3em;margin-top:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){border-left-color:var(--tw-prose-quote-borders);border-left-width:.25rem;color:var(--tw-prose-quotes);font-style:italic;font-weight:500;margin-bottom:1.6em;margin-top:1.6em;padding-left:1em;quotes:"\\201C""\\201D""\\2018""\\2019"}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:2.25em;font-weight:800;line-height:1.1111111;margin-bottom:.8888889em;margin-top:0}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:900}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.5em;font-weight:700;line-height:1.3333333;margin-bottom:1em;margin-top:2em}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:800}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.25em;font-weight:600;line-height:1.6;margin-bottom:.6em;margin-top:1.6em}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;line-height:1.5;margin-bottom:.5em;margin-top:1.5em}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){display:block;margin-bottom:2em;margin-top:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.3125rem;box-shadow:0 0 0 1px rgb(var(--tw-prose-kbd-shadows)/10%),0 3px 0 rgb(var(--tw-prose-kbd-shadows)/10%);color:var(--tw-prose-kbd);font-family:inherit;font-size:.875em;font-weight:500;padding:.1875em .375em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:var(--tw-prose-pre-bg);border-radius:.375rem;color:var(--tw-prose-pre-code);font-size:.875em;font-weight:400;line-height:1.7142857;margin-bottom:1.7142857em;margin-top:1.7142857em;overflow-x:auto;padding:.8571429em 1.1428571em}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:transparent;border-radius:0;border-width:0;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.875em;line-height:1.7142857;margin-bottom:2em;margin-top:2em;table-layout:auto;text-align:left;width:100%}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-color:var(--tw-prose-th-borders);border-bottom-width:1px}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;padding-bottom:.5714286em;padding-left:.5714286em;padding-right:.5714286em;vertical-align:bottom}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-color:var(--tw-prose-td-borders);border-bottom-width:1px}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-color:var(--tw-prose-th-borders);border-top-width:1px}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-kbd:#111827;--tw-prose-kbd-shadows:17 24 39;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:rgba(0,0,0,.5);--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.5em;margin-top:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.375em}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(.prose>ul>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-left:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-right:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-right:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.pointer-events-none{pointer-events:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0}.bottom-0{bottom:0}.bottom-20{bottom:80px}.bottom-24{bottom:96px}.left-0{left:0}.right-0{right:0}.top-0{top:0}.z-0{z-index:0}.z-10{z-index:10}.z-40{z-index:40}.z-50{z-index:50}.m-0{margin:0}.m-auto{margin:auto}.my-2{margin-bottom:8px;margin-top:8px}.-ml-1{margin-left:-4px}.mb-2{margin-bottom:8px}.ml-1{margin-left:4px}.ml-1\\.5{margin-left:6px}.ml-2{margin-left:8px}.mr-1{margin-right:4px}.mr-2{margin-right:8px}.mr-3{margin-right:12px}.mr-\\[10px\\]{margin-right:10px}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.hidden{display:none}.h-10{height:40px}.h-12{height:48px}.h-16{height:64px}.h-2{height:8px}.h-32{height:128px}.h-5{height:20px}.h-6{height:24px}.h-7{height:28px}.h-9{height:36px}.h-\\[50px\\]{height:50px}.h-\\[58px\\]{height:58px}.h-full{height:100%}.max-h-\\[704px\\]{max-height:704px}.min-h-full{min-height:100%}.w-10{width:40px}.w-12{width:48px}.w-16{width:64px}.w-2{width:8px}.w-5{width:20px}.w-6{width:24px}.w-7{width:28px}.w-9{width:36px}.w-\\[200px\\]{width:200px}.w-full{width:100%}.min-w-full{min-width:100%}.max-w-\\[128px\\]{max-width:128px}.max-w-full{max-width:100%}.flex-1{flex:1 1 0%}.flex-shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.flex-grow-0{flex-grow:0}.basis-auto{flex-basis:auto}.-rotate-180{--tw-rotate:-180deg}.-rotate-180,.rotate-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-0{--tw-rotate:0deg}.scale-0{--tw-scale-x:0;--tw-scale-y:0}.scale-0,.scale-100{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-100{--tw-scale-x:1;--tw-scale-y:1}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes fade-in{0%{opacity:0}to{opacity:1}}.animate-fade-in{animation:fade-in .3s ease-out}@keyframes spin{to{transform:rotate(1turn)}}.animate-spin{animation:spin 1s linear infinite}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:8px}.gap-3{gap:12px}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.overflow-y-scroll{overflow-y:scroll}.scroll-smooth{scroll-behavior:smooth}.whitespace-pre-wrap{white-space:pre-wrap}.rounded-\\[10px\\]{border-radius:10px}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:8px}.rounded-md{border-radius:6px}.rounded-none{border-radius:0}.rounded-xl{border-radius:12px}.border{border-width:1px}.border-2{border-width:2px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-\\[\\#eeeeee\\]{--tw-border-opacity:1;border-color:rgb(238 238 238/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-black\\/10{background-color:rgba(0,0,0,.1)}.bg-black\\/60{background-color:rgba(0,0,0,.6)}.bg-gray-500{--tw-bg-opacity:1;background-color:rgb(107 114 128/var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity))}.bg-transparent{background-color:transparent}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-cover{background-size:cover}.bg-center{background-position:50%}.fill-transparent{fill:transparent}.stroke-2{stroke-width:2}.object-cover{-o-object-fit:cover;object-fit:cover}.p-0{padding:0}.p-1{padding:4px}.p-4{padding:16px}.px-2{padding-left:8px;padding-right:8px}.px-3{padding-left:12px;padding-right:12px}.px-4{padding-left:16px;padding-right:16px}.px-5{padding-left:20px;padding-right:20px}.px-\\[10px\\]{padding-left:10px;padding-right:10px}.py-1{padding-bottom:4px;padding-top:4px}.py-2{padding-bottom:8px;padding-top:8px}.py-4{padding-bottom:16px;padding-top:16px}.py-\\[10px\\]{padding-bottom:10px;padding-top:10px}.pb-1{padding-bottom:4px}.pb-\\[10px\\]{padding-bottom:10px}.pt-2{padding-top:8px}.pt-\\[6px\\]{padding-top:6px}.pt-\\[70px\\]{padding-top:70px}.text-left{text-align:left}.text-center{text-align:center}.text-\\[13px\\]{font-size:13px}.text-base{font-size:16px;line-height:24px}.text-sm{font-size:14px;line-height:20px}.text-xl{font-size:20px;line-height:28px}.font-semibold{font-weight:600}.text-transparent{color:transparent}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-25{opacity:.25}.opacity-75{opacity:.75}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.shadow-md,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-opacity{transition-duration:.15s;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-200{transition-duration:.2s}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}:host{--chatbot-container-bg-image:none;--chatbot-container-bg-color:transparent;--chatbot-container-font-family:"Open Sans";--chatbot-button-bg-color:#19b99a;--chatbot-button-color:#fff;--chatbot-host-bubble-bg-color:#f7f8ff;--chatbot-host-bubble-color:#303235;--chatbot-guest-bubble-bg-color:#19b99a;--chatbot-guest-bubble-color:#fff;--chatbot-input-bg-color:#fff;--chatbot-input-color:#303235;--chatbot-input-placeholder-color:#9095a0;--chatbot-header-bg-color:#fff;--chatbot-header-color:#303235;--chatbot-border-radius:6px;--PhoneInputCountryFlag-borderColor:transparent;--PhoneInput-color--focus:transparent}a{color:#16bed7;font-weight:500}a:hover{text-decoration:underline}pre{word-wrap:break-word;font-size:13px;margin:5px;overflow:auto;padding:5px;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;width:auto}.string{color:green}.number{color:#ff8c00}.boolean{color:blue}.null{color:#f0f}.key{color:#002b36}.scrollable-container::-webkit-scrollbar{display:none}.scrollable-container{-ms-overflow-style:none;scrollbar-width:none}.text-fade-in{transition:opacity .4s ease-in .2s}.bubble-typing{transition:width .4s ease-out,height .4s ease-out}.bubble1,.bubble2,.bubble3{background-color:var(--chatbot-host-bubble-color);opacity:.5}.bubble1,.bubble2{animation:chatBubbles 1s ease-in-out infinite}.bubble2{animation-delay:.3s}.bubble3{animation:chatBubbles 1s ease-in-out infinite;animation-delay:.5s}@keyframes chatBubbles{0%{transform:translateY(0)}50%{transform:translateY(-5px)}to{transform:translateY(0)}}button,input,textarea{font-weight:300}.slate-a{text-decoration:underline}.slate-html-container>div{min-height:24px}.slate-bold{font-weight:700}.slate-italic{font-style:oblique}.slate-underline{text-decoration:underline}.text-input::-moz-placeholder{color:#9095a0!important;opacity:1!important}.text-input::placeholder{color:#9095a0!important;opacity:1!important}.chatbot-container{background-color:var(--chatbot-container-bg-color);background-image:var(--chatbot-container-bg-image);font-family:Open Sans,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}.file-annotation-button{background-color:#02a0a0c2;border:1px solid #02a0a0c2;border-radius:var(--chatbot-border-radius);color:var(--chatbot-button-color)}.chatbot-button{background-color:#0042da;border:1px solid #0042da;border-radius:var(--chatbot-border-radius);color:var(--chatbot-button-color)}.chatbot-button.selectable{border:1px solid #0042da}.chatbot-button.selectable,.chatbot-host-bubble{background-color:#f7f8ff;color:var(--chatbot-host-bubble-color)}.chatbot-host-bubble>.bubble-typing{background-color:#f7f8ff;border:var(--chatbot-host-bubble-border);border-radius:6px}.chatbot-host-bubble iframe,.chatbot-host-bubble img,.chatbot-host-bubble video{border-radius:var(--chatbot-border-radius)}.chatbot-guest-bubble{background-color:#25c8fa;border-radius:6px;color:var(--chatbot-guest-bubble-color);margin-right:8px}.chatbot-input{background-color:#fff;border-radius:var(--chatbot-border-radius);box-shadow:0 2px 6px -1px rgba(0,0,0,.1);color:#303235}.chatbot-input-error-message{color:#303235}.chatbot-button>.send-icon{fill:var(--chatbot-button-color);stroke:var(--chatbot-button-color)}.chatbot-chat-view{max-width:800px}.ping span{background-color:#0042da}.rating-icon-container svg{stroke:#0042da;fill:#f7f8ff;height:42px;transition:fill .1s ease-out;width:42px}.rating-icon-container.selected svg{fill:#0042da}.rating-icon-container:hover svg{filter:brightness(.9)}.rating-icon-container:active svg{filter:brightness(.75)}.upload-progress-bar{background-color:#0042da;border-radius:var(--chatbot-border-radius)}.total-files-indicator{background-color:#0042da;color:var(--chatbot-button-color);font-size:10px}.chatbot-upload-input{transition:border-color .1s ease-out}.chatbot-upload-input.dragging-over{border-color:#0042da}.secondary-button{background-color:#f7f8ff;border-radius:var(--chatbot-border-radius);color:var(--chatbot-host-bubble-color)}.chatbot-country-select{color:#303235}.chatbot-country-select,.chatbot-date-input{background-color:#fff;border-radius:var(--chatbot-border-radius)}.chatbot-date-input{color:#303235;color-scheme:light}.chatbot-popup-blocked-toast{border-radius:var(--chatbot-border-radius)}.messagelist{border-radius:.5rem;height:100%;overflow-y:scroll;width:100%}.messagelistloading{display:flex;justify-content:center;margin-top:1rem;width:100%}.usermessage{padding:1rem 1.5rem}.usermessagewaiting-light{background:linear-gradient(270deg,#ede7f6,#e3f2fd,#ede7f6);background-position:-100% 0;background-size:200% 200%}.usermessagewaiting-dark,.usermessagewaiting-light{animation:loading-gradient 2s ease-in-out infinite;animation-direction:alternate;animation-name:loading-gradient;padding:1rem 1.5rem}.usermessagewaiting-dark{background:linear-gradient(270deg,#2e2352,#1d3d60,#2e2352);background-position:-100% 0;background-size:200% 200%;color:#ececf1}@keyframes loading-gradient{0%{background-position:-100% 0}to{background-position:100% 0}}.apimessage{animation:fadein .5s;padding:1rem 1.5rem}@keyframes fadein{0%{opacity:0}to{opacity:1}}.apimessage,.usermessage,.usermessagewaiting{display:flex}.markdownanswer{line-height:1.75}.markdownanswer a:hover{opacity:.8}.markdownanswer a{color:#16bed7;font-weight:500}.markdownanswer code{color:#15cb19;font-weight:500;white-space:pre-wrap!important}.markdownanswer ol,.markdownanswer ul{margin:1rem}.boticon,.usericon{border-radius:1rem;margin-right:1rem}.markdownanswer h1,.markdownanswer h2,.markdownanswer h3{font-size:inherit}.center{flex-direction:column;padding:10px;position:relative}.center,.cloud{align-items:center;display:flex;justify-content:center}.cloud{border-radius:.5rem;height:calc(100% - 50px);width:400px}input{background-color:transparent;border:none;font-family:Poppins,sans-serif;padding:10px}.flex-row{display:flex;flex-direction:row;gap:10px}.flex-column{display:flex;flex-direction:column;gap:10px}.centered-content{align-items:center;display:flex;justify-content:center}.choice-buttons-row,.job-bubble,.loading-jobs-message-container{background-color:#19b99a;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,.1);color:#fff;margin-bottom:15px;padding:10px}.job-message{font-size:16px;margin-bottom:10px}.job-card-wrapper{background-color:#fff;border:1px solid #eaeaea;border-radius:5px;margin-bottom:10px;margin-top:10px;padding:10px;transition:transform .3s ease}.job-card-wrapper:hover{transform:translateY(-3px)}.job-card h2{color:#000;font-size:18px;margin:0 0 10px}.job-card p{color:#666;font-size:14px;margin:5px 0}.choice-buttons-row{display:flex;gap:10px;justify-content:space-between}.ai-setting{background-color:#fff;border-radius:20px;color:#000;cursor:pointer;padding:8px 16px;transition:background-color .3s ease,transform .3s ease;width:100%}.ai-setting:hover{background-color:#06aa9f;transform:scale(1.05)}@media (max-width:768px){.job-listings{flex-wrap:wrap;justify-content:center}.choice-buttons-row,.job-bubble{align-items:center;flex-direction:column}}.hover\\:scale-110:hover{--tw-scale-x:1.1;--tw-scale-y:1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:brightness-90:hover{--tw-brightness:brightness(.9);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.active\\:scale-95:active{--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.active\\:brightness-75:active{--tw-brightness:brightness(.75);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.disabled\\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:opacity-50:disabled{opacity:.5}.disabled\\:brightness-100:disabled{--tw-brightness:brightness(1);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.group:hover .group-hover\\:flex{display:flex}@media (min-width:640px){.sm\\:right-5{right:20px}.sm\\:my-8{margin-bottom:32px;margin-top:32px}.sm\\:w-\\[400px\\]{width:400px}.sm\\:w-full{width:100%}.sm\\:max-w-lg{max-width:512px}.sm\\:p-0{padding:0}}';const _e=e=>null==e,ke=e=>null!=e,Ee=async e=>{try{var t="string"==typeof e?e:e.url,r=await fetch(t,{method:"string"==typeof e?"GET":e.method,mode:"cors",headers:"string"!=typeof e&&ke(e.body)?{"Content-Type":"application/json"}:void 0,body:"string"!=typeof e&&ke(e.body)?JSON.stringify(e.body):void 0});let s;var n=r.headers.get("Content-Type");if(s=n&&n.includes("application/json")?await r.json():"string"!=typeof e&&"blob"===e.type?await r.blob():await r.text(),r.ok)return{data:s};{let e;throw e="object"==typeof s&&"error"in s?s.error:s||r.statusText}}catch(e){return console.error(e),{error:e}}},Te=ne('<svg viewBox="0 0 24 24"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">'),xe=ne('<img alt="Bubble button icon">'),Ie=ne('<button part="button"><svg viewBox="0 0 24 24"><path fill-rule="evenodd" clip-rule="evenodd" d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z">'),Ce=e=>{{const t=Ie(),r=t.firstChild;return t.$$click=()=>e.toggleBot(),t.style.setProperty("z-index","42424242"),he(t,z(Q,{get when(){return _e(e.customIconSrc)},keyed:!0,get children(){const t=Te();return k((r=>{var n=e.iconColor??"white",s="stroke-2 fill-transparent absolute duration-200 transition "+(e.isBotOpened?"scale-0 opacity-0":"scale-100 opacity-100")+("large"===e.size?" w-9":" w-7");return n!==r._v$&&(null!=(r._v$=n)?t.style.setProperty("stroke",n):t.style.removeProperty("stroke")),s!==r._v$2&&ie(t,"class",r._v$2=s),r}),{_v$:void 0,_v$2:void 0}),t}}),r),he(t,z(Q,{get when(){return e.customIconSrc},get children(){const t=xe();return k((r=>{var n=e.customIconSrc,s="rounded-full object-cover"+(e.isBotOpened?"scale-0 opacity-0":"scale-100 opacity-100")+("large"===e.size?" w-9 h-9":" w-7 h-7");return n!==r._v$3&&ie(t,"src",r._v$3=n),s!==r._v$4&&oe(t,r._v$4=s),r}),{_v$3:void 0,_v$4:void 0}),t}}),r),k((n=>{var s="fixed shadow-md rounded-full hover:scale-110 active:scale-95 transition-transform duration-200 flex justify-center items-center animate-fade-in"+("large"===e.size?" w-16 h-16":" w-12 h-12"),i=e.backgroundColor??"#3B81F6",o=e.right?e.right.toString()+"px":"20px",a=e.bottom?e.bottom.toString()+"px":"20px",l=e.iconColor??"white",h="absolute duration-200 transition "+(e.isBotOpened?"scale-100 rotate-0 opacity-100":"scale-0 -rotate-180 opacity-0")+("large"===e.size?" w-9":" w-7");return s!==n._v$5&&oe(t,n._v$5=s),i!==n._v$6&&(null!=(n._v$6=i)?t.style.setProperty("background-color",i):t.style.removeProperty("background-color")),o!==n._v$7&&(null!=(n._v$7=o)?t.style.setProperty("right",o):t.style.removeProperty("right")),a!==n._v$8&&(null!=(n._v$8=a)?t.style.setProperty("bottom",a):t.style.removeProperty("bottom")),l!==n._v$9&&(null!=(n._v$9=l)?r.style.setProperty("fill",l):r.style.removeProperty("fill")),h!==n._v$10&&ie(r,"class",n._v$10=h),n}),{_v$5:void 0,_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0}),t}};let Se;se(["click"]);const Ae=new Uint8Array(16);function Re(){if(Se=Se||"undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto))return Se(Ae);throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}const Ne=[];for(let e=0;e<256;++e)Ne.push((e+256).toString(16).slice(1));var Oe,Pe,De={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Le(e,t,r){if(De.randomUUID&&!t&&!e)return De.randomUUID();var n=(e=e||{}).random||(e.rng||Re)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return function(e,t=0){return Ne[e[t+0]]+Ne[e[t+1]]+Ne[e[t+2]]+Ne[e[t+3]]+"-"+Ne[e[t+4]]+Ne[e[t+5]]+"-"+Ne[e[t+6]]+Ne[e[t+7]]+"-"+Ne[e[t+8]]+Ne[e[t+9]]+"-"+Ne[e[t+10]]+Ne[e[t+11]]+Ne[e[t+12]]+Ne[e[t+13]]+Ne[e[t+14]]+Ne[e[t+15]]}(n)}const Me=({apiHost:e="http://localhost:3000",body:t})=>Ee({method:"POST",url:e+"/api/v1/openai-assistants-file",body:t,type:"blob"}),Ue=ne('<input class="focus:outline-none bg-transparent px-4 py-4 flex-1 w-full text-input disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100" type="text">'),Fe=e=>{const[t,r]=K(e,["ref","onInput"]);return(n=Ue()).$$input=e=>t.onInput(e.currentTarget.value),"function"==typeof(s=e.ref)?le(s,n):e.ref=n,ae(n,G({get disabled(){return e.disabled},get style(){return{"font-size":e.fontSize?e.fontSize+"px":"16px"}}},r),!1,!1),n;var n,s},[je,Be]=(se(["input"]),_()),Ve=ne('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"></path><line x1="16" x2="22" y1="5" y2="5"></line><line x1="19" x2="19" y1="2" y2="8"></line><circle cx="9" cy="9" r="2"></circle><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21">'),ze=e=>{{const t=Ve();return k((()=>ie(t,"stroke",e.color??"#3B81F6"))),t}},$e=ne('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="1">'),qe=e=>{{const t=$e();return k((()=>ie(t,"stroke",e.color??"#3B81F6"))),t}},He=ne('<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-refresh" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4"></path><path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4">'),Ge=e=>{{const t=He();return k((()=>ie(t,"stroke",e.color??"#3B81F6"))),t}},Ke=ne('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" x2="12" y1="19" y2="22">'),We=e=>{{const t=Ke();return k((()=>ie(t,"stroke",e.color??"#3B81F6"))),t}},Qe=ne('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="19px"><path d="M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z">'),Je=e=>{return ae(t=Qe(),G({get style(){return{fill:e.color??"#3B81F6"}}},e),!0,!0),t;var t},Ye=ne('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17">'),Xe=e=>{{const t=Ye();return k((()=>ie(t,"stroke",e.color??"#3B81F6"))),t}},Ze=ne('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12">'),et=e=>{{const t=Ze();return k((()=>ie(t,"stroke",e.color??"#3B81F6"))),t}},tt=ne('<button type="submit">'),rt=ne('<svg><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">'),nt=e=>{return ae(t=tt(),G({get disabled(){return e.isDisabled||e.isLoading}},e,{get class(){return"py-2 px-4 justify-center font-semibold text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 chatbot-button "+e.class},style:{background:"transparent",border:"none"}}),!1,!0),he(t,z(Q,{get when(){return!e.isLoading},get fallback(){return z(it,{class:"text-white"})},get children(){return z(Je,{get color(){return e.sendButtonColor},get class(){return"send-icon flex "+(e.disableIcon?"hidden":"")}})}})),t;var t},st=e=>{return ae(t=tt(),G({get disabled(){return e.isDisabled||e.isLoading}},e,{get class(){return"py-2 px-4 justify-center font-semibold text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 chatbot-button "+e.class},style:{background:"transparent",border:"none"},title:"New Chat"}),!1,!0),he(t,z(Q,{get when(){return!e.isLoading},get fallback(){return z(it,{class:"text-white"})},get children(){return z(Ge,{get color(){return e.sendButtonColor},get class(){return"send-icon flex "+(e.disableIcon?"hidden":"")}})}})),t;var t},it=e=>{return ae(t=rt(),G(e,{get class(){return"animate-spin -ml-1 mr-3 h-5 w-5 "+e.class},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","data-testid":"loading-spinner"}),!0,!0),t;var t},ot=ne('<button type="submit">'),at=ne('<svg><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">'),lt=e=>{return ae(t=ot(),G({get disabled(){return e.isDisabled||e.isLoading}},e,{get class(){return"py-2 px-4 justify-center font-semibold focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 chatbot-button "+e.class},style:{background:"transparent",border:"none"}}),!1,!0),he(t,z(Q,{get when(){return!e.isLoading},get fallback(){return z(ht,{class:"text-white"})},get children(){return z(ze,{get color(){return e.buttonColor}})}})),t;var t},ht=e=>{return ae(t=at(),G(e,{get class(){return"animate-spin -ml-1 mr-3 h-5 w-5 "+e.class},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","data-testid":"loading-spinner"}),!0,!0),t;var t},ct=ne('<button type="submit">'),ut=ne('<svg><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">'),dt=e=>{return ae(t=ct(),G({get disabled(){return e.isDisabled||e.isLoading}},e,{get class(){return"py-2 px-4 justify-center font-semibold focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 chatbot-button "+e.class},style:{background:"transparent",border:"none"}}),!1,!0),he(t,z(Q,{get when(){return!e.isLoading},get fallback(){return z(pt,{class:"text-white"})},get children(){return z(We,{get color(){return e.buttonColor}})}})),t;var t},pt=e=>{return ae(t=ut(),G(e,{get class(){return"animate-spin -ml-1 mr-3 h-5 w-5 "+e.class},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","data-testid":"loading-spinner"}),!0,!0),t;var t},ft=ne("<span>Send"),gt=ne('<div class="flex items-center justify-between chatbot-input border border-[#eeeeee]" data-testid="input">'),mt=ne("<span>Image Upload"),vt=ne('<input multiple type="file">'),yt=ne("<span>Record Audio"),wt=e=>{const[t,r]=_(e.defaultValue??"");let n,s;const i=e=>r(e),o=()=>{""!==t()&&n?.reportValidity()&&e.onSubmit(t()),r("")},a=e=>{var t=e.isComposing||229===e.keyCode;"Enter"!==e.key||t||o()},l=()=>{s&&s.click()},h=(E((()=>{e.disabled||je()||!n||n.focus()})),I((()=>{!je()&&n&&n.focus()})),t=>{e.handleFileChange(t),t.target&&(t.target.value="")});{const r=gt();return r.$$keydown=a,r.style.setProperty("margin","auto"),he(r,(()=>{const t=T((()=>!!e.uploadsConfig?.isImageUploadAllowed));return()=>{return t()?[z(lt,{get buttonColor(){return e.sendButtonColor},type:"button",class:"m-0","on:click":l,get children(){var e=mt();return e.style.setProperty("font-family","Poppins, sans-serif"),e}}),((r=vt()).addEventListener("change",h),"function"==typeof(n=s)?le(n,r):s=r,r.style.setProperty("display","none"),r)]:null;var r,n}})(),null),he(r,z(Fe,{ref(e){"function"==typeof n?n(e):n=e},onInput:i,get value(){return t()},get fontSize(){return e.fontSize},get disabled(){return e.disabled},get placeholder(){return e.placeholder??"Type your question"}}),null),he(r,(()=>{const t=T((()=>!!e.uploadsConfig?.isSpeechToTextEnabled));return()=>t()?z(dt,{get buttonColor(){return e.sendButtonColor},type:"button",class:"m-0 start-recording-button",get"on:click"(){return e.onMicrophoneClicked},get children(){var e=yt();return e.style.setProperty("font-family","Poppins, sans-serif"),e}}):null})(),null),he(r,z(nt,{get sendButtonColor(){return e.sendButtonColor},type:"button",get isDisabled(){return e.disabled||""===t()},class:"m-0","on:click":o,get children(){var e=ft();return e.style.setProperty("font-family","Poppins, sans-serif"),e}}),null),k((t=>{var n=e.backgroundColor??"#ffffff",s=e.textColor??"#303235";return n!==t._v$&&(null!=(t._v$=n)?r.style.setProperty("background-color",n):r.style.removeProperty("background-color")),s!==t._v$2&&(null!=(t._v$2=s)?r.style.setProperty("color",s):r.style.removeProperty("color")),t}),{_v$:void 0,_v$2:void 0}),r}},bt=(se(["keydown"]),ne('<figure data-testid="default-avatar"><svg width="75" height="75" viewBox="0 0 75 75" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="mask0" x="0" y="0" mask-type="alpha"><circle cx="37.5" cy="37.5" r="37.5" fill="#0042DA"></circle></mask><g mask="url(#mask0)"><rect x="-30" y="-43" width="131" height="154" fill="#0042DA"></rect><rect x="2.50413" y="120.333" width="81.5597" height="86.4577" rx="2.5" transform="rotate(-52.6423 2.50413 120.333)" stroke="#FED23D" stroke-width="5"></rect><circle cx="76.5" cy="-1.5" r="29" stroke="#FF8E20" stroke-width="5"></circle><path d="M-49.8224 22L-15.5 -40.7879L18.8224 22H-49.8224Z" stroke="#F7F8FF" stroke-width="5">')),_t=()=>{{const e=bt(),t=e.firstChild;return k((r=>{var n="flex justify-center items-center rounded-full text-white relative "+(je()?"w-6 h-6 text-sm":"w-10 h-10 text-xl"),s="absolute top-0 left-0 "+(je()?" w-6 h-6 text-sm":"w-full h-full text-xl");return n!==r._v$&&oe(e,r._v$=n),s!==r._v$2&&ie(t,"class",r._v$2=s),r}),{_v$:void 0,_v$2:void 0}),e}},kt=ne('<figure><img alt="Bot avatar" class="rounded-full object-cover w-full h-full">'),Et=e=>{const[t,r]=_(e.initialAvatarSrc);return E((()=>{t()?.startsWith("{{")&&e.initialAvatarSrc?.startsWith("http")&&r(e.initialAvatarSrc)})),z(Q,{get when(){return(e=>null!=e&&""!==e)(t())},keyed:!0,get fallback(){return z(_t,{})},get children(){const e=kt(),r=e.firstChild;return k((n=>{var s="flex justify-center items-center rounded-full text-white relative flex-shrink-0 "+(je()?"w-6 h-6 text-sm":"w-10 h-10 text-xl"),i=t();return s!==n._v$&&oe(e,n._v$=s),i!==n._v$2&&ie(r,"src",n._v$2=i),n}),{_v$:void 0,_v$2:void 0}),e}})};class Tt{source;flags;constructor(e,t=""){this.source=e.source,this.flags=t}setGroup(e,t){let r="string"==typeof t?t:t.source;return r=r.replace(/(^|[^\[])\^/g,"$1"),this.source=this.source.replace(e,r),this}getRegexp(){return new RegExp(this.source,this.flags)}}const xt=/[&<>"']/,It=/[&<>"']/g,Ct={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},St=/[<>"']|&(?!#?\w+;)/,At=/[<>"']|&(?!#?\w+;)/g;function Rt(e,t){if(t){if(xt.test(e))return e.replace(It,(e=>Ct[e]))}else if(St.test(e))return e.replace(At,(e=>Ct[e]));return e}function Nt(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,(function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""}))}var Ot;(Ot=Oe=Oe||{})[Ot.space=1]="space",Ot[Ot.text=2]="text",Ot[Ot.paragraph=3]="paragraph",Ot[Ot.heading=4]="heading",Ot[Ot.listStart=5]="listStart",Ot[Ot.listEnd=6]="listEnd",Ot[Ot.looseItemStart=7]="looseItemStart",Ot[Ot.looseItemEnd=8]="looseItemEnd",Ot[Ot.listItemStart=9]="listItemStart",Ot[Ot.listItemEnd=10]="listItemEnd",Ot[Ot.blockquoteStart=11]="blockquoteStart",Ot[Ot.blockquoteEnd=12]="blockquoteEnd",Ot[Ot.code=13]="code",Ot[Ot.table=14]="table",Ot[Ot.html=15]="html",Ot[Ot.hr=16]="hr";class Pt{gfm=!0;tables=!0;breaks=!1;pedantic=!1;sanitize=!1;sanitizer;mangle=!0;smartLists=!1;silent=!1;highlight;langPrefix="lang-";smartypants=!1;headerPrefix="";renderer;xhtml=!1;escape=Rt;unescape=Nt;isNoP}class Dt{options;constructor(e){this.options=e||Ut.options}code(e,t,r,n){this.options.highlight&&null!=(s=this.options.highlight(e,t))&&s!==e&&(r=!0,e=s);var s=r?e:this.options.escape(e,!0);return t?`\n<pre><code class="${this.options.langPrefix+this.options.escape(t,!0)}">${s}\n</code></pre>\n`:`\n<pre><code>${s}\n</code></pre>\n`}blockquote(e){return`<blockquote>\n${e}</blockquote>\n`}html(e){return e}heading(e,t,r){return`<h${t} id="${this.options.headerPrefix+r.toLowerCase().replace(/[^\w]+/g,"-")}">${e}</h${t}>\n`}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t){return`\n<${t=t?"ol":"ul"}>\n${e}</${t}>\n`}listitem(e){return"<li>"+e+"</li>\n"}paragraph(e){return"<p>"+e+"</p>\n"}table(e,t){return`\n<table>\n<thead>\n${e}</thead>\n<tbody>\n${t}</tbody>\n</table>\n`}tablerow(e){return"<tr>\n"+e+"</tr>\n"}tablecell(e,t){var r=t.header?"th":"td";return(t.align?"<"+r+' style="text-align:'+t.align+'">':"<"+r+">")+e+"</"+r+">\n"}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,r){if(this.options.sanitize){let n;try{n=decodeURIComponent(this.options.unescape(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(t){return r}if(0===n.indexOf("javascript:")||0===n.indexOf("vbscript:")||0===n.indexOf("data:"))return r}let n='<a href="'+e+'"';return t&&(n+=' title="'+t+'"'),n+">"+r+"</a>"}image(e,t,r){let n='<img src="'+e+'" alt="'+r+'"';return t&&(n+=' title="'+t+'"'),n+(this.options.xhtml?"/>":">")}text(e){return e}}class Lt{staticThis;links;options;static rulesBase=null;static rulesPedantic=null;static rulesGfm=null;static rulesBreaks=null;rules;renderer;inLink;hasRulesGfm;ruleCallbacks;constructor(e,t,r=Ut.options,n){if(this.staticThis=e,this.links=t,this.options=r,this.renderer=n||this.options.renderer||new Dt(this.options),!this.links)throw new Error("InlineLexer requires 'links' parameter.");this.setRules()}static output(e,t,r){return new this(this,t,r).output(e)}static getRulesBase(){var e;return this.rulesBase||((e={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ <>]+(@|:\/)[^ <>]+)>/,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^<'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)([\s\S]*?[^`])\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/}).link=new Tt(e.link).setGroup("inside",e._inside).setGroup("href",e._href).getRegexp(),e.reflink=new Tt(e.reflink).setGroup("inside",e._inside).getRegexp(),this.rulesBase=e)}static getRulesPedantic(){return this.rulesPedantic||(this.rulesPedantic={...this.getRulesBase(),strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/})}static getRulesGfm(){var e,t,r;return this.rulesGfm||(e=this.getRulesBase(),t=new Tt(e.escape).setGroup("])","~|])").getRegexp(),r=new Tt(e.text).setGroup("]|","~]|").setGroup("|","|https?://|").getRegexp(),this.rulesGfm={...e,escape:t,url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:r})}static getRulesBreaks(){var e,t;return this.rulesBreaks||(e=this.getRulesGfm(),t=this.getRulesGfm(),this.rulesBreaks={...t,br:new Tt(e.br).setGroup("{2,}","*").getRegexp(),text:new Tt(t.text).setGroup("{2,}","*").getRegexp()})}setRules(){this.options.gfm?this.options.breaks?this.rules=this.staticThis.getRulesBreaks():this.rules=this.staticThis.getRulesGfm():this.options.pedantic?this.rules=this.staticThis.getRulesPedantic():this.rules=this.staticThis.getRulesBase(),this.hasRulesGfm=void 0!==this.rules.url}output(e){let t,r="";for(;e;)if(t=this.rules.escape.exec(e))e=e.substring(t[0].length),r+=t[1];else if(t=this.rules.autolink.exec(e)){let n,s;e=e.substring(t[0].length),s="@"===t[2]?(n=this.options.escape(":"===t[1].charAt(6)?this.mangle(t[1].substring(7)):this.mangle(t[1])),this.mangle("mailto:")+n):n=this.options.escape(t[1]),r+=this.renderer.link(s,null,n)}else if(!this.inLink&&this.hasRulesGfm&&(t=this.rules.url.exec(e))){e=e.substring(t[0].length);var n=this.options.escape(t[1]);r+=this.renderer.link(n,null,n)}else if(t=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(t[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(t[0])&&(this.inLink=!1),e=e.substring(t[0].length),r+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):this.options.escape(t[0]):t[0];else if(t=this.rules.link.exec(e))e=e.substring(t[0].length),this.inLink=!0,r+=this.outputLink(t,{href:t[2],title:t[3]}),this.inLink=!1;else if(t=(t=this.rules.reflink.exec(e))||this.rules.nolink.exec(e)){e=e.substring(t[0].length);n=(t[2]||t[1]).replace(/\s+/g," ");var s=this.links[n.toLowerCase()];s&&s.href?(this.inLink=!0,r+=this.outputLink(t,s),this.inLink=!1):(r+=t[0].charAt(0),e=t[0].substring(1)+e)}else if(t=this.rules.strong.exec(e))e=e.substring(t[0].length),r+=this.renderer.strong(this.output(t[2]||t[1]));else if(t=this.rules.em.exec(e))e=e.substring(t[0].length),r+=this.renderer.em(this.output(t[2]||t[1]));else if(t=this.rules.code.exec(e))e=e.substring(t[0].length),r+=this.renderer.codespan(this.options.escape(t[2].trim(),!0));else if(t=this.rules.br.exec(e))e=e.substring(t[0].length),r+=this.renderer.br();else if(this.hasRulesGfm&&(t=this.rules.del.exec(e)))e=e.substring(t[0].length),r+=this.renderer.del(this.output(t[1]));else if(t=this.rules.text.exec(e))e=e.substring(t[0].length),r+=this.renderer.text(this.options.escape(this.smartypants(t[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return r}outputLink(e,t){var r=this.options.escape(t.href);t=t.title?this.options.escape(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(r,t,this.output(e[1])):this.renderer.image(r,t,this.options.escape(e[1]))}smartypants(e){return this.options.smartypants?e.replace(/---/g,"").replace(/--/g,"").replace(/(^|[-\u2014/([{"\s])'/g,"$1").replace(/'/g,"").replace(/(^|[-\u2014/([{\u2018\s])"/g,"$1").replace(/"/g,"").replace(/\.{3}/g,""):e}mangle(e){if(!this.options.mangle)return e;let t="";var r=e.length;for(let n=0;n<r;n++){let r;.5<Math.random()&&(r="x"+e.charCodeAt(n).toString(16)),t+="&#"+r+";"}return t}}class Mt{simpleRenderers=[];tokens;token;inlineLexer;options;renderer;line=0;constructor(e){this.tokens=[],this.token=null,this.options=e||Ut.options,this.renderer=this.options.renderer||new Dt(this.options)}static parse(e,t,r){return new this(r).parse(t,e)}parse(e,t){this.inlineLexer=new Lt(Lt,e,this.options,this.renderer),this.tokens=t.reverse();let r="";for(;this.next();)r+=this.tok();return r}debug(e,t){this.inlineLexer=new Lt(Lt,e,this.options,this.renderer),this.tokens=t.reverse();let r="";for(;this.next();){var n=this.tok();this.token.line=this.line+=n.split("\n").length-1,r+=n}return r}next(){return this.token=this.tokens.pop()}getNextElement(){return this.tokens[this.tokens.length-1]}parseText(){let e=this.token.text;for(var t;(t=this.getNextElement())&&t.type==Oe.text;)e+="\n"+this.next().text;return this.inlineLexer.output(e)}tok(){switch(this.token.type){case Oe.space:return"";case Oe.paragraph:return this.renderer.paragraph(this.inlineLexer.output(this.token.text));case Oe.text:return this.options.isNoP?this.parseText():this.renderer.paragraph(this.parseText());case Oe.heading:return this.renderer.heading(this.inlineLexer.output(this.token.text),this.token.depth,this.token.text);case Oe.listStart:{let t="";for(var e=this.token.ordered;this.next().type!=Oe.listEnd;)t+=this.tok();return this.renderer.list(t,e)}case Oe.listItemStart:{let e="";for(;this.next().type!=Oe.listItemEnd;)e+=this.token.type==Oe.text?this.parseText():this.tok();return this.renderer.listitem(e)}case Oe.looseItemStart:{let e="";for(;this.next().type!=Oe.listItemEnd;)e+=this.tok();return this.renderer.listitem(e)}case Oe.code:return this.renderer.code(this.token.text,this.token.lang,this.token.escaped,this.token.meta);case Oe.table:{e="";let n,s="";n="";for(let e=0;e<this.token.header.length;e++){var t={header:!0,align:this.token.align[e]},r=this.inlineLexer.output(this.token.header[e]);n+=this.renderer.tablecell(r,t)}e+=this.renderer.tablerow(n);for(const e of this.token.cells){n="";for(let t=0;t<e.length;t++)n+=this.renderer.tablecell(this.inlineLexer.output(e[t]),{header:!1,align:this.token.align[t]});s+=this.renderer.tablerow(n)}return this.renderer.table(e,s)}case Oe.blockquoteStart:{let e="";for(;this.next().type!=Oe.blockquoteEnd;)e+=this.tok();return this.renderer.blockquote(e)}case Oe.hr:return this.renderer.hr();case Oe.html:return e=this.token.pre||this.options.pedantic?this.token.text:this.inlineLexer.output(this.token.text),this.renderer.html(e);default:if(this.simpleRenderers.length)for(let e=0;e<this.simpleRenderers.length;e++)if(this.token.type=="simpleRule"+(e+1))return this.simpleRenderers[e].call(this.renderer,this.token.execArr);if(e=`Token with "${this.token.type}" type was not found.`,!this.options.silent)throw new Error(e);console.log(e)}}}class Ut{static options=new Pt;static simpleRenderers=[];static setOptions(e){return Object.assign(this.options,e),this}static setBlockRule(e,t=(()=>"")){return Ft.simpleRules.push(e),this.simpleRenderers.push(t),this}static parse(e,t){try{t={...this.options,...t};var{tokens:r,links:n}=this.callBlockLexer(e,t);return this.callParser(r,n,t)}catch(e){return this.callMe(e)}}static debug(e,t=this.options){var{tokens:e,links:r}=this.callBlockLexer(e,t);let n=e.slice();return(t=new Mt(t)).simpleRenderers=this.simpleRenderers,t=t.debug(r,e),{tokens:n=n.map((e=>{e.type=Oe[e.type]||e.type;var t=e.line;return delete e.line,t?{line:t,...e}:e})),links:r,result:t}}static callBlockLexer(e="",t){if("string"!=typeof e)throw new Error(`Expected that the 'src' parameter would have a 'string' type, got '${typeof e}'`);return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n").replace(/^ +$/gm,""),Ft.lex(e,t,!0)}static callParser(e,t,r){var n;return this.simpleRenderers.length?((n=new Mt(r)).simpleRenderers=this.simpleRenderers,n.parse(t,e)):Mt.parse(e,t,r)}static callMe(e){if(e.message+="\nPlease report this to https://github.com/ts-stack/markdown",this.options.silent)return"<p>An error occured:</p><pre>"+this.options.escape(e.message+"",!0)+"</pre>";throw e}}class Ft{staticThis;static simpleRules=[];static rulesBase=null;static rulesGfm=null;static rulesTables=null;rules;options;links={};tokens=[];hasRulesGfm;hasRulesTables;constructor(e,t){this.staticThis=e,this.options=t||Ut.options,this.setRules()}static lex(e,t,r,n){return new this(this,t).getTokens(e,r,n)}static getRulesBase(){var e,t;return this.rulesBase||((e={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/}).item=new Tt(e.item,"gm").setGroup(/bull/g,e.bullet).getRegexp(),e.list=new Tt(e.list).setGroup(/bull/g,e.bullet).setGroup("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))").setGroup("def","\\n+(?="+e.def.source+")").getRegexp(),t="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",e.html=new Tt(e.html).setGroup("comment",/<!--[\s\S]*?-->/).setGroup("closed",/<(tag)[\s\S]+?<\/\1>/).setGroup("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/).setGroup(/tag/g,t).getRegexp(),e.paragraph=new Tt(e.paragraph).setGroup("hr",e.hr).setGroup("heading",e.heading).setGroup("lheading",e.lheading).setGroup("blockquote",e.blockquote).setGroup("tag","<"+t).setGroup("def",e.def).getRegexp(),this.rulesBase=e)}static getRulesGfm(){var e,t,r,n;return this.rulesGfm||(r=(t={...e=this.getRulesBase(),fences:/^ *(`{3,}|~{3,})[ \.]*((\S+)? *[^\n]*)\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}).fences.source.replace("\\1","\\2"),n=e.list.source.replace("\\1","\\3"),t.paragraph=new Tt(e.paragraph).setGroup("(?!",`(?!${r}|${n}|`).getRegexp(),this.rulesGfm=t)}static getRulesTable(){return this.rulesTables||(this.rulesTables={...this.getRulesGfm(),nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/})}setRules(){this.options.gfm?this.options.tables?this.rules=this.staticThis.getRulesTable():this.rules=this.staticThis.getRulesGfm():this.rules=this.staticThis.getRulesBase(),this.hasRulesGfm=void 0!==this.rules.fences,this.hasRulesTables=void 0!==this.rules.table}getTokens(e,t,r){let n,s=e;e:for(;s;)if((n=this.rules.newline.exec(s))&&(s=s.substring(n[0].length),1<n[0].length)&&this.tokens.push({type:Oe.space}),n=this.rules.code.exec(s)){s=s.substring(n[0].length);var i=n[0].replace(/^ {4}/gm,"");this.tokens.push({type:Oe.code,text:this.options.pedantic?i:i.replace(/\n+$/,"")})}else if(this.hasRulesGfm&&(n=this.rules.fences.exec(s)))s=s.substring(n[0].length),this.tokens.push({type:Oe.code,meta:n[2],lang:n[3],text:n[4]||""});else if(n=this.rules.heading.exec(s))s=s.substring(n[0].length),this.tokens.push({type:Oe.heading,depth:n[1].length,text:n[2]});else if(t&&this.hasRulesTables&&(n=this.rules.nptable.exec(s))){s=s.substring(n[0].length);var o={type:Oe.table,header:n[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:n[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:[]};for(let e=0;e<o.align.length;e++)/^ *-+: *$/.test(o.align[e])?o.align[e]="right":/^ *:-+: *$/.test(o.align[e])?o.align[e]="center":/^ *:-+ *$/.test(o.align[e])?o.align[e]="left":o.align[e]=null;var a=n[3].replace(/\n$/,"").split("\n");for(let e=0;e<a.length;e++)o.cells[e]=a[e].split(/ *\| */);this.tokens.push(o)}else if(n=this.rules.lheading.exec(s))s=s.substring(n[0].length),this.tokens.push({type:Oe.heading,depth:"="===n[2]?1:2,text:n[1]});else if(n=this.rules.hr.exec(s))s=s.substring(n[0].length),this.tokens.push({type:Oe.hr});else if(n=this.rules.blockquote.exec(s))s=s.substring(n[0].length),this.tokens.push({type:Oe.blockquoteStart}),i=n[0].replace(/^ *> ?/gm,""),this.getTokens(i),this.tokens.push({type:Oe.blockquoteEnd});else if(n=this.rules.list.exec(s)){s=s.substring(n[0].length);var l,h=n[2],c=(this.tokens.push({type:Oe.listStart,ordered:1<h.length}),n[0].match(this.rules.item)),u=c.length;let e,t=!1;for(let n=0;n<u;n++){let i=c[n];l=i.length,-1!==(i=i.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(l-=i.length,i=this.options.pedantic?i.replace(/^ {1,4}/gm,""):i.replace(new RegExp("^ {1,"+l+"}","gm"),"")),!this.options.smartLists||n===u-1||h===(l=this.staticThis.getRulesBase().bullet.exec(c[n+1])[0])||1<h.length&&1<l.length||(s=c.slice(n+1).join("\n")+s,n=u-1),e=t||/\n\n(?!\s*$)/.test(i),n!==u-1&&(t="\n"===i.charAt(i.length-1),e=e||t),this.tokens.push({type:e?Oe.looseItemStart:Oe.listItemStart}),this.getTokens(i,!1,r),this.tokens.push({type:Oe.listItemEnd})}this.tokens.push({type:Oe.listEnd})}else if(n=this.rules.html.exec(s)){s=s.substring(n[0].length);var d=n[1];this.tokens.push({type:this.options.sanitize?Oe.paragraph:Oe.html,pre:!this.options.sanitizer&&("pre"===d||"script"===d||"style"===d),text:n[0]})}else if(t&&(n=this.rules.def.exec(s)))s=s.substring(n[0].length),this.links[n[1].toLowerCase()]={href:n[2],title:n[3]};else if(t&&this.hasRulesTables&&(n=this.rules.table.exec(s))){s=s.substring(n[0].length);var p={type:Oe.table,header:n[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:n[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:[]};for(let e=0;e<p.align.length;e++)/^ *-+: *$/.test(p.align[e])?p.align[e]="right":/^ *:-+: *$/.test(p.align[e])?p.align[e]="center":/^ *:-+ *$/.test(p.align[e])?p.align[e]="left":p.align[e]=null;var f=n[3].replace(/(?: *\| *)?\n$/,"").split("\n");for(let e=0;e<f.length;e++)p.cells[e]=f[e].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(p)}else{if(this.staticThis.simpleRules.length){var g=this.staticThis.simpleRules;for(let e=0;e<g.length;e++)if(n=g[e].exec(s)){s=s.substring(n[0].length);var m="simpleRule"+(e+1);this.tokens.push({type:m,execArr:n});continue e}}if(t&&(n=this.rules.paragraph.exec(s)))s=s.substring(n[0].length),"\n"===n[1].slice(-1)?this.tokens.push({type:Oe.paragraph,text:n[1].slice(0,-1)}):this.tokens.push({type:0<this.tokens.length?Oe.paragraph:Oe.text,text:n[1]});else if(n=this.rules.text.exec(s))s=s.substring(n[0].length),this.tokens.push({type:Oe.text,text:n[0]});else if(s)throw new Error("Infinite loop on byte: "+s.charCodeAt(0)+`, near text '${s.slice(0,30)}...'`)}return{tokens:this.tokens,links:this.links}}}const jt=ne('<div class="flex justify-end mb-2 items-end guest-container"><div class="max-w-full flex flex-col justify-center items-start chatbot-guest-bubble px-4 py-2 gap-2" data-testid="guest-bubble">'),Bt=ne('<div class="flex flex-col items-start flex-wrap w-full gap-2">'),Vt=ne('<div class="flex items-center justify-center max-w-[128px] mr-[10px] p-0 m-0"><img class="w-full h-full bg-cover">'),zt=ne('<audio class="w-[200px] h-10 block bg-cover bg-center rounded-none text-transparent" controls>Your browser does not support the &lt;audio&gt; tag.<source>'),$t=ne('<span class="mr-2 whitespace-pre-wrap">'),qt=(Ut.setOptions({isNoP:!0}),e=>{let t;I((()=>{t&&(t.innerHTML=Ut.parse(e.message.message))}));{const r=jt(),n=r.firstChild;return r.style.setProperty("margin-left","50px"),n.style.setProperty("border-radius","6px"),he(n,(()=>{const t=T((()=>!!(e.message.fileUploads&&0<e.message.fileUploads.length)));return()=>{return t()&&(he(r=Bt(),z(W,{get each(){return e.message.fileUploads},children:t=>{var r=`${e.apiHost}/api/v1/get-upload-file?chatflowId=${e.chatflowid}&chatId=${e.chatId}&fileName=`+t.name;const n=t.data??r;return T((()=>{const e=T((()=>!(!t.mime||!t.mime.startsWith("image/"))));return()=>{if(e())return ie((r=Vt()).firstChild,"src",n),r;{const e=zt(),r=e.firstChild.nextSibling;return ie(r,"src",n),k((()=>ie(r,"type",t.mime))),e}var r}})())}})),r);var r}})(),null),he(n,(()=>{const r=T((()=>!!e.message.message));return()=>{return r()&&(e=$t(),"function"==typeof(n=t)?le(n,e):t=e,e);var e,n}})(),null),he(r,z(Q,{get when(){return e.showAvatar},get children(){return z(Et,{get initialAvatarSrc(){return e.avatarSrc}})}}),null),k((t=>{var r=e.backgroundColor??"#3B81F6",s=e.textColor??"#ffffff";return r!==t._v$&&(null!=(t._v$=r)?n.style.setProperty("background-color",r):n.style.removeProperty("background-color")),s!==t._v$2&&(null!=(t._v$2=s)?n.style.setProperty("color",s):n.style.removeProperty("color")),t}),{_v$:void 0,_v$2:void 0}),r}}),Ht=ne('<div class="flex justify-start mb-2 items-start host-container">'),Gt=ne('<span class="px-4 py-2 ml-2 max-w-full chatbot-host-bubble prose" data-testid="host-bubble">'),Kt=(Ut.setOptions({isNoP:!0}),e=>{let t;return I((()=>{if(t&&(t.innerHTML=Ut.parse(e.message),t.querySelectorAll("a").forEach((e=>{e.target="_blank"})),e.fileAnnotations)&&e.fileAnnotations.length)for(const s of e.fileAnnotations){var r=document.createElement("button"),n=(r.textContent=s.fileName,r.className="py-2 px-4 mb-2 justify-center font-semibold text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 file-annotation-button",r.addEventListener("click",(function(){(async t=>{try{var r=await Me({apiHost:e.apiHost,body:{question:"",history:[],fileName:t.fileName}}),n=new Blob([r.data]),s=window.URL.createObjectURL(n),i=document.createElement("a");i.href=s,i.download=t.fileName,document.body.appendChild(i),i.click(),i.remove()}catch(t){console.error("Download failed:",t)}})(s)})),document.createElement("div"));n.className="ml-2",n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-download" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>',r.appendChild(n),t.appendChild(r)}})),(r=Ht()).style.setProperty("margin-right","50px"),he(r,z(Q,{get when(){return e.showAvatar},get children(){return z(Et,{get initialAvatarSrc(){return e.avatarSrc}})}}),null),he(r,(()=>{const r=T((()=>!!e.message));return()=>r()&&(()=>{const r=Gt();return"function"==typeof t?le(t,r):t=r,r.style.setProperty("border-radius","6px"),k((t=>{var n=e.backgroundColor??"#f7f8ff",s=e.textColor??"#303235";return n!==t._v$&&(null!=(t._v$=n)?r.style.setProperty("background-color",n):r.style.removeProperty("background-color")),s!==t._v$2&&(null!=(t._v$2=s)?r.style.setProperty("color",s):r.style.removeProperty("color")),t}),{_v$:void 0,_v$2:void 0}),r})()})(),null),r;var r}),Wt=ne('<div class="flex items-center"><div class="w-2 h-2 mr-1 rounded-full bubble1"></div><div class="w-2 h-2 mr-1 rounded-full bubble2"></div><div class="w-2 h-2 rounded-full bubble3">'),Qt=()=>Wt(),Jt=ne('<div class="flex justify-start mb-2 items-start animate-fade-in host-container"><span class="px-4 py-4 ml-2 whitespace-pre-wrap max-w-full chatbot-host-bubble" data-testid="host-bubble">'),Yt=()=>{return he((e=Jt()).firstChild,z(Qt,{})),e;var e},Xt=ne('<div data-modal-target="defaultModal" data-modal-toggle="defaultModal" class="flex justify-start mb-2 items-start animate-fade-in host-container hover:brightness-90 active:brightness-75"><span class="px-2 py-1 ml-1 whitespace-pre-wrap max-w-full chatbot-host-bubble" data-testid="host-bubble">'),Zt=e=>{return r=(t=Xt()).firstChild,t.$$click=()=>e.onSourceClick?.(),r.style.setProperty("width","max-content"),r.style.setProperty("max-width","80px"),r.style.setProperty("font-size","13px"),r.style.setProperty("border-radius","15px"),r.style.setProperty("cursor","pointer"),r.style.setProperty("text-overflow","ellipsis"),r.style.setProperty("overflow","hidden"),r.style.setProperty("white-space","nowrap"),he(r,(()=>e.pageContent)),t;var t,r},er=(se(["click"]),ne('<div data-modal-target="defaultModal" data-modal-toggle="defaultModal" class="flex justify-start items-start animate-fade-in host-container hover:brightness-90 active:brightness-75"><span class="px-2 py-1 ml-1 whitespace-pre-wrap max-w-full chatbot-host-bubble" data-testid="host-bubble">')),tr=e=>{return r=(t=er()).firstChild,t.$$click=()=>e.onPromptClick?.(),r.style.setProperty("width","max-content"),r.style.setProperty("font-size","15px"),r.style.setProperty("border-radius","15px"),r.style.setProperty("cursor","pointer"),he(r,(()=>e.prompt)),t;var t,r},rr=(se(["click"]),Object.create(null)),nr=(rr.open="0",rr.close="1",rr.ping="2",rr.pong="3",rr.message="4",rr.upgrade="5",rr.noop="6",Object.create(null)),sr=(Object.keys(rr).forEach((e=>{nr[rr[e]]=e})),{type:"error",data:"parser error"}),ir="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),or="function"==typeof ArrayBuffer,ar=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,lr=({type:e,data:t},r,n)=>ir&&t instanceof Blob?r?n(t):hr(t,n):or&&(t instanceof ArrayBuffer||ar(t))?r?n(t):hr(new Blob([t]),n):n(rr[e]+(t||"")),hr=(e,t)=>{const r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];t("b"+(e||""))},r.readAsDataURL(e)};function cr(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let ur;const dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pr="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let e=0;e<64;e++)pr[dr.charCodeAt(e)]=e;const fr="function"==typeof ArrayBuffer,gr=(e,t)=>{var r;return"string"!=typeof e?{type:"message",data:vr(e,t)}:"b"===(r=e.charAt(0))?{type:"message",data:mr(e.substring(1),t)}:nr[r]?1<e.length?{type:nr[r],data:e.substring(1)}:{type:nr[r]}:sr},mr=(e,t)=>{var r;return fr?(r=(e=>{let t,r,n,s,i,o=.75*e.length,a=e.length,l=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2])&&o--;var h=new ArrayBuffer(o),c=new Uint8Array(h);for(t=0;t<a;t+=4)r=pr[e.charCodeAt(t)],n=pr[e.charCodeAt(t+1)],s=pr[e.charCodeAt(t+2)],i=pr[e.charCodeAt(t+3)],c[l++]=r<<2|n>>4,c[l++]=(15&n)<<4|s>>2,c[l++]=(3&s)<<6|63&i;return h})(e),vr(r,t)):{base64:!0,data:e}},vr=(e,t)=>"blob"!==t?e instanceof ArrayBuffer?e:e.buffer:e instanceof Blob?e:new Blob([e]),yr=String.fromCharCode(30);function wr(){return new TransformStream({transform(e,t){!function(e,t){ir&&e.data instanceof Blob?e.data.arrayBuffer().then(cr).then(t):or&&(e.data instanceof ArrayBuffer||ar(e.data))?t(cr(e.data)):lr(e,!1,(e=>{ur=ur||new TextEncoder,t(ur.encode(e))}))}(e,(r=>{var n,s=r.length;let i;s<126?(i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,s)):s<65536?(i=new Uint8Array(3),(n=new DataView(i.buffer)).setUint8(0,126),n.setUint16(1,s)):(i=new Uint8Array(9),(n=new DataView(i.buffer)).setUint8(0,127),n.setBigUint64(1,BigInt(s))),e.data&&"string"!=typeof e.data&&(i[0]|=128),t.enqueue(i),t.enqueue(r)}))}})}let br;function _r(e){return e.reduce(((e,t)=>e+t.length),0)}function kr(e,t){if(e[0].length===t)return e.shift();var r=new Uint8Array(t);let n=0;for(let s=0;s<t;s++)r[s]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function Er(e){if(e)return function(e){for(var t in Er.prototype)e[t]=Er.prototype[t];return e}(e)}Er.prototype.on=Er.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Er.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},Er.prototype.off=Er.prototype.removeListener=Er.prototype.removeAllListeners=Er.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)this._callbacks={};else{var r=this._callbacks["$"+e];if(r)if(1==arguments.length)delete this._callbacks["$"+e];else{for(var n,s=0;s<r.length;s++)if((n=r[s])===t||n.fn===t){r.splice(s,1);break}0===r.length&&delete this._callbacks["$"+e]}}return this},Er.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){n=0;for(var s=(r=r.slice(0)).length;n<s;++n)r[n].apply(this,t)}return this},Er.prototype.emitReserved=Er.prototype.emit,Er.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Er.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Tr="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function xr(e,...t){return t.reduce(((t,r)=>(e.hasOwnProperty(r)&&(t[r]=e[r]),t)),{})}const Ir=Tr.setTimeout,Cr=Tr.clearTimeout;function Sr(e,t){t.useNativeTimers?(e.setTimeoutFn=Ir.bind(Tr),e.clearTimeoutFn=Cr.bind(Tr)):(e.setTimeoutFn=Tr.setTimeout.bind(Tr),e.clearTimeoutFn=Tr.clearTimeout.bind(Tr))}function Ar(e){return"string"==typeof e?function(e){let t,r=0;for(let n=0,s=e.length;n<s;n++)(t=e.charCodeAt(n))<128?r+=1:t<2048?r+=2:t<55296||57344<=t?r+=3:(n++,r+=4);return r}(e):Math.ceil(1.33*(e.byteLength||e.size))}class Rr extends Error{constructor(e,t,r){super(e),this.description=t,this.context=r,this.type="TransportError"}}class Nr extends Er{constructor(e){super(),this.writable=!1,Sr(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,r){return super.emitReserved("error",new Rr(e,t,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){e=gr(e,this.socket.binaryType),this.onPacket(e)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){var e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){return e=function(e){let t="";for(var r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}(e),e.length?"?"+e:""}}const Or="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Pr=64,Dr={};let Lr,Mr=0,Ur=0;function Fr(e){let t="";for(;t=Or[e%Pr]+t,0<(e=Math.floor(e/Pr)););return t}function jr(){var e=Fr(+new Date);return e!==Lr?(Mr=0,Lr=e):e+"."+Fr(Mr++)}for(;Ur<Pr;Ur++)Dr[Or[Ur]]=Ur;let Br=!1;try{Br="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Ot){}const Vr=Br;function zr(e){e=e.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||Vr))return new XMLHttpRequest}catch(e){}if(!e)try{return new(Tr[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}function $r(){}const qr=null!=new zr({xdomain:!1}).responseType;let Hr=class e extends Er{constructor(e,t){super(),Sr(this,t),this.opts=t,this.method=t.method||"GET",this.uri=e,this.data=void 0!==t.data?t.data:null,this.create()}create(){var t,r=xr(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;const n=this.xhr=new zr(r);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(var s in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this.opts.extraHeaders[s])}catch(t){}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{n.setRequestHeader("Accept","*/*")}catch(t){}null!=(t=this.opts.cookieJar)&&t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&null!=(e=this.opts.cookieJar)&&e.parseCookies(n),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof n.status?n.status:0)}),0))},n.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=e.requestsCount++,e.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=$r,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete e.requests[this.index],this.xhr=null}}onLoad(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};if(Hr.requestsCount=0,Hr.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",Gr);else if("function"==typeof addEventListener){addEventListener("onpagehide"in Tr?"pagehide":"unload",Gr,!1)}function Gr(){for(var e in Hr.requests)Hr.requests.hasOwnProperty(e)&&Hr.requests[e].abort()}const Kr="function"==typeof Promise&&"function"==typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Wr=Tr.WebSocket||Tr.MozWebSocket,Qr="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const Jr={websocket:class extends Nr{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(this.check()){var e=this.uri(),t=this.opts.protocols,r=Qr?{}:xr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Qr?new Wr(e,t,r):t?new Wr(e,t):new Wr(e)}catch(e){return this.emitReserved("error",e)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){var t=e[r];const n=r===e.length-1;lr(t,this.supportsBinary,(e=>{try{this.ws.send(e)}catch(e){}n&&Kr((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){var e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=jr()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!Wr}},webtransport:class extends Nr{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then((()=>{this.onClose()})).catch((e=>{this.onError("webtransport error",e)})),this.transport.ready.then((()=>{this.transport.createBidirectionalStream().then((e=>{var t=function(e,t){br=br||new TextDecoder;const r=[];let n=0,s=-1,i=!1;return new TransformStream({transform(o,a){for(r.push(o);;){if(0===n){if(_r(r)<1)break;var l=kr(r,1);i=128==(128&l[0]),s=127&l[0],n=s<126?3:126===s?1:2}else if(1===n){if(_r(r)<2)break;l=kr(r,2),s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(2===n){if(_r(r)<8)break;var h=kr(r,8),c=(h=new DataView(h.buffer,h.byteOffset,h.length)).getUint32(0);if(c>Math.pow(2,21)-1){a.enqueue(sr);break}s=c*Math.pow(2,32)+h.getUint32(4),n=3}else{if(_r(r)<s)break;c=kr(r,s),a.enqueue(gr(i?c:br.decode(c),t)),n=0}if(0===s||s>e){a.enqueue(sr);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType);const r=e.readable.pipeThrough(t).getReader();(t=wr()).readable.pipeTo(e.writable),this.writer=t.writable.getWriter();const n=()=>{r.read().then((({done:e,value:t})=>{e||(this.onPacket(t),n())})).catch((e=>{}))};n(),e={type:"open"},this.query.sid&&(e.data=`{"sid":"${this.query.sid}"}`),this.writer.write(e).then((()=>this.onOpen()))}))})))}write(e){this.writable=!1;for(let r=0;r<e.length;r++){var t=e[r];const n=r===e.length-1;this.writer.write(t).then((()=>{n&&Kr((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){var e;null!=(e=this.transport)&&e.close()}},polling:class extends Nr{constructor(e){if(super(e),this.polling=!1,"undefined"!=typeof location){var t="https:"===location.protocol;let r=location.port;r=r||(t?"443":"80"),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||r!==e.port}t=e&&e.forceBase64,this.supportsBinary=qr&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let e=0;this.polling&&(e++,this.once("pollComplete",(function(){--e||t()}))),this.writable||(e++,this.once("drain",(function(){--e||t()})))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{var r=e.split(yr),n=[];for(let e=0;e<r.length;e++){var s=gr(r[e],t);if(n.push(s),"error"===s.type)break}return n})(e,this.socket.binaryType).forEach((e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState)&&this.poll()}doClose(){var e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach(((e,i)=>{lr(e,!1,(e=>{n[i]=e,++s===r&&t(n.join(yr))}))}))})(e,(e=>{this.doWrite(e,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){var e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=jr()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Hr(this.uri(),e)}doWrite(e,t){(e=this.request({method:"POST",data:e})).on("success",t),e.on("error",((e,t)=>{this.onError("xhr post error",e,t)}))}doPoll(){var e=this.request();e.on("data",this.onData.bind(this)),e.on("error",((e,t)=>{this.onError("xhr poll error",e,t)})),this.pollXhr=e}}},Yr=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Xr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Zr(e){var t=e,r=e.indexOf("["),n=e.indexOf("]");-1!=r&&-1!=n&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=Yr.exec(e||""),i={},o=14;for(;o--;)i[Xr[o]]=s[o]||"";return-1!=r&&-1!=n&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(e,t){var r=t.replace(/\/{2,9}/g,"/").split("/");return"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1),"/"==t.slice(-1)&&r.splice(r.length-1,1),r}(0,i.path),i.queryKey=function(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(r[t]=n)})),r}(0,i.query),i}let en=class e extends Er{constructor(e,t={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],e&&"object"==typeof e&&(t=e,e=null),e?(e=Zr(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=Zr(t.host).host),Sr(this,t),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=t.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(e){var t={},r=e.split("&");for(let e=0,s=r.length;e<s;e++){var n=r[e].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return t}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname)&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1)),this.open()}createTransport(e){var t=((t=Object.assign({},this.opts.query)).EIO=4,t.transport=e,this.id&&(t.sid=this.id),Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]));return new Jr[e](t)}open(){let t;if(this.opts.rememberUpgrade&&e.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),(this.transport=e).on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(e=>this.onClose("transport close",e)))}probe(t){let r=this.createTransport(t),n=!1;e.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(t=>{n||("pong"===t.type&&"probe"===t.data?(this.upgrading=!0,this.emitReserved("upgrading",r),r&&(e.priorWebsocketSuccess="websocket"===r.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(c(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})))):((t=new Error("probe error")).transport=r.name,this.emitReserved("upgradeError",t)))})))};function i(){n||(n=!0,c(),r.close(),r=null)}const o=e=>{(e=new Error("probe error: "+e)).transport=r.name,i(),this.emitReserved("upgradeError",e)};function a(){o("transport closed")}function l(){o("socket closed")}function h(e){r&&e.name!==r.name&&i()}const c=()=>{r.removeListener("open",s),r.removeListener("error",o),r.removeListener("close",a),this.off("close",l),this.off("upgrading",h)};r.once("open",s),r.once("error",o),r.once("close",a),this.once("close",l),this.once("upgrading",h),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn((()=>{n||r.open()}),200):r.open()}onOpen(){if(this.readyState="open",e.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let e=0;for(var t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){var e;"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(e=this.getWritablePackets(),this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush"))}getWritablePackets(){if(this.maxPayload&&"polling"===this.transport.name&&1<this.writeBuffer.length){let t=1;for(let r=0;r<this.writeBuffer.length;r++){var e=this.writeBuffer[r].data;if(e&&(t+=Ar(e)),0<r&&t>this.maxPayload)return this.writeBuffer.slice(0,r);t+=2}}return this.writeBuffer}write(e,t,r){return this.sendPacket("message",e,t,r),this}send(e,t,r){return this.sendPacket("message",e,t,r),this}sendPacket(e,t,r,n){"function"==typeof t&&(n=t,t=void 0),"function"==typeof r&&(n=r,r=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((r=r||{}).compress=!1!==r.compress,this.emitReserved("packetCreate",e={type:e,data:t,options:r}),this.writeBuffer.push(e),n&&this.once("flush",n),this.flush())}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{(this.upgrading?r:e)()})):(this.upgrading?r:e)()),this}onError(t){e.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){var t=[];let r=0;for(var n=e.length;r<n;r++)~this.transports.indexOf(e[r])&&t.push(e[r]);return t}};en.protocol=4;const tn="function"==typeof ArrayBuffer,rn=e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,nn=Object.prototype.toString,sn="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===nn.call(Blob),on="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===nn.call(File);function an(e){return tn&&(e instanceof ArrayBuffer||rn(e))||sn&&e instanceof Blob||on&&e instanceof File}function ln(e,t){if(e&&"object"==typeof e)if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++)if(ln(e[t]))return!0}else{if(an(e))return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return ln(e.toJSON(),!0);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&ln(e[t]))return!0}return!1}function hn(e){var t=[],r=e.data;return e.data=cn(r,t),e.attachments=t.length,{packet:e,buffers:t}}function cn(e,t){if(!e)return e;var r;if(an(e))return r={_placeholder:!0,num:t.length},t.push(e),r;if(Array.isArray(e)){var n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=cn(e[r],t);return n}if("object"!=typeof e||e instanceof Date)return e;var s={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(s[r]=cn(e[r],t));return s}function un(e,t){return e.data=dn(e.data,t),delete e.attachments,e}function dn(e,t){if(e){if(e&&!0===e._placeholder){if("number"==typeof e.num&&0<=e.num&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=dn(e[r],t);else if("object"==typeof e)for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=dn(e[r],t))}return e}const pn=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"];!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Pe=Pe||{});function fn(e){return"[object Object]"===Object.prototype.toString.call(e)}class gn extends Er{constructor(e){super(),this.reviver=e}add(e){let t;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var r=(t=this.decodeString(e)).type===Pe.BINARY_EVENT;(!r&&t.type!==Pe.BINARY_ACK||(t.type=r?Pe.EVENT:Pe.ACK,this.reconstructor=new mn(t),0===t.attachments))&&super.emitReserved("decoded",t)}else{if(!an(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;var r={type:Number(e.charAt(0))};if(void 0===Pe[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Pe.BINARY_EVENT||r.type===Pe.BINARY_ACK){for(var n=t+1;"-"!==e.charAt(++t)&&t!=e.length;);if((n=e.substring(n,t))!=Number(n)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(n)}if("/"===e.charAt(t+1)){for(n=t+1;++t&&","!==e.charAt(t)&&t!==e.length;);r.nsp=e.substring(n,t)}else r.nsp="/";if(""!==(n=e.charAt(t+1))&&Number(n)==n){for(n=t+1;++t;){var s=e.charAt(t);if(null==s||Number(s)!=s){--t;break}if(t===e.length)break}r.id=Number(e.substring(n,t+1))}if(e.charAt(++t)){if(n=this.tryParse(e.substr(t)),!gn.isPayloadValid(r.type,n))throw new Error("invalid payload");r.data=n}return r}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(e){return!1}}static isPayloadValid(e,t){switch(e){case Pe.CONNECT:return fn(t);case Pe.DISCONNECT:return void 0===t;case Pe.CONNECT_ERROR:return"string"==typeof t||fn(t);case Pe.EVENT:case Pe.BINARY_EVENT:return Array.isArray(t)&&("number"==typeof t[0]||"string"==typeof t[0]&&-1===pn.indexOf(t[0]));case Pe.ACK:case Pe.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class mn{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){return this.buffers.push(e),this.buffers.length===this.reconPack.attachments?(e=un(this.reconPack,this.buffers),this.finishedReconstruction(),e):null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}var vn,yn=Object.freeze({__proto__:null,Decoder:gn,Encoder:class{constructor(e){this.replacer=e}encode(e){return e.type!==Pe.EVENT&&e.type!==Pe.ACK||!ln(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Pe.EVENT?Pe.BINARY_EVENT:Pe.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==Pe.BINARY_EVENT&&e.type!==Pe.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){e=hn(e);var t=this.encodeAsString(e.packet);return(e=e.buffers).unshift(t),e}},get PacketType(){return Pe},protocol:5});function wn(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const bn=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class _n extends Er{constructor(e,t,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){var e;this.subs||(e=this.io,this.subs=[wn(e,"open",this.onopen.bind(this)),wn(e,"packet",this.onpacket.bind(this)),wn(e,"error",this.onerror.bind(this)),wn(e,"close",this.onclose.bind(this))])}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(bn.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');var r,n;return t.unshift(e),!this._opts.retries||this.flags.fromQueue||this.flags.volatile?((e={type:Pe.EVENT,data:t,options:{}}).options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(r=this.ids++,n=t.pop(),this._registerAckCallback(r,n),e.id=r),n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable,(!this.flags.volatile||n&&this.connected)&&(this.connected?(this.notifyOutgoingListeners(e),this.packet(e)):this.sendBuffer.push(e)),this.flags={}):this._addToQueue(t),this}_registerAckCallback(e,t){var r=null!=(r=this.flags.timeout)?r:this._opts.ackTimeout;if(void 0===r)this.acks[e]=t;else{const n=this.io.setTimeoutFn((()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))}),r);this.acks[e]=(...e)=>{this.io.clearTimeoutFn(n),t.apply(this,[null,...e])}}}emitWithAck(e,...t){const r=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise(((n,s)=>{t.push(((e,t)=>r?e?s(e):n(t):n(e))),this.emit(e,...t)}))}_addToQueue(e){let t;"function"==typeof e[e.length-1]&&(t=e.pop());const r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(((e,...n)=>{if(r===this._queue[0])return null!==e?r.tryCount>this._opts.retries&&(this._queue.shift(),t)&&t(e):(this._queue.shift(),t&&t(null,...n)),r.pending=!1,this._drainQueue()})),this._queue.push(r),this._drainQueue()}_drainQueue(e=!1){var t;!this.connected||0===this._queue.length||(t=this._queue[0]).pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth((e=>{this._sendConnectPacket(e)})):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Pe.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Pe.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Pe.EVENT:case Pe.BINARY_EVENT:this.onevent(e);break;case Pe.ACK:case Pe.BINARY_ACK:this.onack(e);break;case Pe.DISCONNECT:this.ondisconnect();break;case Pe.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length)for(const t of this._anyListeners.slice())t.apply(this,e);super.emit.apply(this,e),this._pid&&e.length&&"string"==typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let r=!1;return function(...n){r||(r=!0,t.packet({type:Pe.ACK,id:e,data:n}))}}onack(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach((e=>this.emitEvent(e))),this.receiveBuffer=[],this.sendBuffer.forEach((e=>{this.notifyOutgoingListeners(e),this.packet(e)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((e=>e())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Pe.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(this._anyListeners)if(e){var t=this._anyListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(this._anyOutgoingListeners)if(e){var t=this._anyOutgoingListeners;for(let r=0;r<t.length;r++)if(e===t[r])return t.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(const t of this._anyOutgoingListeners.slice())t.apply(this,e.data)}}function kn(e){this.ms=(e=e||{}).min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}kn.prototype.duration=function(){var e,t,r=this.ms*Math.pow(this.factor,this.attempts++);return this.jitter&&(e=Math.random(),t=Math.floor(e*this.jitter*r),r=0==(1&Math.floor(10*e))?r-t:r+t),0|Math.min(r,this.max)},kn.prototype.reset=function(){this.attempts=0},kn.prototype.setMin=function(e){this.ms=e},kn.prototype.setMax=function(e){this.max=e},kn.prototype.setJitter=function(e){this.jitter=e};class En extends Er{constructor(e,t){super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Sr(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!=(r=t.randomizationFactor)?r:.5),this.backoff=new kn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;var r=t.parser||yn;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null!=(t=this.backoff)&&t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null!=(t=this.backoff)&&t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null!=(t=this.backoff)&&t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(!~this._readyState.indexOf("open")){this.engine=new en(this.uri,this.opts);const n=this.engine,s=this,i=(this._readyState="opening",this.skipReconnect=!1,wn(n,"open",(function(){s.onopen(),e&&e()}))),o=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()};var t=wn(n,"error",o);if(!1!==this._timeout){var r=this._timeout;const e=this.setTimeoutFn((()=>{i(),o(new Error("timeout")),n.close()}),r);this.opts.autoUnref&&e.unref(),this.subs.push((()=>{this.clearTimeoutFn(e)}))}this.subs.push(i),this.subs.push(t)}return this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(wn(e,"ping",this.onping.bind(this)),wn(e,"data",this.ondata.bind(this)),wn(e,"error",this.onerror.bind(this)),wn(e,"close",this.onclose.bind(this)),wn(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(e){this.onclose("parse error",e)}}ondecoded(e){Kr((()=>{this.emitReserved("packet",e)}),this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let r=this.nsps[e];return r?this._autoConnect&&!r.active&&r.connect():(r=new _n(this,e,t),this.nsps[e]=r),r}_destroy(e){for(const e of Object.keys(this.nsps)){if(this.nsps[e].active)return}this._close()}_packet(e){var t=this.encoder.encode(e);for(let r=0;r<t.length;r++)this.engine.write(t[r],e.options)}cleanup(){this.subs.forEach((e=>e())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var t=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn((()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect)||e.open((t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))}),t);this.opts.autoUnref&&r.unref(),this.subs.push((()=>{this.clearTimeoutFn(r)}))}}onreconnect(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Tn={};function xn(e,t){"object"==typeof e&&(t=e,e=void 0);e=function(e,t="",r){let n=e;return r=r||"undefined"!=typeof location&&location,"string"==typeof(e=null==e?r.protocol+"//"+r.host:e)&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?r.protocol+e:r.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==r?r.protocol+"//"+e:"https://"+e),n=Zr(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/",e=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host,n.id=n.protocol+"://"+e+":"+n.port+t,n.href=n.protocol+"://"+e+(r&&r.port===n.port?"":":"+n.port),n}(e,(t=t||{}).path||"/socket.io");var r=e.source,n=e.id,s=e.path;s=Tn[n]&&s in Tn[n].nsps;let i;return i=(s=t.forceNew||t["force new connection"]||!1===t.multiplex||s)?new En(r,t):(Tn[n]||(Tn[n]=new En(r,t)),Tn[n]),e.query&&!t.query&&(t.query=e.queryKey),i.socket(e.path,t)}Object.assign(xn,{Manager:En,Socket:_n,io:xn,connect:xn});const In=ne("<style>"),Cn=ne('<div class="relative z-10" aria-labelledby="modal-title" role="dialog" aria-modal="true"><style></style><div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity animate-fade-in"></div><div class="fixed inset-0 z-10 overflow-y-auto"><div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0"><div class="relative transform overflow-hidden rounded-lg text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg">'),Sn=ne("<div><pre>");const An=e=>{let t;const[r]=K(e,["onOpen","onClose","isOpen","value"]),[n,s]=(I((()=>{t&&(t.innerHTML=function(e){return(e=(e="string"!=typeof e?JSON.stringify(e,void 0,2):e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+-]?\d+)?)/g,(function(e){let t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"}))}(JSON.stringify(e?.value,void 0,2)))})),_(r.isOpen??!1)),i=(E((()=>{_e(e.isOpen)||e.isOpen===n()||a()})),e=>{e.stopPropagation()}),o=()=>{s(!1),r.onClose?.(),document.body.style.overflow="auto"},a=()=>{n()?o():(s(!0),r.onOpen?.(),document.body.style.overflow="hidden")};return z(Q,{get when(){return n()},get children(){return[(he(s=In(),be),s),(s=Cn(),r=s.firstChild,n=r.nextSibling.nextSibling.firstChild.firstChild,s.style.setProperty("z-index","1100"),s.addEventListener("click",o),he(r,be),n.style.setProperty("background-color","transparent"),n.style.setProperty("margin-left","20px"),n.style.setProperty("margin-right","20px"),n.addEventListener("click",i),n.addEventListener("pointerdown",i),he(n,(()=>{const r=T((()=>!!e.value));return()=>{return r()&&(n=(e=Sn()).firstChild,e.style.setProperty("background","white"),e.style.setProperty("margin","auto"),e.style.setProperty("padding","7px"),"function"==typeof(s=t)?le(s,n):t=n,e);var e,n,s}})()),s)];var r,n,s}})},Rn=ne('<button type="submit">'),Nn=e=>{return ae(t=Rn(),G({get disabled(){return e.isDisabled||e.isLoading}},e,{get class(){return"py-2 px-4 justify-center font-semibold focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 chatbot-button "+e.class},style:{background:"transparent",border:"none"}}),!1,!0),he(t,z(et,{get color(){return e.buttonColor}})),t;var t};let On,Pn="00:00";const Dn=1;let Ln;function Mn(e,t,r){jn.start().then((()=>{e&&e(!0),On=new Date,function(e){Pn="00:00",e(Pn),Ln=setInterval((()=>{Pn=function(e){e=(new Date).getTime()-e.getTime();var t=(e/=1e3,Math.floor(e%60)),r=(e=Math.floor(e/60))%60,n=(e=Math.floor(e/60))%24;e=e=Math.floor(e/24),n+=24*e;return 0==n?Fn(r,2)+":"+Fn(t,2):Fn(n,2)+":"+Fn(r,2)+":"+Fn(t,2)}(On),e(Pn),function(){var e=Pn.split(":"),t="0"+Dn;return 3===e.length&&e[0]===t}()&&Un(null)}),1e3)}(r)})).catch((e=>{switch(e.message.includes("mediaDevices API or getUserMedia method is not supported in this browser.")&&t&&t(!0),console.log(e),e.name){case"AbortError":console.log("An AbortError has occurred.");break;case"NotAllowedError":console.log("A NotAllowedError has occurred. User might have denied permission.");break;case"NotFoundError":console.log("A NotFoundError has occurred.");break;case"NotReadableError":console.log("A NotReadableError has occurred.");break;case"SecurityError":console.log("A SecurityError has occurred.");break;case"TypeError":console.log("A TypeError has occurred.");break;case"InvalidStateError":console.log("An InvalidStateError has occurred.");break;case"UnknownError":console.log("An UnknownError has occurred.");break;default:console.log("An error occurred with the error name "+e.name)}}))}function Un(e){jn.stop().then((t=>{clearInterval(Ln),e&&e(t)})).catch((e=>{"InvalidStateError"===e.name?console.log("An InvalidStateError has occurred."):console.log("An error occurred with the error name "+e.name)}))}function Fn(e,t){return(""+e).padStart(t,"0")}const jn={audioBlobs:[],mediaRecorder:null,streamBeingCaptured:null,start:function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{jn.streamBeingCaptured=e,jn.mediaRecorder=new MediaRecorder(e),jn.audioBlobs=[],jn.mediaRecorder.addEventListener("dataavailable",(e=>{jn.audioBlobs.push(e.data)})),jn.mediaRecorder.start()})):Promise.reject(new Error("mediaDevices API or getUserMedia method is not supported in this browser."))},stop:function(){return new Promise((e=>{const t=jn.mediaRecorder?.mimeType;jn.mediaRecorder?.addEventListener("stop",(()=>{var r=new Blob(jn.audioBlobs,{type:t});e(r)})),jn.cancel()}))},cancel:function(){jn.mediaRecorder?.stop(),jn.stopStream(),jn.resetRecordingProperties()},stopStream:function(){jn.streamBeingCaptured?.getTracks().forEach((e=>e.stop()))},resetRecordingProperties:function(){jn.mediaRecorder=null,jn.streamBeingCaptured=null}},Bn=function(e){var t=[];let r=0;for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t[r++]=s:(s<2048?t[r++]=s>>6|192:(55296==(64512&s)&&n+1<e.length&&56320==(64512&e.charCodeAt(n+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++n)),t[r++]=s>>18|240,t[r++]=s>>12&63|128):t[r++]=s>>12|224,t[r++]=s>>6&63|128),t[r++]=63&s|128)}return t},Vn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();var r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let t=0;t<e.length;t+=3){var s=e[t],i=t+1<e.length,o=i?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0;let h=(15&o)<<2|l>>6,c=63&l;a||(c=64,i)||(h=64),n.push(r[s>>2],r[(3&s)<<4|o>>4],r[h],r[c])}return n.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Bn(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){var t=[];let r=0,n=0;for(;r<e.length;){var s,i,o,a=e[r++];a<128?t[n++]=String.fromCharCode(a):191<a&&a<224?(s=e[r++],t[n++]=String.fromCharCode((31&a)<<6|63&s)):239<a&&a<365?(s=((7&a)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))):(i=e[r++],o=e[r++],t[n++]=String.fromCharCode((15&a)<<12|(63&i)<<6|63&o))}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();var r=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let t=0;t<e.length;){var s=r[e.charAt(t++)],i=t<e.length?r[e.charAt(t)]:0,o=++t<e.length?r[e.charAt(t)]:64,a=++t<e.length?r[e.charAt(t)]:64;if(++t,null==s||null==i||null==o||null==a)throw new zn;n.push(s<<2|i>>4),64!==o&&(n.push(i<<4&240|o>>2),64!==a)&&n.push(o<<6&192|a)}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class zn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $n=function(e){return function(e){return e=Bn(e),Vn.encodeByteArray(e,!0)}(e).replace(/\./g,"")},qn=function(e){try{return Vn.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};const Hn=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Gn=()=>{try{return Hn()||(()=>{var e;return"undefined"!=typeof process&&void 0!==process.env&&(e=process.env.__FIREBASE_DEFAULTS__)?JSON.parse(e):void 0})()||(()=>{if("undefined"!=typeof document){let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}var e=t&&qn(t[1]);return e&&JSON.parse(e)}})()}catch(e){console.info("Unable to get __FIREBASE_DEFAULTS__ due to: "+e)}},Kn=e=>{var t;return null==(t=null==(t=Gn())?void 0:t.emulatorHosts)?void 0:t[e]},Wn=e=>{if(e=Kn(e)){var t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);var r=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),r]:[e.substring(0,t),r]}},Qn=()=>{var e;return null==(e=Gn())?void 0:e.config},Jn=e=>{var t;return null==(t=Gn())?void 0:t["_"+e]};class Yn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,r))}}}function Xn(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');t=t||"demo-project";var r=e.iat||0,n=e.sub||e.user_id;if(n)return t=Object.assign({iss:"https://securetoken.google.com/"+t,aud:t,iat:r,exp:r+3600,auth_time:r,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},e),[$n(JSON.stringify({alg:"none",type:"JWT"})),$n(JSON.stringify(t)),""].join(".");throw new Error("mockUserToken must contain 'sub' or 'user_id' field!")}function Zn(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function es(){return!function(){var e=null==(e=Gn())?void 0:e.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(e){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ts(){try{return"object"==typeof indexedDB}catch(e){return!1}}class rs extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,rs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ns.prototype.create)}}class ns{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){t=t[0]||{};var r=this.service+"/"+e;e=(e=this.errors[e])?function(e,t){return e.replace(ss,((e,r)=>{var n=t[r];return null!=n?String(n):`<${r}?>`}))}(e,t):"Error",e=this.serviceName+`: ${e} (${r}).`;return new rs(r,e,t)}}const ss=/\{\$([^}]+)}/g;function is(e,t){if(e!==t){var r=Object.keys(e),n=Object.keys(t);for(const o of r){if(!n.includes(o))return!1;var s=e[o],i=t[o];if(os(s)&&os(i)){if(!is(s,i))return!1}else if(s!==i)return!1}for(const e of n)if(!r.includes(e))return!1}return!0}function os(e){return null!==e&&"object"==typeof e}function as(e){const t=[];for(const[r,n]of Object.entries(e))Array.isArray(n)?n.forEach((e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}class ls{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,r){let n;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");return void 0===(n=function(e,t){if("object"==typeof e&&null!==e)for(const r of t)if(r in e&&"function"==typeof e[r])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r}).next&&(n.next=hs),void 0===n.error&&(n.error=hs),void 0===n.complete&&(n.complete=hs),e=this.unsubscribeOne.bind(this,this.observers.length),this.finalized&&this.task.then((()=>{try{this.finalError?n.error(this.finalError):n.complete()}catch(e){}})),this.observers.push(n),e}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],--this.observerCount,0===this.observerCount)&&void 0!==this.onNoObservers&&this.onNoObservers(this)}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function hs(){}function cs(e){return e&&e._delegate?e._delegate:e}class us{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ds="[DEFAULT]";class ps{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){if(e=this.normalizeInstanceIdentifier(e),!this.instancesDeferred.has(e)){var t=new Yn;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&t.resolve(r)}catch(e){}}return this.instancesDeferred.get(e).promise}getImmediate(e){var t=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier);e=null!=(e=null==e?void 0:e.optional)&&e;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(e)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(t){if(e)return null;throw t}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:ds})}catch(e){}for(var[t,r]of this.instancesDeferred.entries()){t=this.normalizeInstanceIdentifier(t);try{var n=this.getOrInitializeService({instanceIdentifier:t});r.resolve(n)}catch(e){}}}}clearInstance(e=ds){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){var e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=ds){return this.instances.has(e)}getOptions(e=ds){return this.instancesOptions.get(e)||{}}initialize(e={}){var{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(this.name+`(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);var n,s,i=this.getOrInitializeService({instanceIdentifier:r,options:t});for([n,s]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(n)&&s.resolve(i);return i}onInit(e,t){t=this.normalizeInstanceIdentifier(t);const r=null!=(n=this.onInitCallbacks.get(t))?n:new Set;r.add(e),this.onInitCallbacks.set(t,r);var n=this.instances.get(t);return n&&e(n,t),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){var r=this.onInitCallbacks.get(t);if(r)for(const n of r)try{n(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:fs(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(e){}return r||null}normalizeInstanceIdentifier(e=ds){return!this.component||this.component.multipleInstances?e:ds}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function fs(e){return e===ds?void 0:e}class gs{constructor(e){this.name=e,this.providers=new Map}addComponent(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with `+this.name);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){var t;return this.providers.has(e)?this.providers.get(e):(t=new ps(e,this),this.providers.set(e,t),t)}getProviders(){return Array.from(this.providers.values())}}!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(vn=vn||{});const ms={debug:vn.DEBUG,verbose:vn.VERBOSE,info:vn.INFO,warn:vn.WARN,error:vn.ERROR,silent:vn.SILENT},vs=vn.INFO,ys={[vn.DEBUG]:"log",[vn.VERBOSE]:"log",[vn.INFO]:"info",[vn.WARN]:"warn",[vn.ERROR]:"error"},ws=(e,t,...r)=>{if(!(t<e.logLevel)){var n=(new Date).toISOString(),s=ys[t];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[s](`[${n}]  ${e.name}:`,...r)}};class bs{constructor(e){this.name=e,this._logLevel=vs,this._logHandler=ws,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ms[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vn.DEBUG,...e),this._logHandler(this,vn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vn.VERBOSE,...e),this._logHandler(this,vn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vn.INFO,...e),this._logHandler(this,vn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vn.WARN,...e),this._logHandler(this,vn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vn.ERROR,...e),this._logHandler(this,vn.ERROR,...e)}}const _s=(e,t)=>t.some((t=>e instanceof t));let ks,Es;const Ts=new WeakMap,xs=new WeakMap,Is=new WeakMap,Cs=new WeakMap,Ss=new WeakMap;let As={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return xs.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Is.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Os(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Rs(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Es=Es||[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]).includes(e)?function(...t){return e.apply(Ps(this),t),Os(Ts.get(this))}:function(...t){return Os(e.apply(Ps(this),t))}:function(t,...r){return r=e.call(Ps(this),t,...r),Is.set(r,t.sort?t.sort():[t]),Os(r)}}function Ns(e){return"function"==typeof e?Rs(e):(e instanceof IDBTransaction&&function(e){var t;xs.has(e)||(t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),n()},i=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)})),xs.set(e,t))}(e),_s(e,ks=ks||[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])?new Proxy(e,As):e)}function Os(e){var t;return e instanceof IDBRequest?function(e){var t=new Promise(((t,r)=>{const n=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(Os(e.result)),n()},i=()=>{r(e.error),n()};e.addEventListener("success",s),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&Ts.set(t,e)})).catch((()=>{})),Ss.set(t,e),t}(e):Cs.has(e)?Cs.get(e):((t=Ns(e))!==e&&(Cs.set(e,t),Ss.set(t,e)),t)}const Ps=e=>Ss.get(e);const Ds=["get","getKey","getAll","getAllKeys","count"],Ls=["put","add","delete","clear"],Ms=new Map;function Us(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(Ms.get(t))return Ms.get(t);const r=t.replace(/FromIndex$/,""),n=t!==r,s=Ls.includes(r);return r in(n?IDBIndex:IDBObjectStore).prototype&&(s||Ds.includes(r))?(e=async function(e,...t){let i=(e=this.transaction(e,s?"readwrite":"readonly")).store;return n&&(i=i.index(t.shift())),(await Promise.all([i[r](...t),s&&e.done]))[0]},Ms.set(t,e),e):void 0}}!function(e){As=e(As)}((e=>({...e,get:(t,r,n)=>Us(t,r)||e.get(t,r,n),has:(t,r)=>!!Us(t,r)||e.has(t,r)})));class Fs{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>function(e){return e=e.getComponent(),"VERSION"===(null==e?void 0:e.type)}(e)?(e=e.getImmediate()).library+"/"+e.version:null)).filter((e=>e)).join(" ")}}const js="@firebase/app",Bs="0.10.1",Vs=new bs("@firebase/app"),zs="[DEFAULT]",$s={[js]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},qs=new Map,Hs=new Map,Gs=new Map;function Ks(e,t){try{e.container.addComponent(t)}catch(r){Vs.debug(`Component ${t.name} failed to register with FirebaseApp `+e.name,r)}}function Ws(e){var t=e.name;if(Gs.has(t))return Vs.debug(`There were multiple attempts to register component ${t}.`),!1;Gs.set(t,e);for(const t of qs.values())Ks(t,e);for(const t of Hs.values())Ks(t,e);return!0}function Qs(e,t){var r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function Js(e){return void 0!==e.settings}const Ys=new ns("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Xs{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new us("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ys.create("app-deleted",{appName:this._name})}}const Zs="10.11.0";function ei(e,t={}){let r=e;if("object"!=typeof t){t={name:t}}const n=(e=Object.assign({name:zs,automaticDataCollectionEnabled:!1},t)).name;if("string"!=typeof n||!n)throw Ys.create("bad-app-name",{appName:String(n)});if(!(r=r||Qn()))throw Ys.create("no-options");if(t=qs.get(n)){if(is(r,t.options)&&is(e,t.config))return t;throw Ys.create("duplicate-app",{appName:n})}var s=new gs(n);for(const e of Gs.values())s.addComponent(e);return t=new Xs(r,e,s),qs.set(n,t),t}function ti(e=zs){var t=qs.get(e);if(!t&&e===zs&&Qn())return ei();if(t)return t;throw Ys.create("no-app",{appName:e})}function ri(e,t,r){let n=null!=(s=$s[e])?s:e;r&&(n+="-"+r);var s=n.match(/\s|\//);e=t.match(/\s|\//);s||e?(r=[`Unable to register library "${n}" with version "${t}":`],s&&r.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&e&&r.push("and"),e&&r.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Vs.warn(r.join(" "))):Ws(new us(n+"-version",(()=>({library:n,version:t})),"VERSION"))}const ni="firebase-heartbeat-database",si=1,ii="firebase-heartbeat-store";let oi=null;function ai(){return oi=oi||function(e,t,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t);return e=Os(o),n&&o.addEventListener("upgradeneeded",(e=>{n(Os(o.result),e.oldVersion,e.newVersion,Os(o.transaction),e)})),r&&o.addEventListener("blocked",(e=>r(e.oldVersion,e.newVersion,e))),e.then((e=>{i&&e.addEventListener("close",(()=>i())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),e}(ni,si,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ii)}catch(e){console.warn(e)}}}).catch((e=>{throw Ys.create("idb-open",{originalErrorMessage:e.message})}))}async function li(e,t){try{var r=(await ai()).transaction(ii,"readwrite");await r.objectStore(ii).put(t,hi(e)),await r.done}catch(e){e instanceof rs?Vs.warn(e.message):(t=Ys.create("idb-set",{originalErrorMessage:null==e?void 0:e.message}),Vs.warn(t.message))}}function hi(e){return e.name+"!"+e.options.appId}class ci{constructor(e){this.container=e,this._heartbeatsCache=null,e=this.container.getProvider("app").getImmediate(),this._storage=new di(e),this._heartbeatsCachePromise=this._storage.read().then((e=>this._heartbeatsCache=e))}async triggerHeartbeat(){var e,t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString();const r=ui();if((null!=(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>(e=new Date(e.date).valueOf(),Date.now()-e<=2592e6))),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e,t,r;return null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null==(e=this._heartbeatsCache)?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length?"":(e=ui(),({heartbeatsToSend:r,unsentEntries:t}=function(e,t=1024){var r=[];let n=e.slice();for(const i of e){var s=r.find((e=>e.agent===i.agent));if(s){if(s.dates.push(i.date),pi(r)>t){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),pi(r)>t){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}(this._heartbeatsCache.heartbeats)),r=$n(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=e,0<t.length?(this._heartbeatsCache.heartbeats=t,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r)}}function ui(){return(new Date).toISOString().substring(0,10)}class di{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ts()&&new Promise(((e,t)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),e(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var e;t((null==(e=s.error)?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){var e;return await this._canUseIndexedDBPromise&&null!=(e=await async function(e){try{var t=(await ai()).transaction(ii),r=await t.objectStore(ii).get(hi(e));return await t.done,r}catch(t){t instanceof rs?Vs.warn(t.message):(e=Ys.create("idb-get",{originalErrorMessage:null==t?void 0:t.message}),Vs.warn(e.message))}}(this.app))&&e.heartbeats?e:{heartbeats:[]}}async overwrite(e){var t,r;if(await this._canUseIndexedDBPromise)return r=await this.read(),li(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}async add(e){var t,r;if(await this._canUseIndexedDBPromise)return r=await this.read(),li(this.app,{lastSentHeartbeatDate:null!=(t=e.lastSentHeartbeatDate)?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}function pi(e){return $n(JSON.stringify({version:2,heartbeats:e})).length}!function(e){Ws(new us("platform-logger",(e=>new Fs(e)),"PRIVATE")),Ws(new us("heartbeat",(e=>new ci(e)),"PRIVATE")),ri(js,Bs,e),ri(js,Bs,"esm2017"),ri("fire-js","")}("");var fi,gi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},mi=mi||{},vi=gi||self;function yi(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function wi(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var bi="closure_uid_"+(1e9*Math.random()>>>0),_i=0;function ki(e,t,r){return e.call.apply(e.bind,arguments)}function Ei(e,t,r){var n;if(e)return 2<arguments.length?(n=Array.prototype.slice.call(arguments,2),function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}):function(){return e.apply(t,arguments)};throw Error()}function Ti(e,t,r){return(Ti=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ki:Ei).apply(null,arguments)}function xi(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Ii(e,t){function r(){}r.prototype=t.prototype,e.$=t.prototype,e.prototype=new r,(e.prototype.constructor=e).ac=function(e,r,n){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[r].apply(e,s)}}function Ci(){this.s=this.s,this.o=this.o}Ci.prototype.s=!1,Ci.prototype.sa=function(){this.s||(this.s=!0,this.N(),1)||function(e){Object.prototype.hasOwnProperty.call(e,bi)&&e[bi]||(e[bi]=++_i)}(this)},Ci.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Si=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let r=0;r<e.length;r++)if(r in e&&e[r]===t)return r;return-1};function Ai(e){var t=e.length;if(0<t){var r=Array(t);for(let n=0;n<t;n++)r[n]=e[n];return r}return[]}function Ri(e,t){for(let t=1;t<arguments.length;t++){var r=arguments[t];if(yi(r)){var n=e.length||0,s=r.length||0;e.length=n+s;for(let t=0;t<s;t++)e[n+t]=r[t]}else e.push(r)}}function Ni(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Ni.prototype.h=function(){this.defaultPrevented=!0};var Oi=function(){if(!vi.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{var r=()=>{};vi.addEventListener("test",r,t),vi.removeEventListener("test",r,t)}catch(e){}return e}();function Pi(e){return/^[\s\xa0]*$/.test(e)}function Di(){var e=vi.navigator;return(e=e&&e.userAgent)||""}function Li(e){return-1!=Di().indexOf(e)}function Mi(e){return Mi[" "](e),e}Mi[" "]=function(){};var Ui,Fi=Li("Opera"),ji=Li("Trident")||Li("MSIE"),Bi=Li("Edge"),Vi=Bi||ji,zi=Li("Gecko")&&!(-1!=Di().toLowerCase().indexOf("webkit")&&!Li("Edge"))&&!(Li("Trident")||Li("MSIE"))&&!Li("Edge"),$i=-1!=Di().toLowerCase().indexOf("webkit")&&!Li("Edge");function qi(){var e=vi.document;return e?e.documentMode:void 0}e:{var Hi="",Gi=function(){var e=Di();return zi?/rv:([^\);]+)(\)|;)/.exec(e):Bi?/Edge\/([\d\.]+)/.exec(e):ji?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):$i?/WebKit\/(\S+)/.exec(e):Fi?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Gi&&(Hi=Gi?Gi[1]:""),ji){var Ki=qi();if(null!=Ki&&Ki>parseFloat(Hi)){Ui=String(Ki);break e}}Ui=Hi}var Wi=vi.document&&ji&&(qi()||parseInt(Ui,10))||void 0;function Qi(e,t){if(Ni.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,n=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(zi){e:{try{Mi(t.nodeName);var s=!0;break e}catch(e){}s=!1}s||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Ji[e.pointerType]||"",this.state=e.state,(this.i=e).defaultPrevented&&Qi.$.h.call(this)}}Ii(Qi,Ni);var Ji={2:"touch",3:"pen",4:"mouse"},Yi=(Qi.prototype.h=function(){Qi.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1},"closure_listenable_"+(1e6*Math.random()|0)),Xi=0;function Zi(e,t,r,n,s){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!n,this.la=s,this.key=++Xi,this.fa=this.ia=!1}function eo(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function to(e,t,r){for(const n in e)t.call(r,e[n],n,e)}function ro(e){var t={};for(const r in e)t[r]=e[r];return t}const no="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function so(e,t){let r,n;for(let t=1;t<arguments.length;t++){for(r in n=arguments[t])e[r]=n[r];for(let t=0;t<no.length;t++)r=no[t],Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}}function io(e){this.src=e,this.g={},this.h=0}function oo(e,t){var r,n,s,i=t.type;i in e.g&&(r=e.g[i],(s=0<=(n=Si(r,t)))&&Array.prototype.splice.call(r,n,1),s)&&(eo(t),0==e.g[i].length)&&(delete e.g[i],e.h--)}function ao(e,t,r,n){for(var s=0;s<e.length;++s){var i=e[s];if(!i.fa&&i.listener==t&&i.capture==!!r&&i.la==n)return s}return-1}io.prototype.add=function(e,t,r,n,s){var i=e.toString(),o=((e=this.g[i])||(e=this.g[i]=[],this.h++),ao(e,t,n,s));return-1<o?(t=e[o],r||(t.ia=!1)):((t=new Zi(t,this.src,i,!!n,s)).ia=r,e.push(t)),t};var lo="closure_lm_"+(1e6*Math.random()|0),ho={};function co(e,t,r,n,s){if(n&&n.once)return po(e,t,r,n,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)co(e,t[i],r,n,s);return null}return r=bo(r),e&&e[Yi]?e.O(t,r,wi(n)?!!n.capture:!!n,s):uo(e,t,r,!1,n,s)}function uo(e,t,r,n,s,i){if(!t)throw Error("Invalid event type");var o=wi(s)?!!s.capture:!!s,a=yo(e);if(a||(e[lo]=a=new io(e)),!(r=a.add(t,r,n,o,i)).proxy)if(n=function(){const e=vo;return function t(r){return e.call(t.src,t.listener,r)}}(),(r.proxy=n).src=e,n.listener=r,e.addEventListener)void 0===(s=Oi?s:o)&&(s=!1),e.addEventListener(t.toString(),n,s);else if(e.attachEvent)e.attachEvent(mo(t.toString()),n);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(n)}return r}function po(e,t,r,n,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)po(e,t[i],r,n,s);return null}return r=bo(r),e&&e[Yi]?e.P(t,r,wi(n)?!!n.capture:!!n,s):uo(e,t,r,!0,n,s)}function fo(e,t,r,n,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)fo(e,t[i],r,n,s);else n=wi(n)?!!n.capture:!!n,r=bo(r),e&&e[Yi]?(e=e.i,(t=String(t).toString())in e.g&&-1<(r=ao(i=e.g[t],r,n,s))&&(eo(i[r]),Array.prototype.splice.call(i,r,1),0==i.length)&&(delete e.g[t],e.h--)):(e=e&&yo(e))&&(t=e.g[t.toString()],r=(e=-1)<(e=t?ao(t,r,n,s):e)?t[e]:null)&&go(r)}function go(e){var t,r,n;"number"!=typeof e&&e&&!e.fa&&((t=e.src)&&t[Yi]?oo(t.i,e):(r=e.type,n=e.proxy,t.removeEventListener?t.removeEventListener(r,n,e.capture):t.detachEvent?t.detachEvent(mo(r),n):t.addListener&&t.removeListener&&t.removeListener(n),(r=yo(t))?(oo(r,e),0==r.h&&(r.src=null,t[lo]=null)):eo(e)))}function mo(e){return e in ho?ho[e]:ho[e]="on"+e}function vo(e,t){var r,n;return!!e.fa||(t=new Qi(t,this),r=e.listener,n=e.la||e.src,e.ia&&go(e),r.call(n,t))}function yo(e){return(e=e[lo])instanceof io?e:null}var wo="__closure_events_fn_"+(1e9*Math.random()>>>0);function bo(e){return"function"==typeof e?e:(e[wo]||(e[wo]=function(t){return e.handleEvent(t)}),e[wo])}function _o(){Ci.call(this),this.i=new io(this),(this.S=this).J=null}function ko(e,t){var r,n=e.J;if(n)for(r=[];n;n=n.J)r.push(n);if(e=e.S,n=t.type||t,"string"==typeof t?t=new Ni(t,e):t instanceof Ni?t.target=t.target||e:(o=t,so(t=new Ni(n,e),o)),o=!0,r)for(var s=r.length-1;0<=s;s--)var i=t.g=r[s],o=Eo(i,n,!0,t)&&o;if(o=Eo(i=t.g=e,n,!0,t)&&o,o=Eo(i,n,!1,t)&&o,r)for(s=0;s<r.length;s++)o=Eo(i=t.g=r[s],n,!1,t)&&o}function Eo(e,t,r,n){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var o,a,l=t[i];l&&!l.fa&&l.capture==r&&(o=l.listener,a=l.la||l.src,l.ia&&oo(e.i,l),s=!1!==o.call(a,n)&&s)}return s&&!n.defaultPrevented}Ii(_o,Ci),_o.prototype[Yi]=!0,_o.prototype.removeEventListener=function(e,t,r,n){fo(this,e,t,r,n)},_o.prototype.N=function(){if(_o.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],n=0;n<r.length;n++)eo(r[n]);delete t.g[e],t.h--}}this.J=null},_o.prototype.O=function(e,t,r,n){return this.i.add(String(e),t,!1,r,n)},_o.prototype.P=function(e,t,r,n){return this.i.add(String(e),t,!0,r,n)};var To=vi.JSON.stringify;function xo(){var e=Oo;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Io=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Co),(e=>e.reset()));class Co{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function So(e){for(var t=1,r=(e=e.split(":"),[]);0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function Ao(e){vi.setTimeout((()=>{throw e}),0)}let Ro,No=!1,Oo=new class{constructor(){this.h=this.g=null}add(e,t){var r=Io.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},Po=()=>{const e=vi.Promise.resolve(void 0);Ro=()=>{e.then(Do)}};var Do=()=>{for(var e;e=xo();){try{e.h.call(e.g)}catch(e){Ao(e)}var t=Io;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}No=!1};function Lo(e,t){_o.call(this),this.h=e||1,this.g=t||vi,this.j=Ti(this.qb,this),this.l=Date.now()}function Mo(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function Uo(e,t,r){if("function"==typeof e)r&&(e=Ti(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Ti(e.handleEvent,e)}return 2147483647<Number(t)?-1:vi.setTimeout(e,t||0)}function Fo(e){e.g=Uo((()=>{e.g=null,e.i&&(e.i=!1,Fo(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Ii(Lo,_o),(fi=Lo.prototype).ga=!1,fi.T=null,fi.qb=function(){var e;this.ga&&(0<(e=Date.now()-this.l)&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ko(this,"tick"),this.ga&&(Mo(this),this.start())))},fi.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},fi.N=function(){Lo.$.N.call(this),Mo(this),delete this.g};class jo extends Ci{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Fo(this)}N(){super.N(),this.g&&(vi.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bo(e){Ci.call(this),this.h=e,this.g={}}Ii(Bo,Ci);var Vo=[];function zo(e,t,r,n){Array.isArray(r)||(r&&(Vo[0]=r.toString()),r=Vo);for(var s=0;s<r.length;s++){var i=co(t,r[s],n||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function $o(e){to(e.g,(function(e,t){this.g.hasOwnProperty(t)&&go(e)}),e),e.g={}}function qo(){this.g=!0}function Ho(e,t,r,n){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var n=r[e];if(!(n.length<2)){var s=n[1];if(Array.isArray(s)&&!(s.length<1)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<s.length;o++)s[o]=""}}}return To(r)}catch(e){return t}}(e,r)+(n?" "+n:"")}))}Bo.prototype.N=function(){Bo.$.N.call(this),$o(this)},Bo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},qo.prototype.Ea=function(){this.g=!1},qo.prototype.info=function(){};var Go={},Ko=null;function Wo(){return Ko=Ko||new _o}function Qo(e){Ni.call(this,Go.Ta,e)}function Jo(e){var t=Wo();ko(t,new Qo(t))}function Yo(e,t){Ni.call(this,Go.STAT_EVENT,e),this.stat=t}function Xo(e){var t=Wo();ko(t,new Yo(t,e))}function Zo(e,t){Ni.call(this,Go.Ua,e),this.size=t}function ea(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return vi.setTimeout((function(){e()}),t)}Go.Ta="serverreachability",Ii(Qo,Ni),Go.STAT_EVENT="statevent",Ii(Yo,Ni),Go.Ua="timingevent",Ii(Zo,Ni);var ta={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ra={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function na(){}function sa(e){return e.h||(e.h=e.i())}function ia(){}na.prototype.h=null;var oa={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function aa(){Ni.call(this,"d")}function la(){Ni.call(this,"c")}function ha(){}function ca(e,t,r,n){this.l=e,this.j=t,this.m=r,this.W=n||1,this.U=new Bo(this),this.P=pa,this.V=new Lo(e=Vi?125:void 0),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ua}function ua(){this.i=null,this.g="",this.h=!1}Ii(aa,Ni),Ii(la,Ni),Ii(ha,na),ha.prototype.g=function(){return new XMLHttpRequest},ha.prototype.i=function(){return{}};var da=new ha,pa=45e3,fa={},ga={};function ma(e,t,r){e.L=1,e.A=La(Ra(t)),e.u=r,e.S=!0,va(e,null)}function va(e,t){e.G=Date.now(),_a(e),e.B=Ra(e.A);var r=e.B,n=e.W;Array.isArray(n)||(n=[String(n)]),Wa(r.i,"t",n),e.o=0,r=e.l.J,e.h=new ua,e.g=Wl(e.l,r?t:null,!e.u),0<e.O&&(e.M=new jo(Ti(e.Pa,e,e.g),e.O)),zo(e.U,e.g,"readystatechange",e.nb),t=e.I?ro(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),Jo(),function(e,t,r,n,s,i){e.info((function(){if(e.g)if(i)for(var o="",a=i.split("&"),l=0;l<a.length;l++){var h,c,u=a[l].split("=");1<u.length&&(h=u[0],u=u[1],o=2<=(c=h.split("_")).length&&"type"==c[1]?o+(h+"=")+u+"&":o+(h+"=redacted&"))}else o=null;else o=i;return"XMLHTTP REQ ("+n+") [attempt "+s+"]: "+t+"\n"+r+"\n"+o}))}(e.j,e.v,e.B,e.m,e.W,e.u)}function ya(e){return!!e.g&&"GET"==e.v&&2!=e.L&&e.l.Ha}function wa(e,t,r){let n,s=!0;for(;!e.J&&e.o<r.length;){if((n=ba(e,r))==ga){4==t&&(e.s=4,Xo(14),s=!1),Ho(e.j,e.m,null,"[Incomplete Response]");break}if(n==fa){e.s=4,Xo(15),Ho(e.j,e.m,r,"[Invalid Chunk]"),s=!1;break}Ho(e.j,e.m,n,null),Ia(e,n)}ya(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=r.length||e.h.h||(e.s=1,Xo(16),s=!1),e.i=e.i&&s,s?0<r.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e)&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+r.length),Bl(t),t.M=!0,Xo(11)):(Ho(e.j,e.m,r,"[Invalid Chunked Response]"),xa(e),Ta(e))}function ba(e,t){var r=e.o,n=t.indexOf("\n",r);return-1==n?ga:(r=Number(t.substring(r,n)),isNaN(r)?fa:(n+=1)+r>t.length?ga:(t=t.slice(n,n+r),e.o=n+r,t))}function _a(e){e.Y=Date.now()+e.P,ka(e,e.P)}function ka(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=ea(Ti(e.lb,e),t)}function Ea(e){e.C&&(vi.clearTimeout(e.C),e.C=null)}function Ta(e){0==e.l.H||e.J||$l(e.l,e)}function xa(e){Ea(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,Mo(e.V),$o(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Ia(e,t){try{var r=e.l;if(0!=r.H&&(r.g==e||tl(r.i,e)))if(!e.K&&tl(r.i,e)&&3==r.H){try{var n=r.Ja.g.parse(t)}catch(e){n=null}if(Array.isArray(n)&&3==n.length){var s=n;if(0==s[0]){e:if(!r.u){if(r.g){if(!(r.g.G+3e3<e.G))break e;zl(r),Ol(r)}jl(r),Xo(18)}}else r.Fa=s[1],0<r.Fa-r.V&&s[2]<37500&&r.G&&0==r.A&&!r.v&&(r.v=ea(Ti(r.ib,r),6e3));if(el(r.i)<=1&&r.oa){try{r.oa()}catch(e){}r.oa=void 0}}else Hl(r,11)}else if(!e.K&&r.g!=e||zl(r),!Pi(t))for(s=r.Ja.g.parse(t),t=0;t<s.length;t++){var i,o,a,l,h,c,u,d,p,f,g=s[t];r.V=g[0],g=g[1],2==r.H?"c"==g[0]?(r.K=g[1],r.pa=g[2],null!=(i=g[3])&&(r.ra=i,r.l.info("VER="+r.ra)),null!=(o=g[4])&&(r.Ga=o,r.l.info("SVER="+r.Ga)),null!=(a=g[5])&&"number"==typeof a&&0<a&&(n=1.5*a,r.L=n,r.l.info("backChannelRequestTimeoutMs_="+n)),n=r,(l=e.g)&&(!(h=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null)||(c=n.i).g||-1==h.indexOf("spdy")&&-1==h.indexOf("quic")&&-1==h.indexOf("h2")||(c.j=c.l,c.g=new Set,c.h&&(rl(c,c.h),c.h=null)),n.F)&&(u=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.Da=u,Da(n.I,n.F,u)),r.H=3,r.h&&r.h.Ba(),r.ca&&(r.S=Date.now()-e.G,r.l.info("Handshake RTT: "+r.S+"ms")),d=e,(n=r).wa=Kl(n,n.J?n.pa:null,n.Y),d.K?(nl(n.i,d),p=d,(f=n.L)&&p.setTimeout(f),p.C&&(Ea(p),_a(p)),n.g=d):Fl(n),0<r.j.length&&Dl(r)):"stop"!=g[0]&&"close"!=g[0]||Hl(r,7):3==r.H&&("stop"==g[0]||"close"==g[0]?"stop"==g[0]?Hl(r,7):Nl(r):"noop"!=g[0]&&r.h&&r.h.Aa(g),r.A=0)}Jo()}catch(e){}}function Ca(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(yi(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(yi(e)||"string"==typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r)}else{t=[],r=0;for(const n in e)t[r++]=n}return t}}}(e),n=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(yi(e))for(var t=[],r=e.length,n=0;n<r;n++)t.push(e[n]);else for(n in t=[],r=0,e)t[r++]=e[n];return t}(e),s=n.length,i=0;i<s;i++)t.call(void 0,n[i],r&&r[i],e)}(fi=ca.prototype).setTimeout=function(e){this.P=e},fi.nb=function(e){e=e.target;var t=this.M;t&&3==xl(e)?t.l():this.Pa(e)},fi.Pa=function(e){try{if(e==this.g)e:{var t=xl(this.g),r=this.g.Ia();this.g.da();if(!(t<3)&&(3!=t||Vi||this.g&&(this.h.h||this.g.ja()||Il(this.g)))){this.J||4!=t||7==r||Jo(),Ea(this);var n=this.g.da();this.ca=n;t:if(ya(this)){var s=Il(this.g),i=(e="",s.length),o=4==xl(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){xa(this),Ta(this);var a="";break t}this.h.i=new vi.TextDecoder}for(r=0;r<i;r++)this.h.h=!0,e+=this.h.i.decode(s[r],{stream:o&&r==i-1});s.length=0,this.h.g+=e,this.o=0,a=this.h.g}else a=this.g.ja();if(this.i=200==n,function(e,t,r,n,s,i,o){e.info((function(){return"XMLHTTP RESP ("+n+") [ attempt "+s+"]: "+t+"\n"+r+"\n"+i+" "+o}))}(this.j,this.v,this.B,this.m,this.W,t,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var l,h=this.g;if((l=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Pi(l)){var c=l;break t}}c=null}if(!(n=c)){this.i=!1,this.s=3,Xo(12),xa(this),Ta(this);break e}Ho(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ia(this,n)}this.S?(wa(this,t,a),Vi&&this.i&&3==t&&(zo(this.U,this.V,"tick",this.mb),this.V.start())):(Ho(this.j,this.m,a,null),Ia(this,a)),4==t&&xa(this),this.i&&!this.J&&(4==t?$l(this.l,this):(this.i=!1,_a(this)))}else(function(e){var t,r,n,s={};e=(e.g&&2<=xl(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let i=0;i<e.length;i++)Pi(e[i])||(t=(r=So(e[i]))[0],"string"==typeof(r=r[1])&&(r=r.trim(),n=s[t]||[],(s[t]=n).push(r)));!function(e,t){for(const r in e)t.call(void 0,e[r],r,e)}(s,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Xo(12)):(this.s=0,Xo(13)),xa(this),Ta(this)}}}catch(e){}},fi.mb=function(){var e,t;this.g&&(e=xl(this.g),t=this.g.ja(),this.o<t.length)&&(Ea(this),wa(this,e,t),this.i)&&4!=e&&_a(this)},fi.cancel=function(){this.J=!0,xa(this)},fi.lb=function(){this.C=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.L&&(Jo(),Xo(17)),xa(this),this.s=2,Ta(this)):ka(this,this.Y-e)};var Sa=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Aa(e){var t,r;this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Aa?(this.h=e.h,Na(this,e.j),this.s=e.s,this.g=e.g,Oa(this,e.m),this.l=e.l,t=e.i,(r=new qa).i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),Pa(this,r),this.o=e.o):e&&(t=String(e).match(Sa))?(this.h=!1,Na(this,t[1]||"",!0),this.s=Ma(t[2]||""),this.g=Ma(t[3]||"",!0),Oa(this,t[4]),this.l=Ma(t[5]||"",!0),Pa(this,t[6]||"",!0),this.o=Ma(t[7]||"")):(this.h=!1,this.i=new qa(null,this.h))}function Ra(e){return new Aa(e)}function Na(e,t,r){e.j=r?Ma(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Oa(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Pa(e,t,r){t instanceof qa?(e.i=t,function(e,t){t&&!e.j&&(Ha(e),e.i=null,e.g.forEach((function(e,t){var r=t.toLowerCase();t!=r&&(Ga(this,t),Wa(this,r,e))}),e)),e.j=t}(e.i,e.h)):(r||(t=Ua(t,za)),e.i=new qa(t,e.h))}function Da(e,t,r){e.i.set(t,r)}function La(e){return Da(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Ma(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ua(e,t,r){return"string"==typeof e?(e=encodeURI(e).replace(t,Fa),e=r?e.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):e):null}function Fa(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Aa.prototype.toString=function(){var e=[],t=this.j,r=(t&&e.push(Ua(t,ja,!0),":"),this.g);return!r&&"file"!=t||(e.push("//"),(t=this.s)&&e.push(Ua(t,ja,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null==(r=this.m))||e.push(":",String(r)),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(Ua(r,"/"==r.charAt(0)?Va:Ba,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.o)&&e.push("#",Ua(r,$a)),e.join("")};var ja=/[#\/\?@]/g,Ba=/[#\?:]/g,Va=/[#\?]/g,za=/[#\?@]/g,$a=/#/g;function qa(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Ha(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var n,s=e[r].indexOf("="),i=null;0<=s?(n=e[r].substring(0,s),i=e[r].substring(s+1)):n=e[r],t(n,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)})))}function Ga(e,t){Ha(e),t=Qa(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ka(e,t){return Ha(e),t=Qa(e,t),e.g.has(t)}function Wa(e,t,r){Ga(e,t),0<r.length&&(e.i=null,e.g.set(Qa(e,t),Ai(r)),e.h+=r.length)}function Qa(e,t){return t=String(t),e.j?t.toLowerCase():t}(fi=qa.prototype).add=function(e,t){Ha(this),this.i=null,e=Qa(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},fi.forEach=function(e,t){Ha(this),this.g.forEach((function(r,n){r.forEach((function(r){e.call(t,r,n,this)}),this)}),this)},fi.ta=function(){Ha(this);var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let s=0;s<t.length;s++){var n=e[s];for(let e=0;e<n.length;e++)r.push(t[s])}return r},fi.Z=function(e){Ha(this);let t=[];if("string"==typeof e)Ka(this,e)&&(t=t.concat(this.g.get(Qa(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},fi.set=function(e,t){return Ha(this),this.i=null,Ka(this,e=Qa(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},fi.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},fi.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),r=0;r<t.length;r++){var n=t[r],s=encodeURIComponent(String(n)),i=this.Z(n);for(n=0;n<i.length;n++){var o=s;""!==i[n]&&(o+="="+encodeURIComponent(String(i[n]))),e.push(o)}}return this.i=e.join("&")};var Ja=class{constructor(e,t){this.g=e,this.map=t}};function Ya(e){this.l=e||Xa,e=vi.PerformanceNavigationTiming?0<(e=vi.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(vi.g&&vi.g.Ka&&vi.g.Ka()&&vi.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Xa=10;function Za(e){return!!e.h||!!e.g&&e.g.size>=e.j}function el(e){return e.h?1:e.g?e.g.size:0}function tl(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function rl(e,t){e.g?e.g.add(t):e.h=t}function nl(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function sl(e){if(null!=e.h)return e.i.concat(e.h.F);if(null==e.g||0===e.g.size)return Ai(e.i);{let t=e.i;for(const r of e.g.values())t=t.concat(r.F);return t}}Ya.prototype.cancel=function(){if(this.i=sl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var il=class{stringify(e){return vi.JSON.stringify(e,void 0)}parse(e){return vi.JSON.parse(e,void 0)}};function ol(){this.g=new il}function al(e,t,r){const n=r||"";try{Ca(e,(function(e,r){let s=e;wi(e)&&(s=To(e)),t.push(n+r+"="+encodeURIComponent(s))}))}catch(e){throw t.push(n+"type="+encodeURIComponent("_badmap")),e}}function ll(e,t,r,n,s){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,s(n)}catch(e){}}function hl(e){this.l=e.ec||null,this.j=e.ob||!1}function cl(e,t){_o.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=ul,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ii(hl,na),hl.prototype.g=function(){return new cl(this.l,this.j)},hl.prototype.i=function(e){return function(){return e}}({}),Ii(cl,_o);var ul=0;function dl(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function pl(e){e.readyState=4,e.l=null,e.j=null,e.A=null,fl(e)}function fl(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(fi=cl.prototype).open=function(e,t){if(this.readyState!=ul)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,fl(this)},fi.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||vi).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},fi.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,pl(this)),this.readyState=ul},fi.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,fl(this)),this.g)&&(this.readyState=3,fl(this),this.g))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==vi.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;dl(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},fi.Xa=function(e){var t;this.g&&(this.u&&e.value?this.response.push(e.value):!this.u&&(t=e.value||new Uint8Array(0),t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t),(e.done?pl:fl)(this),3==this.readyState)&&dl(this)},fi.Za=function(e){this.g&&(this.response=this.responseText=e,pl(this))},fi.Ya=function(e){this.g&&(this.response=e,pl(this))},fi.ka=function(){this.g&&pl(this)},fi.setRequestHeader=function(e,t){this.v.append(e,t)},fi.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},fi.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(cl.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var gl=vi.JSON.parse;function ml(e){_o.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=vl,this.L=this.M=!1}Ii(ml,_o);var vl="",yl=/^https?$/i,wl=["POST","PUT"];function bl(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,_l(e),El(e)}function _l(e){e.F||(e.F=!0,ko(e,"complete"),ko(e,"error"))}function kl(e){if(e.h&&void 0!==mi&&(!e.C[1]||4!=xl(e)||2!=e.da()))if(e.v&&4==xl(e))Uo(e.La,0,e);else if(ko(e,"readystatechange"),4==xl(e)){e.h=!1;try{var t,r,n,s=e.da();switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break;default:i=!1}if((t=i)||((r=0===s)&&(!(n=String(e.I).match(Sa)[1]||null)&&vi.self&&vi.self.location&&(n=vi.self.location.protocol.slice(0,-1)),r=!yl.test(n?n.toLowerCase():"")),t=r),t)ko(e,"complete"),ko(e,"success");else{e.m=6;try{var o=2<xl(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.da()+"]",_l(e)}}finally{El(e)}}}function El(e,t){if(e.g){Tl(e);var r=e.g,n=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||ko(e,"ready");try{r.onreadystatechange=n}catch(e){}}}function Tl(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(vi.clearTimeout(e.A),e.A=null)}function xl(e){return e.g?e.g.readyState:0}function Il(e){try{if(e.g){if("response"in e.g)return e.g.response;switch(e.K){case vl:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}}return null}catch(e){return null}}function Cl(e){let t="";return to(e,(function(e,r){t=(t=t+r+":")+e+"\r\n"})),t}function Sl(e,t,r){e:{for(n in r){var n=!1;break e}n=!0}n||(r=Cl(r),"string"==typeof e?null!=r&&encodeURIComponent(String(r)):Da(e,t,r))}function Al(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function Rl(e){this.Ga=0,this.j=[],this.l=new qo,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Al("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Al("baseRetryDelayMs",5e3,e),this.hb=Al("retryDelaySeedMs",1e4,e),this.eb=Al("forwardChannelMaxRetries",2,e),this.xa=Al("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Ya(e&&e.concurrentRequestLimit),this.Ja=new ol,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Nl(e){if(Pl(e),3==e.H){var t=e.W++,r=Ra(e.I);if(Da(r,"SID",e.K),Da(r,"RID",t),Da(r,"TYPE","terminate"),Ml(e,r),(t=new ca(e,e.l,t)).L=2,t.A=La(Ra(r)),r=!1,vi.navigator&&vi.navigator.sendBeacon)try{r=vi.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!r&&vi.Image&&((new Image).src=t.A,r=!0),r||(t.g=Wl(t.l,null),t.g.ha(t.A)),t.G=Date.now(),_a(t)}Gl(e)}function Ol(e){e.g&&(Bl(e),e.g.cancel(),e.g=null)}function Pl(e){Ol(e),e.u&&(vi.clearTimeout(e.u),e.u=null),zl(e),e.i.cancel(),e.m&&("number"==typeof e.m&&vi.clearTimeout(e.m),e.m=null)}function Dl(e){var t;Za(e.i)||e.m||(e.m=!0,t=e.Na,Ro||Po(),No||(Ro(),No=!0),Oo.add(t,e),e.C=0)}function Ll(e,t){var r=t?t.m:e.W++,n=Ra(e.I);Da(n,"SID",e.K),Da(n,"RID",r),Da(n,"AID",e.V),Ml(e,n),e.o&&e.s&&Sl(n,e.o,e.s),r=new ca(e,e.l,r,e.C+1),null===e.o&&(r.I=e.s),t&&(e.j=t.F.concat(e.j)),t=Ul(e,r,1e3),r.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),rl(e.i,r),ma(r,n,t)}function Ml(e,t){e.na&&to(e.na,(function(e,r){Da(t,r,e)})),e.h&&Ca({},(function(e,r){Da(t,r,e)}))}function Ul(e,t,r){r=Math.min(e.j.length,r);var n=e.h?Ti(e.h.Va,e.h,e):null;e:{var s=e.j;let t=-1;for(;;){var i=["count="+r];-1==t?0<r?(t=s[0].g,i.push("ofs="+t)):t=0:i.push("ofs="+t);let l=!0;for(let h=0;h<r;h++){var o=s[h].g,a=s[h].map;if((o-=t)<0)t=Math.max(0,s[h].g-100),l=!1;else try{al(a,i,"req"+o+"_")}catch(e){n&&n(a)}}if(l){n=i.join("&");break e}}}return e=e.j.splice(0,r),t.F=e,n}function Fl(e){var t;e.g||e.u||(e.ba=1,t=e.Ma,Ro||Po(),No||(Ro(),No=!0),Oo.add(t,e),e.A=0)}function jl(e){return!(e.g||e.u||3<=e.A||(e.ba++,e.u=ea(Ti(e.Ma,e),ql(e,e.A)),e.A++,0))}function Bl(e){null!=e.B&&(vi.clearTimeout(e.B),e.B=null)}function Vl(e){e.g=new ca(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ra(e.wa),r=(Da(t,"RID","rpc"),Da(t,"SID",e.K),Da(t,"AID",e.V),Da(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Da(t,"TO",e.qa),Da(t,"TYPE","xmlhttp"),Ml(e,t),e.o&&e.s&&Sl(t,e.o,e.s),e.L&&e.g.setTimeout(e.L),e.g);e=e.pa,r.L=1,r.A=La(Ra(t)),r.u=null,r.S=!0,va(r,e)}function zl(e){null!=e.v&&(vi.clearTimeout(e.v),e.v=null)}function $l(e,t){var r,n=null;if(e.g==t){zl(e),Bl(e),e.g=null;var s=2}else{if(!tl(e.i,t))return;n=t.F,nl(e.i,t),s=1}if(0!=e.H)if(t.i)(1==s?(n=t.u?t.u.length:0,t=Date.now()-t.G,r=e.C,ko(s=Wo(),new Zo(s,n)),Dl):Fl)(e);else if(3==(r=t.s)||0==r&&0<t.ca||!(1==s&&function(e,t){if(el(e.i)>=e.i.j-(e.m?1:0))return!1;if(e.m)e.j=t.F.concat(e.j);else{if(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))return!1;e.m=ea(Ti(e.Na,e,t),ql(e,e.C)),e.C++}return!0}(e,t)||2==s&&jl(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),r){case 1:Hl(e,5);break;case 4:Hl(e,10);break;case 3:Hl(e,6);break;default:Hl(e,2)}}function ql(e,t){let r=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(r*=2),r*t}function Hl(e,t){var r,n;e.l.info("Error code "+t),2==t?(r=null,e.h&&(r=null),n=Ti(e.pb,e),r||(r=new Aa("//www.google.com/images/cleardot.gif"),vi.location&&"http"==vi.location.protocol||Na(r,"https"),La(r)),function(e,t){var r=new qo;if(vi.Image){const n=new Image;n.onload=xi(ll,r,n,"TestLoadImage: loaded",!0,t),n.onerror=xi(ll,r,n,"TestLoadImage: error",!1,t),n.onabort=xi(ll,r,n,"TestLoadImage: abort",!1,t),n.ontimeout=xi(ll,r,n,"TestLoadImage: timeout",!1,t),vi.setTimeout((function(){n.ontimeout&&n.ontimeout()}),1e4),n.src=e}else t(!1)}(r.toString(),n)):Xo(2),e.H=0,e.h&&e.h.za(t),Gl(e),Pl(e)}function Gl(e){var t;e.H=0,e.ma=[],e.h&&(0==(t=sl(e.i)).length&&0==e.j.length||(Ri(e.ma,t),Ri(e.ma,e.j),e.i.i.length=0,Ai(e.j),e.j.length=0),e.h.ya())}function Kl(e,t,r){var n,s,i=r instanceof Aa?Ra(r):new Aa(r);return""!=i.g?(t&&(i.g=t+"."+i.g),Oa(i,i.m)):(i=(n=vi.location).protocol,t=t?t+"."+n.hostname:n.hostname,n=+n.port,s=new Aa(null),i&&Na(s,i),t&&(s.g=t),n&&Oa(s,n),r&&(s.l=r),i=s),r=e.F,t=e.Da,r&&t&&Da(i,r,t),Da(i,"VER",e.ra),Ml(e,i),i}function Wl(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ha&&!e.va?new ml(new hl({ob:r})):new ml(e.va)).Oa(e.J),t}function Ql(){}function Jl(){if(ji&&!(10<=Number(Wi)))throw Error("Environmental error: no available transport.")}function Yl(e,t){_o.call(this),this.g=new Rl(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!Pi(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Pi(t)&&(this.g.F=t,null!==(e=this.h))&&t in e&&t in(e=this.h)&&delete e[t],this.j=new eh(this)}function Xl(e){aa.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Zl(){la.call(this),this.status=1}function eh(e){this.g=e}function th(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function rh(e,t,r){r=r||0;var n=Array(16);if("string"==typeof t)for(var s=0;s<16;++s)n[s]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(s=0;s<16;++s)n[s]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1];s=e.g[2];var i=e.g[3],o=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=(r=(s=(i=(t=r+((o=t+(i^r&(s^i))+n[0]+3614090360&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(r^s))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=s+(r^i&(t^r))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=r+(t^s&(i^t))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^r&(s^i))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(r^s))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=s+(r^i&(t^r))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=r+(t^s&(i^t))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^r&(s^i))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(r^s))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=s+(r^i&(t^r))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=r+(t^s&(i^t))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^r&(s^i))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=i+(s^t&(r^s))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=s+(r^i&(t^r))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=r+(t^s&(i^t))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^i&(r^s))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=i+(r^s&(t^r))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^r&(i^t))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=r+(i^t&(s^i))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^i&(r^s))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=i+(r^s&(t^r))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^r&(i^t))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=r+(i^t&(s^i))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^i&(r^s))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=i+(r^s&(t^r))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^r&(i^t))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=r+(i^t&(s^i))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(s^i&(r^s))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=i+(r^s&(t^r))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=s+(t^r&(i^t))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=r+(i^t&(s^i))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(r^s^i)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^r^s)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^r)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=r+(s^i^t)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^s^i)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^r^s)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^r)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=r+(s^i^t)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^s^i)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^r^s)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^r)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=r+(s^i^t)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(r^s^i)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=i+(t^r^s)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=s+(i^t^r)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=r+(s^i^t)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(s^(r|~i))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=i+(r^(t|~s))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(i|~r))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=r+(i^(s|~t))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(s^(r|~i))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=i+(r^(t|~s))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(i|~r))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=r+(i^(s|~t))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(s^(r|~i))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=i+(r^(t|~s))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=s+(t^(i|~r))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=r+(i^(s|~t))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((i=(t=r+((o=t+(s^(r|~i))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=i+(r^(t|~s))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((s=i+((o=s+(t^(i|~r))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+n[9]+3951481745&4294967295;e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}function nh(e,t){this.h=t;for(var r=[],n=!0,s=e.length-1;0<=s;s--){var i=0|e[s];n&&i==t||(r[s]=i,n=!1)}this.g=r}(fi=ml.prototype).Oa=function(e){this.M=e},fi.ha=function(e,t,r,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=(this.u||da).g(),this.C=this.u?sa(this.u):sa(da),this.g.onreadystatechange=Ti(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void bl(this,e)}if(e=r||"",r=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var s in n)r.set(s,n[s]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const e of n.keys())r.set(e,n.get(e))}for(var[i,o]of(n=Array.from(r.keys()).find((e=>"content-type"==e.toLowerCase())),s=vi.FormData&&e instanceof vi.FormData,0<=Si(wl,t)&&!n&&!s&&r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r))this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Tl(this),0<this.B&&((this.L=function(e){return ji&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ti(this.ua,this)):this.A=Uo(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){bl(this,e)}},fi.ua=function(){void 0!==mi&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ko(this,"timeout"),this.abort(8))},fi.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ko(this,"complete"),ko(this,"abort"),El(this))},fi.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),El(this,!0)),ml.$.N.call(this)},fi.La=function(){this.s||(this.G||this.v||this.l?kl(this):this.kb())},fi.kb=function(){kl(this)},fi.isActive=function(){return!!this.g},fi.da=function(){try{return 2<xl(this)?this.g.status:-1}catch(e){return-1}},fi.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},fi.Wa=function(e){var t;if(this.g)return t=this.g.responseText,e&&0==t.indexOf(e)&&(t=t.substring(e.length)),gl(t)},fi.Ia=function(){return this.m},fi.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(fi=Rl.prototype).ra=8,fi.H=1,fi.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;var t=new ca(this,this.l,e);let i=this.s;if(this.U&&(i?so(i=ro(i),this.U):i=this.U),null!==this.o||this.O||(t.I=i,i=null),this.P)e:{for(var r=0,n=0;n<this.j.length;n++){var s=this.j[n];if(void 0===(s="__data__"in s.map&&"string"==typeof(s=s.map.__data__)?s.length:void 0))break;if(4096<(r+=s)){r=n;break e}if(4096===r||n===this.j.length-1){r=n+1;break e}}r=1e3}else r=1e3;r=Ul(this,t,r),Da(n=Ra(this.I),"RID",e),Da(n,"CVER",22),this.F&&Da(n,"X-HTTP-Session-Id",this.F),Ml(this,n),i&&(this.O?r="headers="+encodeURIComponent(String(Cl(i)))+"&"+r:this.o&&Sl(n,this.o,i)),rl(this.i,t),this.bb&&Da(n,"TYPE","init"),this.P?(Da(n,"$req",r),Da(n,"SID","null"),t.aa=!0,ma(t,n,null)):ma(t,n,r),this.H=2}}else 3==this.H&&(e?Ll(this,e):0==this.j.length||Za(this.i)||Ll(this))},fi.Ma=function(){var e;this.u=null,Vl(this),this.ca&&!(this.M||null==this.g||this.S<=0)&&(e=2*this.S,this.l.info("BP detection timer enabled: "+e),this.B=ea(Ti(this.jb,this),e))},fi.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Xo(10),Ol(this),Vl(this))},fi.ib=function(){null!=this.v&&(this.v=null,Ol(this),jl(this),Xo(19))},fi.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Xo(2)):(this.l.info("Failed to ping google.com"),Xo(1))},fi.isActive=function(){return!!this.h&&this.h.isActive(this)},(fi=Ql.prototype).Ba=function(){},fi.Aa=function(){},fi.za=function(){},fi.ya=function(){},fi.isActive=function(){return!0},fi.Va=function(){},Jl.prototype.g=function(e,t){return new Yl(e,t)},Ii(Yl,_o),Yl.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,r=this.h||void 0;Xo(0),e.Y=t,e.na=r||{},e.G=e.aa,e.I=Kl(e,null,e.Y),Dl(e)},Yl.prototype.close=function(){Nl(this.g)},Yl.prototype.u=function(e){var t,r=this.g;"string"==typeof e?((t={}).__data__=e,e=t):this.v&&((t={}).__data__=To(e),e=t),r.j.push(new Ja(r.fb++,e)),3==r.H&&Dl(r)},Yl.prototype.N=function(){this.g.h=null,delete this.j,Nl(this.g),delete this.g,Yl.$.N.call(this)},Ii(Xl,aa),Ii(Zl,la),Ii(eh,Ql),eh.prototype.Ba=function(){ko(this.g,"a")},eh.prototype.Aa=function(e){ko(this.g,new Xl(e))},eh.prototype.za=function(e){ko(this.g,new Zl)},eh.prototype.ya=function(){ko(this.g,"b")},Ii(th,(function(){this.blockSize=-1})),th.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},th.prototype.j=function(e,t){for(var r=(t=void 0===t?e.length:t)-this.blockSize,n=this.m,s=this.h,i=0;i<t;){if(0==s)for(;i<=r;)rh(this,e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(n[s++]=e.charCodeAt(i++),s==this.blockSize){rh(this,n),s=0;break}}else for(;i<t;)if(n[s++]=e[i++],s==this.blockSize){rh(this,n),s=0;break}}this.h=s,this.i+=t},th.prototype.l=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.j(e),e=Array(16),t=r=0;t<4;++t)for(var n=0;n<32;n+=8)e[r++]=this.g[t]>>>n&255;return e};var sh={};function ih(e){return-128<=e&&e<128?function(e,t){var r=sh;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}(e,(function(e){return new nh([0|e],e<0?-1:0)})):new nh([0|e],e<0?-1:0)}function oh(e){if(isNaN(e)||!isFinite(e))return lh;if(e<0)return ph(oh(-e));for(var t=[],r=1,n=0;r<=e;n++)t[n]=e/r|0,r*=ah;return new nh(t,0)}var ah=4294967296,lh=ih(0),hh=ih(1),ch=ih(16777216);function uh(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function dh(e){return-1==e.h}function ph(e){for(var t=e.g.length,r=[],n=0;n<t;n++)r[n]=~e.g[n];return new nh(r,~e.h).add(hh)}function fh(e,t){return e.add(ph(t))}function gh(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function mh(e,t){this.g=e,this.h=t}function vh(e,t){if(uh(t))throw Error("division by zero");if(uh(e))return new mh(lh,lh);if(dh(e))return t=vh(ph(e),t),new mh(ph(t.g),ph(t.h));if(dh(t))return t=vh(e,ph(t)),new mh(ph(t.g),t.h);if(30<e.g.length){if(dh(e)||dh(t))throw Error("slowDivide_ only works with positive integers.");for(var r=hh,n=t;n.X(e)<=0;)r=yh(r),n=yh(n);var s=wh(r,1),i=wh(n,1);for(n=wh(n,2),r=wh(r,2);!uh(n);){var o=i.add(n);o.X(e)<=0&&(s=s.add(r),i=o),n=wh(n,1),r=wh(r,1)}return t=fh(e,s.R(t)),new mh(s,t)}for(s=lh;0<=e.X(t);){for(r=Math.max(1,Math.floor(e.ea()/t.ea())),n=(n=Math.ceil(Math.log(r)/Math.LN2))<=48?1:Math.pow(2,n-48),o=(i=oh(r)).R(t);dh(o)||0<o.X(e);)o=(i=oh(r-=n)).R(t);uh(i)&&(i=hh),s=s.add(i),e=fh(e,o)}return new mh(s,e)}function yh(e){for(var t=e.g.length+1,r=[],n=0;n<t;n++)r[n]=e.D(n)<<1|e.D(n-1)>>>31;return new nh(r,e.h)}function wh(e,t){var r=t>>5;t%=32;for(var n=e.g.length-r,s=[],i=0;i<n;i++)s[i]=0<t?e.D(i+r)>>>t|e.D(i+r+1)<<32-t:e.D(i+r);return new nh(s,e.h)}(fi=nh.prototype).ea=function(){if(dh(this))return-ph(this).ea();for(var e=0,t=1,r=0;r<this.g.length;r++){var n=this.D(r);e+=(0<=n?n:ah+n)*t,t*=ah}return e},fi.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(uh(this))return"0";if(dh(this))return"-"+ph(this).toString(e);for(var t=oh(Math.pow(e,6)),r=this,n="";;){var s=vh(r,t).g,i=((0<(r=fh(r,s.R(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(uh(r=s))return i+n;for(;i.length<6;)i="0"+i;n=i+n}},fi.D=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},fi.X=function(e){return dh(e=fh(this,e))?-1:uh(e)?0:1},fi.abs=function(){return dh(this)?ph(this):this},fi.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0,s=0;s<=t;s++){var i=n+(65535&this.D(s))+(65535&e.D(s)),o=(i>>>16)+(this.D(s)>>>16)+(e.D(s)>>>16);n=o>>>16;r[s]=(o&=65535)<<16|(i&=65535)}return new nh(r,-2147483648&r[r.length-1]?-1:0)},fi.R=function(e){if(uh(this)||uh(e))return lh;if(dh(this))return dh(e)?ph(this).R(ph(e)):ph(ph(this).R(e));if(dh(e))return ph(this.R(ph(e)));if(this.X(ch)<0&&e.X(ch)<0)return oh(this.ea()*e.ea());for(var t=this.g.length+e.g.length,r=[],n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(var s=0;s<e.g.length;s++){var i=this.D(n)>>>16,o=65535&this.D(n),a=e.D(s)>>>16,l=65535&e.D(s);r[2*n+2*s]+=o*l,gh(r,2*n+2*s),r[2*n+2*s+1]+=i*l,gh(r,2*n+2*s+1),r[2*n+2*s+1]+=o*a,gh(r,2*n+2*s+1),r[2*n+2*s+2]+=i*a,gh(r,2*n+2*s+2)}for(n=0;n<t;n++)r[n]=r[2*n+1]<<16|r[2*n];for(n=t;n<2*t;n++)r[n]=0;return new nh(r,0)},fi.gb=function(e){return vh(this,e).h},fi.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)&e.D(n);return new nh(r,this.h&e.h)},fi.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)|e.D(n);return new nh(r,this.h|e.h)},fi.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],n=0;n<t;n++)r[n]=this.D(n)^e.D(n);return new nh(r,this.h^e.h)},Jl.prototype.createWebChannel=Jl.prototype.g,Yl.prototype.send=Yl.prototype.u,Yl.prototype.open=Yl.prototype.m,Yl.prototype.close=Yl.prototype.close,ta.NO_ERROR=0,ta.TIMEOUT=8,ta.HTTP_ERROR=6,ra.COMPLETE="complete",(ia.EventType=oa).OPEN="a",oa.CLOSE="b",oa.ERROR="c",oa.MESSAGE="d",_o.prototype.listen=_o.prototype.O,ml.prototype.listenOnce=ml.prototype.P,ml.prototype.getLastError=ml.prototype.Sa,ml.prototype.getLastErrorCode=ml.prototype.Ia,ml.prototype.getStatus=ml.prototype.da,ml.prototype.getResponseJson=ml.prototype.Wa,ml.prototype.getResponseText=ml.prototype.ja,ml.prototype.send=ml.prototype.ha,ml.prototype.setWithCredentials=ml.prototype.Oa,th.prototype.digest=th.prototype.l,th.prototype.reset=th.prototype.reset,th.prototype.update=th.prototype.j,nh.prototype.add=nh.prototype.add,nh.prototype.multiply=nh.prototype.R,nh.prototype.modulo=nh.prototype.gb,nh.prototype.compare=nh.prototype.X,nh.prototype.toNumber=nh.prototype.ea,nh.prototype.toString=nh.prototype.toString,nh.prototype.getBits=nh.prototype.D,nh.fromNumber=oh,nh.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return ph(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=oh(Math.pow(r,8)),s=lh,i=0;i<t.length;i+=8){var o=Math.min(8,t.length-i),a=parseInt(t.substring(i,i+o),r);s=(o<8?(o=oh(Math.pow(r,o)),s.R(o)):s=s.R(n)).add(oh(a))}return s};var bh,_h,kh,Eh,Th=ta,xh=ra,Ih=Go,Ch=10,Sh=11,Ah=ia,Rh=ml,Nh=th,Oh=nh;const Ph="@firebase/firestore";class Dh{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dh.UNAUTHENTICATED=new Dh(null),Dh.GOOGLE_CREDENTIALS=new Dh("google-credentials-uid"),Dh.FIRST_PARTY=new Dh("first-party-uid"),Dh.MOCK_USER=new Dh("mock-user");let Lh="10.11.0";const Mh=new bs("@firebase/firestore");function Uh(){return Mh.logLevel}function Fh(e,...t){Mh.logLevel<=vn.DEBUG&&(t=t.map(Vh),Mh.debug(`Firestore (${Lh}): `+e,...t))}function jh(e,...t){Mh.logLevel<=vn.ERROR&&(t=t.map(Vh),Mh.error(`Firestore (${Lh}): `+e,...t))}function Bh(e,...t){Mh.logLevel<=vn.WARN&&(t=t.map(Vh),Mh.warn(`Firestore (${Lh}): `+e,...t))}function Vh(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function zh(e="Unexpected state"){throw jh(e=`FIRESTORE (${Lh}) INTERNAL ASSERTION FAILED: `+e),new Error(e)}function $h(e,t){e||zh()}function qh(e,t){return e}const Hh={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Gh extends rs{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: `+this.message}}class Kh{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Wh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer "+e)}}class Qh{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Dh.UNAUTHENTICATED)))}shutdown(){}}class Jh{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Yh{constructor(e){this.t=e,this.currentUser=Dh.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const n=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let s=new Kh;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Kh,e.enqueueRetryable((()=>n(this.currentUser)))};const i=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await n(this.currentUser)}))},o=e=>{Fh("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit((e=>o(e))),setTimeout((()=>{var e;this.auth||((e=this.t.getImmediate({optional:!0}))?o(e):(Fh("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Kh))}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Fh("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?($h("string"==typeof t.accessToken),new Wh(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){var e=this.auth&&this.auth.getUid();return $h(null===e||"string"==typeof e),new Dh(e)}}class Xh{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Dh.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);var e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Zh{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Xh(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Dh.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ec{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&0<e.length&&this.headers.set("x-firebase-appcheck",this.value)}}class tc{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=e=>{null!=e.error&&Fh("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: "+e.error.message);var r=e.token!==this.R;return this.R=e.token,Fh("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()},n=(this.o=t=>{e.enqueueRetryable((()=>r(t)))},e=>{Fh("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)});this.A.onInit((e=>n(e))),setTimeout((()=>{var e;this.appCheck||((e=this.A.getImmediate({optional:!0}))?n(e):Fh("FirebaseAppCheckTokenProvider","AppCheck not yet detected"))}),0)}getToken(){var e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?($h("string"==typeof e.token),this.R=e.token,new ec(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function rc(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let t=0;t<e;t++)r[t]=Math.floor(256*Math.random());return r}class nc{static newId(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let r="";for(;r.length<20;){var n=rc(40);for(let s=0;s<n.length;++s)r.length<20&&n[s]<t&&(r+=e.charAt(n[s]%62))}return r}}function sc(e,t){return e<t?-1:t<e?1:0}function ic(e,t,r){return e.length===t.length&&e.every(((e,n)=>r(e,t[n])))}class oc{constructor(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new Gh(Hh.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new Gh(Hh.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Gh(Hh.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new Gh(Hh.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return oc.fromMillis(Date.now())}static fromDate(e){return oc.fromMillis(e.getTime())}static fromMillis(e){var t=Math.floor(e/1e3);e=Math.floor(1e6*(e-1e3*t));return new oc(t,e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?sc(this.nanoseconds,e.nanoseconds):sc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ac{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ac(e)}static min(){return new ac(new oc(0,0))}static max(){return new ac(new oc(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class lc{constructor(e,t,r){void 0===t?t=0:t>e.length&&zh(),void 0===r?r=e.length-t:r>e.length-t&&zh(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===lc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof lc?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++){const r=e.get(n),s=t.get(n);if(r<s)return-1;if(r>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class hc extends lc{construct(e,t,r){return new hc(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){var t=[];for(const r of e){if(0<=r.indexOf("//"))throw new Gh(Hh.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((e=>0<e.length)))}return new hc(t)}static emptyPath(){return new hc([])}}const cc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class uc extends lc{construct(e,t,r){return new uc(e,t,r)}static isValidIdentifier(e){return cc.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),uc.isValidIdentifier(e)?e:"`"+e+"`"))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new uc(["__name__"])}static fromServerFormat(e){const t=[];let r="",n=0;var s=()=>{if(0===r.length)throw new Gh(Hh.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let i=!1;for(;n<e.length;){const t=e[n];if("\\"===t){if(n+1===e.length)throw new Gh(Hh.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[n+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Gh(Hh.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,n+=2}else"`"===t?i=!i:"."!==t||i?r+=t:s(),n++}if(s(),i)throw new Gh(Hh.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new uc(t)}static emptyPath(){return new uc([])}}class dc{constructor(e){this.path=e}static fromPath(e){return new dc(hc.fromString(e))}static fromName(e){return new dc(hc.fromString(e).popFirst(5))}static empty(){return new dc(hc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return 2<=this.path.length&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===hc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return hc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dc(new hc(e.slice()))}}function pc(e){return new fc(e.readTime,e.key,-1)}class fc{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new fc(ac.min(),dc.empty(),-1)}static max(){return new fc(ac.max(),dc.empty(),-1)}}function gc(e,t){var r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=dc.comparator(e.documentKey,t.documentKey))?r:sc(e.largestBatchId,t.largestBatchId)}const mc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function yc(e){if(e.code!==Hh.FAILED_PRECONDITION||e.message!==mc)throw e;Fh("LocalStore","Unexpectedly lost primary lease")}class wc{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&zh(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new wc(((r,n)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,n)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,n)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{var t=e();return t instanceof wc?t:wc.resolve(t)}catch(e){return wc.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):wc.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):wc.reject(t)}static resolve(e){return new wc(((t,r)=>{t(e)}))}static reject(e){return new wc(((t,r)=>{r(e)}))}static waitFor(e){return new wc(((t,r)=>{let n=0,s=0,i=!1;e.forEach((e=>{++n,e.next((()=>{++s,i&&s===n&&t()}),(e=>r(e)))})),i=!0,s===n&&t()}))}static or(e){let t=wc.resolve(!1);for(const r of e)t=t.next((e=>e?wc.resolve(e):r()));return t}static forEach(e,t){const r=[];return e.forEach(((e,n)=>{r.push(t.call(this,e,n))})),this.waitFor(r)}static mapArray(e,t){return new wc(((r,n)=>{const s=e.length,i=new Array(s);let o=0;for(let a=0;a<s;a++){const l=a;t(e[l]).next((e=>{i[l]=e,++o===s&&r(i)}),(e=>n(e)))}}))}static doWhile(e,t){return new wc(((r,n)=>{const s=()=>{!0===e()?t().next((()=>{s()}),n):r()};s()}))}}class bc{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Kh,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ec(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{t=Sc(t.target.error),this.V.reject(new Ec(e,t))}}static open(e,t,r,n){try{return new bc(t,e.transaction(n,r))}catch(e){throw new Ec(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Fh("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){return e=this.transaction.objectStore(e),new xc(e)}}class _c{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===_c.S(Zn())&&jh("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Fh("SimpleDb","Removing database:",e),Ic(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){var e,t,r;return!(!ts()||!_c.C()&&(e=Zn(),t=0<(t=_c.S(e))&&t<10,r=0<(r=_c.v(e))&&r<4.5,0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/")||t||r))}static C(){var e;return"undefined"!=typeof process&&"YES"===(null==(e=process.__PRIVATE_env)?void 0:e.F)}static M(e,t){return e.store(t)}static S(e){return e=(e=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?e[1].split("_").slice(0,2).join("."):"-1",Number(e)}static v(e){return e=(e=e.match(/Android ([\d.]+)/i))?e[1].split(".").slice(0,2).join("."):"-1",Number(e)}async O(e){return this.db||(Fh("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,r)=>{const n=indexedDB.open(this.name,this.version);n.onsuccess=e=>{e=e.target.result,t(e)},n.onblocked=()=>{r(new Ec(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},n.onerror=t=>{"VersionError"===(t=t.target.error).name?r(new Gh(Hh.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===t.name?r(new Gh(Hh.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+t)):r(new Ec(e,t))},n.onupgradeneeded=e=>{Fh("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;this.p.N(t,n.transaction,e.oldVersion,this.version).next((()=>{Fh("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}B(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,n){var s="readonly"===t;let i=0;for(;;){++i;try{this.db=await this.O(e);const t=bc.open(this.db,e,s?"readonly":"readwrite",r),i=n(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),wc.reject(e)))).toPromise();return i.catch((()=>{})),await t.m,i}catch(e){const t=e,r="FirebaseError"!==t.name&&i<3;if(Fh("SimpleDb","Transaction failed with error:",t.message,"Retrying:",r),this.close(),!r)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class kc{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ic(this.k.delete())}}class Ec extends Gh{constructor(e,t){super(Hh.UNAVAILABLE,`IndexedDB transaction '${e}' failed: `+t),this.name="IndexedDbTransactionError"}}function Tc(e){return"IndexedDbTransactionError"===e.name}class xc{constructor(e){this.store=e}put(e,t){let r;return Ic(r=void 0!==t?(Fh("SimpleDb","PUT",this.store.name,e,t),this.store.put(t,e)):(Fh("SimpleDb","PUT",this.store.name,"<auto-key>",e),this.store.put(e)))}add(e){return Fh("SimpleDb","ADD",this.store.name,e,e),Ic(this.store.add(e))}get(e){return Ic(this.store.get(e)).next((t=>(Fh("SimpleDb","GET",this.store.name,e,t=void 0===t?null:t),t)))}delete(e){return Fh("SimpleDb","DELETE",this.store.name,e),Ic(this.store.delete(e))}count(){return Fh("SimpleDb","COUNT",this.store.name),Ic(this.store.count())}W(e,t){var r=this.options(e,t);if("function"==typeof(t=r.index?this.store.index(r.index):this.store).getAll){const e=t.getAll(r.range);return new wc(((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(r),t=[];return this.G(e,((e,r)=>{t.push(r)})).next((()=>t))}}j(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new wc(((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}}))}H(e,t){return Fh("SimpleDb","DELETE ALL",this.store.name),(e=this.options(e,t)).J=!1,t=this.cursor(e),this.G(t,((e,t,r)=>r.delete()))}Y(e,t){let r;return t?r=e:(r={},t=e),e=this.cursor(r),this.G(e,t)}Z(e){const t=this.cursor({});return new wc(((r,n)=>{t.onerror=e=>{e=Sc(e.target.error),n(e)},t.onsuccess=t=>{const n=t.target.result;n?e(n.primaryKey,n.value).next((e=>{e?n.continue():r()})):r()}}))}G(e,t){const r=[];return new wc(((n,s)=>{e.onerror=e=>{s(e.target.error)},e.onsuccess=e=>{if(e=e.target.result){const s=new kc(e),i=t(e.primaryKey,e.value,s);if(i instanceof wc){const e=i.catch((e=>(s.done(),wc.reject(e))));r.push(e)}s.isDone?n():null===s.$?e.continue():e.continue(s.$)}else n()}})).next((()=>wc.waitFor(r)))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";var r;return e.reverse&&(t="prev"),e.index?(r=this.store.index(e.index),e.J?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)):this.store.openCursor(e.range,t)}}function Ic(e){return new wc(((t,r)=>{e.onsuccess=e=>{e=e.target.result,t(e)},e.onerror=e=>{e=Sc(e.target.error),r(e)}}))}let Cc=!1;function Sc(e){const t=_c.S(Zn());if(12.2<=t&&t<13){const t="An internal error was encountered in the Indexed Database server";if(0<=e.message.indexOf(t)){const e=new Gh("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Cc||(Cc=!0,setTimeout((()=>{throw e}),0)),e}}return e}class Ac{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){var e=++this.previousValue;return this.oe&&this.oe(e),e}}function Rc(e){return null==e}function Nc(e){return 0===e&&1/e==-1/0}function Oc(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function Pc(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}Ac._e=-1;class Dc{constructor(e,t){this.comparator=e,this.root=t||Mc.EMPTY}insert(e,t){return new Dc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Mc.BLACK,null,null))}remove(e){return new Dc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){var r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:0<r&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){var n=this.comparator(e,r.key);if(0===n)return t+r.left.size;r=n<0?r.left:(t+=r.left.size+1,r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(t+":"+r),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lc(this.root,e,this.comparator,!0)}}class Lc{constructor(e,t,r,n){this.isReverse=n,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&n&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();var t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return 0<this.nodeStack.length}peek(){var e;return 0===this.nodeStack.length?null:{key:(e=this.nodeStack[this.nodeStack.length-1]).key,value:e.value}}}class Mc{constructor(e,t,r,n,s){this.key=e,this.value=t,this.color=null!=r?r:Mc.RED,this.left=null!=n?n:Mc.EMPTY,this.right=null!=s?s:Mc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,n,s){return new Mc(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=n?n:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){var n=this,s=r(e,n.key);return(n=s<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===s?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return Mc.EMPTY;let e=this;return(e=(e=e.left.isRed()||e.left.left.isRed()?e:e.moveRedLeft()).copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,n=this;if(t(e,n.key)<0)n=(n=n.left.isEmpty()||n.left.isRed()||n.left.left.isRed()?n:n.moveRedLeft()).copy(null,null,null,n.left.remove(e,t),null);else{if(0===t(e,(n=(n=n.left.isRed()?n.rotateRight():n).right.isEmpty()||n.right.isRed()||n.right.left.isRed()?n:n.moveRedRight()).key)){if(n.right.isEmpty())return Mc.EMPTY;r=n.right.min(),n=n.copy(r.key,r.value,null,null,n.right.removeMin())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp()}isRed(){return this.color}fixUp(){let e=this;return(e=(e=e.right.isRed()&&!e.left.isRed()?e.rotateLeft():e).left.isRed()&&e.left.left.isRed()?e.rotateRight():e).left.isRed()&&e.right.isRed()?e.colorFlip():e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()?(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip():e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()?(e=e.rotateRight()).colorFlip():e}rotateLeft(){var e=this.copy(null,null,Mc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){var e=this.copy(null,null,Mc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){var e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw zh();if(this.right.isRed())throw zh();var e=this.left.check();if(e!==this.right.check())throw zh();return e+(this.isRed()?0:1)}}Mc.EMPTY=null,Mc.RED=!0,Mc.BLACK=!1,Mc.EMPTY=new class{constructor(){this.size=0}get key(){throw zh()}get value(){throw zh()}get color(){throw zh()}get left(){throw zh()}get right(){throw zh()}copy(e,t,r,n,s){return this}insert(e,t,r){return new Mc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Uc{constructor(e){this.comparator=e,this.data=new Dc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){for(var r=this.data.getIteratorFrom(e[0]);r.hasNext();){var n=r.getNext();if(0<=this.comparator(n.key,e[1]))return;t(n.key)}}forEachWhile(e,t){for(var r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){return(e=this.data.getIteratorFrom(e)).hasNext()?e.getNext().key:null}getIterator(){return new Fc(this.data.getIterator())}getIteratorFrom(e){return new Fc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Uc))return!1;if(this.size!==e.size)return!1;for(var t=this.data.getIterator(),r=e.data.getIterator();t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(0!==this.comparator(e,n))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){var t=new Uc(this.comparator);return t.data=e,t}}class Fc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class jc{constructor(e){(this.fields=e).sort(uc.comparator)}static empty(){return new jc([])}unionWith(e){let t=new Uc(uc.comparator);for(const e of this.fields)t=t.add(e);for(const r of e)t=t.add(r);return new jc(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ic(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Bc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Vc{constructor(e){this.binaryString=e}static fromBase64String(e){return e=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Bc("Invalid base64 string: "+e):e}}(e),new Vc(e)}static fromUint8Array(e){return e=function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e),new Vc(e)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){var e=this.binaryString,t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return sc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vc.EMPTY_BYTE_STRING=new Vc("");const zc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $c(e){if($h(!!e),"string"!=typeof e)return{seconds:qc(e.seconds),nanos:qc(e.nanos)};{let r=0;var t=($h(!!(t=zc.exec(e))),t[1]&&(t=((t=t[1])+"000000000").substr(0,9),r=Number(t)),new Date(e));return{seconds:Math.floor(t.getTime()/1e3),nanos:r}}}function qc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Hc(e){return"string"==typeof e?Vc.fromBase64String(e):Vc.fromUint8Array(e)}function Gc(e){return"server_timestamp"===(null==(e=((null==(e=null==e?void 0:e.mapValue)?void 0:e.fields)||{}).__type__)?void 0:e.stringValue)}function Kc(e){return Gc(e=e.mapValue.fields.__previous_value__)?Kc(e):e}function Wc(e){return e=$c(e.mapValue.fields.__local_write_time__.timestampValue),new oc(e.seconds,e.nanos)}class Qc{constructor(e,t,r,n,s,i,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=n,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class Jc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Jc("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Jc&&e.projectId===this.projectId&&e.database===this.database}}const Yc={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Xc(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Gc(e)?4:function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}(e)?9007199254740991:10:zh()}function Zc(e,t){if(e===t)return!0;var r,n,s,i=Xc(e);if(i!==Xc(t))return!1;switch(i){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Wc(e).isEqual(Wc(t));case 3:return s=t,"string"==typeof(n=e).timestampValue&&"string"==typeof s.timestampValue&&n.timestampValue.length===s.timestampValue.length?n.timestampValue===s.timestampValue:(n=$c(n.timestampValue),s=$c(s.timestampValue),n.seconds===s.seconds&&n.nanos===s.nanos);case 5:return e.stringValue===t.stringValue;case 6:return n=t,Hc(e.bytesValue).isEqual(Hc(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return s=t,qc((r=e).geoPointValue.latitude)===qc(s.geoPointValue.latitude)&&qc(r.geoPointValue.longitude)===qc(s.geoPointValue.longitude);case 2:return r=t,"integerValue"in(o=e)&&"integerValue"in r?qc(o.integerValue)===qc(r.integerValue):"doubleValue"in o&&"doubleValue"in r&&((o=qc(o.doubleValue))===(r=qc(r.doubleValue))?Nc(o)===Nc(r):isNaN(o)&&isNaN(r));case 9:return ic(e.arrayValue.values||[],t.arrayValue.values||[],Zc);case 10:var o=t,a=e.mapValue.fields||{},l=o.mapValue.fields||{};if(Oc(a)!==Oc(l))return!1;for(const e in a)if(a.hasOwnProperty(e)&&(void 0===l[e]||!Zc(a[e],l[e])))return!1;return!0;default:return zh()}}function eu(e,t){return void 0!==(e.values||[]).find((e=>Zc(e,t)))}function tu(e,t){if(e===t)return 0;var r=Xc(e),n=Xc(t);if(r!==n)return sc(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return sc(e.booleanValue,t.booleanValue);case 2:var s=e,i=t;return(s=qc(s.integerValue||s.doubleValue))<(i=qc(i.integerValue||i.doubleValue))?-1:i<s?1:s===i?0:isNaN(s)?isNaN(i)?0:-1:1;case 3:return ru(e.timestampValue,t.timestampValue);case 4:return ru(Wc(e),Wc(t));case 5:return sc(e.stringValue,t.stringValue);case 6:return s=e.bytesValue,i=t.bytesValue,s=Hc(s),i=Hc(i),s.compareTo(i);case 7:var o=e.referenceValue,a=t.referenceValue,l=o.split("/"),h=a.split("/");for(let e=0;e<l.length&&e<h.length;e++){const t=sc(l[e],h[e]);if(0!==t)return t}return sc(l.length,h.length);case 8:return o=e.geoPointValue,a=t.geoPointValue,0!==(c=sc(qc(o.latitude),qc(a.latitude)))?c:sc(qc(o.longitude),qc(a.longitude));case 9:var c=e.arrayValue,u=t.arrayValue,d=c.values||[],p=u.values||[];for(let e=0;e<d.length&&e<p.length;++e){const t=tu(d[e],p[e]);if(t)return t}return sc(d.length,p.length);case 10:u=e.mapValue;var f=t.mapValue;if(u===Yc.mapValue&&f===Yc.mapValue)return 0;if(u===Yc.mapValue)return 1;if(f===Yc.mapValue)return-1;var g=u.fields||{},m=Object.keys(g),v=f.fields||{},y=Object.keys(v);m.sort(),y.sort();for(let e=0;e<m.length&&e<y.length;++e){const t=sc(m[e],y[e]);if(0!==t)return t;var w=tu(g[m[e]],v[y[e]]);if(0!==w)return w}return sc(m.length,y.length);default:throw zh()}}function ru(e,t){var r;return"string"==typeof e&&"string"==typeof t&&e.length===t.length?sc(e,t):(e=$c(e),t=$c(t),0!==(r=sc(e.seconds,t.seconds))?r:sc(e.nanos,t.nanos))}function nu(e){return su(e)}function su(e){if("nullValue"in e)return"null";if("booleanValue"in e)return""+e.booleanValue;if("integerValue"in e)return""+e.integerValue;if("doubleValue"in e)return""+e.doubleValue;var t,r;if("timestampValue"in e)return`time(${(t=$c(t=e.timestampValue)).seconds},${t.nanos})`;if("stringValue"in e)return e.stringValue;if("bytesValue"in e)return Hc(e.bytesValue).toBase64();if("referenceValue"in e)return t=e.referenceValue,dc.fromName(t).toString();if("geoPointValue"in e)return`geo(${(r=e.geoPointValue).latitude},${r.longitude})`;if("arrayValue"in e){r=e.arrayValue;let t="[",n=!0;for(const e of r.values||[])n?n=!1:t+=",",t+=su(e);return t+"]"}if("mapValue"in e){var n=e.mapValue;let t="{",r=!0;for(const e of Object.keys(n.fields||{}).sort())r?r=!1:t+=",",t+=e+":"+su(n.fields[e]);return t+"}"}return zh()}function iu(e){return!!e&&"integerValue"in e}function ou(e){return!!e&&"arrayValue"in e}function au(e){return!!e&&"nullValue"in e}function lu(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function hu(e){return!!e&&"mapValue"in e}function cu(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Pc(e.mapValue.fields,((e,r)=>t.mapValue.fields[e]=cu(r))),t}if(e.arrayValue){var t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=cu(e.arrayValue.values[r]);return t}return Object.assign({},e)}class uu{constructor(e){this.value=e}static empty(){return new uu({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!hu(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cu(t)}setAll(e){let t=uc.emptyPath(),r={},n=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,r,n),r={},n=[],t=s.popLast()}e?r[s.lastSegment()]=cu(e):n.push(s.lastSegment())})),e=this.getFieldsMap(t),this.applyChanges(e,r,n)}delete(e){var t=this.field(e.popLast());hu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let n=t.mapValue.fields[e.get(r)];hu(n)&&n.mapValue.fields||(n={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=n),t=n}return t.mapValue.fields}applyChanges(e,t,r){Pc(t,((t,r)=>e[t]=r));for(const t of r)delete e[t]}clone(){return new uu(cu(this.value))}}class du{constructor(e,t,r,n,s,i,o){this.key=e,this.documentType=t,this.version=r,this.readTime=n,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new du(e,0,ac.min(),ac.min(),ac.min(),uu.empty(),0)}static newFoundDocument(e,t,r,n){return new du(e,1,t,ac.min(),r,n,0)}static newNoDocument(e,t){return new du(e,2,t,ac.min(),ac.min(),uu.empty(),0)}static newUnknownDocument(e,t){return new du(e,3,t,ac.min(),ac.min(),uu.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ac.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=uu.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=uu.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ac.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof du&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new du(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class pu{constructor(e,t){this.position=e,this.inclusive=t}}function fu(e,t,r){let n=0;for(let o=0;o<e.position.length;o++){var s=t[o],i=e.position[o];if(n=s.field.isKeyField()?dc.comparator(dc.fromName(i.referenceValue),r.key):tu(i,r.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function gu(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Zc(e.position[r],t.position[r]))return!1;return!0}class mu{constructor(e,t="asc"){this.field=e,this.dir=t}}function vu(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class yu{}class wu extends yu{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Iu(e,t,r):"array-contains"===t?new Ru(e,r):"in"===t?new Nu(e,r):"not-in"===t?new Ou(e,r):"array-contains-any"===t?new Pu(e,r):new wu(e,t,r)}static createKeyFieldInFilter(e,t,r){return new("in"===t?Cu:Su)(e,r)}matches(e){return e=e.data.field(this.field),"!="===this.op?null!==e&&this.matchesComparison(tu(e,this.value)):null!==e&&Xc(this.value)===Xc(e)&&this.matchesComparison(tu(e,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return 0<e;case">=":return 0<=e;default:return zh()}}isInequality(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class bu extends yu{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new bu(e,t)}matches(e){return _u(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null===this.ue&&(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function _u(e){return"and"===e.op}function ku(e){return function(e){for(const t of e.filters)if(t instanceof bu)return!1;return!0}(e)&&_u(e)}function Eu(e){var t;return e instanceof wu?e.field.canonicalString()+e.op.toString()+nu(e.value):ku(e)?e.filters.map((e=>Eu(e))).join(","):(t=e.filters.map((e=>Eu(e))).join(","),e.op+`(${t})`)}function Tu(e,t){return e instanceof wu?(n=e,(s=t)instanceof wu&&n.op===s.op&&n.field.isEqual(s.field)&&Zc(n.value,s.value)):e instanceof bu?(n=e,(r=t)instanceof bu&&n.op===r.op&&n.filters.length===r.filters.length&&n.filters.reduce(((e,t,n)=>e&&Tu(t,r.filters[n])),!0)):void zh();var r,n,s}function xu(e){return e instanceof wu?`${(t=e).field.canonicalString()} ${t.op} `+nu(t.value):e instanceof bu?(t=e).op.toString()+" {"+t.getFilters().map(xu).join(" ,")+"}":"Filter";var t}class Iu extends wu{constructor(e,t,r){super(e,t,r),this.key=dc.fromName(r.referenceValue)}matches(e){return e=dc.comparator(e.key,this.key),this.matchesComparison(e)}}class Cu extends wu{constructor(e,t){super(e,"in",t),this.keys=Au("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Su extends wu{constructor(e,t){super(e,"not-in",t),this.keys=Au("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Au(e,t){return((null==(t=t.arrayValue)?void 0:t.values)||[]).map((e=>dc.fromName(e.referenceValue)))}class Ru extends wu{constructor(e,t){super(e,"array-contains",t)}matches(e){return ou(e=e.data.field(this.field))&&eu(e.arrayValue,this.value)}}class Nu extends wu{constructor(e,t){super(e,"in",t)}matches(e){return null!==(e=e.data.field(this.field))&&eu(this.value.arrayValue,e)}}class Ou extends wu{constructor(e,t){super(e,"not-in",t)}matches(e){return!eu(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&null!==(e=e.data.field(this.field))&&!eu(this.value.arrayValue,e)}}class Pu extends wu{constructor(e,t){super(e,"array-contains-any",t)}matches(e){return!(!ou(e=e.data.field(this.field))||!e.arrayValue.values)&&e.arrayValue.values.some((e=>eu(this.value.arrayValue,e)))}}class Du{constructor(e,t=null,r=[],n=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=n,this.limit=s,this.startAt=i,this.endAt=o,this.ce=null}}function Lu(e,t=null,r=[],n=[],s=null,i=null,o=null){return new Du(e,t,r,n,s,i,o)}function Mu(e){if(null===(e=qh(e)).ce){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t=(t=(t+="|f:")+e.filters.map((e=>Eu(e))).join(",")+"|ob:")+e.orderBy.map((e=>e.field.canonicalString()+e.dir)).join(","),Rc(e.limit)||(t=(t+="|l:")+e.limit),e.startAt&&(t=(t=(t+="|lb:")+(e.startAt.inclusive?"b:":"a:"))+e.startAt.position.map((e=>nu(e))).join(",")),e.endAt&&(t=(t=(t+="|ub:")+(e.endAt.inclusive?"a:":"b:"))+e.endAt.position.map((e=>nu(e))).join(",")),e.ce=t}return e.ce}function Uu(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!vu(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Tu(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!gu(e.startAt,t.startAt)&&gu(e.endAt,t.endAt)}function Fu(e){return dc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class ju{constructor(e,t=null,r=[],n=[],s=null,i="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=n,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Bu(e){return new ju(e)}function Vu(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function zu(e){const t=qh(e);if(null===t.le){t.le=[];const e=new Set;for(const r of t.explicitOrderBy)t.le.push(r),e.add(r.field.canonicalString());const r=0<t.explicitOrderBy.length?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",n=function(e){let t=new Uc(uc.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);n.forEach((n=>{e.has(n.canonicalString())||n.isKeyField()||t.le.push(new mu(n,r))})),e.has(uc.keyField().canonicalString())||t.le.push(new mu(uc.keyField(),r))}return t.le}function $u(e){var t=qh(e);return t.he||(t.he=function(e,t){if("F"===e.limitType)return Lu(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);t=t.map((e=>{var t="desc"===e.dir?"asc":"desc";return new mu(e.field,t)}));var r=e.endAt?new pu(e.endAt.position,e.endAt.inclusive):null,n=e.startAt?new pu(e.startAt.position,e.startAt.inclusive):null;return Lu(e.path,e.collectionGroup,t,e.filters,e.limit,r,n)}(t,zu(e))),t.he}function qu(e,t,r){return new ju(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Hu(e,t){return Uu($u(e),$u(t))&&e.limitType===t.limitType}function Gu(e){return Mu($u(e))+"|lt:"+e.limitType}function Ku(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(t+=`, filters: [${e.filters.map((e=>xu(e))).join(", ")}]`),Rc(e.limit)||(t+=", limit: "+e.limit),0<e.orderBy.length&&(t+=`, orderBy: [${e.orderBy.map((e=>`${e.field.canonicalString()} (${e.dir})`)).join(", ")}]`),e.startAt&&(t=(t=(t+=", startAt: ")+(e.startAt.inclusive?"b:":"a:"))+e.startAt.position.map((e=>nu(e))).join(",")),`Target(${t=e.endAt?(t=(t+=", endAt: ")+(e.endAt.inclusive?"a:":"b:"))+e.endAt.position.map((e=>nu(e))).join(","):t})`}($u(e))}; limitType=${e.limitType})`}function Wu(e,t){return t.isFoundDocument()&&(r=e,s=(n=t).key.path,null!==r.collectionGroup?n.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):dc.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s))&&function(e,t){for(const r of zu(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(const r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&(n=t,!((r=e).startAt&&!function(e,t,r){return t=fu(e,t,r),e.inclusive?t<=0:t<0}(r.startAt,zu(r),n)||r.endAt&&!function(e,t,r){return t=fu(e,t,r),e.inclusive?0<=t:0<t}(r.endAt,zu(r),n)));var r,n,s}function Qu(e){return(t,r)=>{let n=!1;for(const s of zu(e)){const e=Ju(s,t,r);if(0!==e)return e;n=n||s.field.isKeyField()}return 0}}function Ju(e,t,r){var n=e.field.isKeyField()?dc.comparator(t.key,r.key):function(e,t,r){return t=t.data.field(e),r=r.data.field(e),null!==t&&null!==r?tu(t,r):zh()}(e.field,t,r);switch(e.dir){case"asc":return n;case"desc":return-1*n;default:return zh()}}class Yu{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[t,n]of r)if(this.equalsFn(t,e))return n}has(e){return void 0!==this.get(e)}set(e,t){var r=this.mapKeyFn(e),n=this.inner[r];if(void 0===n)this.inner[r]=[[e,t]];else{for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return void(n[r]=[e,t]);n.push([e,t])}this.innerSize++}delete(e){var t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return 1===r.length?delete this.inner[t]:r.splice(n,1),this.innerSize--,!0;return!1}forEach(e){Pc(this.inner,((t,r)=>{for(const[t,n]of r)e(t,n)}))}isEmpty(){return function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(this.inner)}size(){return this.innerSize}}const Xu=new Dc(dc.comparator);function Zu(){return Xu}const ed=new Dc(dc.comparator);function td(...e){let t=ed;for(const r of e)t=t.insert(r.key,r);return t}function rd(e){let t=ed;return e.forEach(((e,r)=>t=t.insert(e,r.overlayedDocument))),t}function nd(){return id()}function sd(){return id()}function id(){return new Yu((e=>e.toString()),((e,t)=>e.isEqual(t)))}const od=new Uc(dc.comparator);function ad(...e){let t=od;for(const r of e)t=t.add(r);return t}const ld=new Uc(sc);class hd{constructor(){this._=void 0}}function cd(e,t,r){var n;return e instanceof dd?(n=t,r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}},(n=n&&Gc(n)?Kc(n):n)&&(r.fields.__previous_value__=n),{mapValue:r}):e instanceof pd?fd(e,t):e instanceof gd?md(e,t):(r=function(e,t){return e instanceof vd?iu(e=t)||e&&"doubleValue"in e?t:{integerValue:0}:null}(n=e,r=t),e=yd(r)+yd(n.Ie),iu(r)&&iu(n.Ie)?function(e){return{integerValue:""+e}}(e):function(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nc(t)?"-0":t}}(n.serializer,e))}function ud(e,t,r){return e instanceof pd?fd(e,t):e instanceof gd?md(e,t):r}class dd extends hd{}class pd extends hd{constructor(e){super(),this.elements=e}}function fd(e,t){var r=wd(t);for(const t of e.elements)r.some((e=>Zc(e,t)))||r.push(t);return{arrayValue:{values:r}}}class gd extends hd{constructor(e){super(),this.elements=e}}function md(e,t){let r=wd(t);for(const t of e.elements)r=r.filter((e=>!Zc(e,t)));return{arrayValue:{values:r}}}class vd extends hd{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function yd(e){return qc(e.integerValue||e.doubleValue)}function wd(e){return ou(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class bd{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new bd}static exists(e){return new bd(void 0,e)}static updateTime(e){return new bd(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _d(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class kd{}function Ed(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Od(e.key,bd.none()):new Cd(e.key,e.data,bd.none());{var r,n=e.data,s=uu.empty();let i=new Uc(uc.comparator);for(r of t.fields)if(!i.has(r)){let e=n.field(r);null===e&&1<r.length&&(r=r.popLast(),e=n.field(r)),null===e?s.delete(r):s.set(r,e),i=i.add(r)}return new Sd(e.key,s,new jc(i.toArray()),bd.none())}}function Td(e,t,r){var n,s,i,o;e instanceof Cd?(s=t,i=r,o=(n=e).value.clone(),n=Rd(n.fieldTransforms,s,i.transformResults),o.setAll(n),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()):e instanceof Sd?(n=t,s=r,_d((i=e).precondition,n)?(o=Rd(i.fieldTransforms,n,s.transformResults),(e=n.data).setAll(Ad(i)),e.setAll(o),n.convertToFoundDocument(s.version,e).setHasCommittedMutations()):n.convertToUnknownDocument(s.version)):t.convertToNoDocument(r.version).setHasCommittedMutations()}function xd(e,t,r,n){return e instanceof Cd?(i=t,o=r,a=n,_d((s=e).precondition,i)?(l=s.value.clone(),s=Nd(s.fieldTransforms,a,i),l.setAll(s),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),null):o):e instanceof Sd?(a=t,s=r,i=n,_d((l=e).precondition,a)?(i=Nd(l.fieldTransforms,i,a),(o=a.data).setAll(Ad(l)),o.setAll(i),a.convertToFoundDocument(a.version,o).setHasLocalMutations(),null===s?null:s.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((e=>e.field)))):s):(n=t,t=r,_d(e.precondition,n)?(n.convertToNoDocument(n.version).setHasLocalMutations(),null):t);var s,i,o,a,l}function Id(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(r=e.fieldTransforms,n=t.fieldTransforms,!!(void 0===r&&void 0===n||r&&n&&ic(r,n,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&(e=e.transform,t=t.transform,e instanceof pd&&t instanceof pd||e instanceof gd&&t instanceof gd?ic(e.elements,t.elements,Zc):e instanceof vd&&t instanceof vd?Zc(e.Ie,t.Ie):e instanceof dd&&t instanceof dd)}(e,t)))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var r,n}class Cd extends kd{constructor(e,t,r,n=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=n,this.type=0}getFieldMask(){return null}}class Sd extends kd{constructor(e,t,r,n,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=n,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Ad(e){const t=new Map;return e.fieldMask.fields.forEach((r=>{var n;r.isEmpty()||(n=e.data.field(r),t.set(r,n))})),t}function Rd(e,t,r){var n=new Map;$h(e.length===r.length);for(let a=0;a<r.length;a++){var s=e[a],i=s.transform,o=t.data.field(s.field);n.set(s.field,ud(i,o,r[a]))}return n}function Nd(e,t,r){var n=new Map;for(const s of e){const e=s.transform,i=r.data.field(s.field);n.set(s.field,cd(e,i,t))}return n}class Od extends kd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Pd{constructor(e,t,r,n){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=n}applyToRemoteDocument(e,t){var r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){var n=this.mutations[t];n.key.isEqual(e.key)&&Td(n,e,r[t])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=xd(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=xd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=sd();return this.mutations.forEach((n=>{var s=(i=e.get(n.key)).overlayedDocument,i=this.applyToLocalView(s,i.mutatedFields);null!==(i=Ed(s,t.has(n.key)?null:i))&&r.set(n.key,i),s.isValidDocument()||s.convertToNoDocument(ac.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ad())}isEqual(e){return this.batchId===e.batchId&&ic(this.mutations,e.mutations,((e,t)=>Id(e,t)))&&ic(this.baseMutations,e.baseMutations,((e,t)=>Id(e,t)))}}class Dd{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Ld{constructor(e,t){this.count=e,this.unchangedNames=t}}function Md(e){if(void 0===e)return jh("GRPC error has no .code"),Hh.UNKNOWN;switch(e){case bh.OK:return Hh.OK;case bh.CANCELLED:return Hh.CANCELLED;case bh.UNKNOWN:return Hh.UNKNOWN;case bh.DEADLINE_EXCEEDED:return Hh.DEADLINE_EXCEEDED;case bh.RESOURCE_EXHAUSTED:return Hh.RESOURCE_EXHAUSTED;case bh.INTERNAL:return Hh.INTERNAL;case bh.UNAVAILABLE:return Hh.UNAVAILABLE;case bh.UNAUTHENTICATED:return Hh.UNAUTHENTICATED;case bh.INVALID_ARGUMENT:return Hh.INVALID_ARGUMENT;case bh.NOT_FOUND:return Hh.NOT_FOUND;case bh.ALREADY_EXISTS:return Hh.ALREADY_EXISTS;case bh.PERMISSION_DENIED:return Hh.PERMISSION_DENIED;case bh.FAILED_PRECONDITION:return Hh.FAILED_PRECONDITION;case bh.ABORTED:return Hh.ABORTED;case bh.OUT_OF_RANGE:return Hh.OUT_OF_RANGE;case bh.UNIMPLEMENTED:return Hh.UNIMPLEMENTED;case bh.DATA_LOSS:return Hh.DATA_LOSS;default:return zh()}}(_h=bh=bh||{})[_h.OK=0]="OK",_h[_h.CANCELLED=1]="CANCELLED",_h[_h.UNKNOWN=2]="UNKNOWN",_h[_h.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_h[_h.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_h[_h.NOT_FOUND=5]="NOT_FOUND",_h[_h.ALREADY_EXISTS=6]="ALREADY_EXISTS",_h[_h.PERMISSION_DENIED=7]="PERMISSION_DENIED",_h[_h.UNAUTHENTICATED=16]="UNAUTHENTICATED",_h[_h.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_h[_h.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_h[_h.ABORTED=10]="ABORTED",_h[_h.OUT_OF_RANGE=11]="OUT_OF_RANGE",_h[_h.UNIMPLEMENTED=12]="UNIMPLEMENTED",_h[_h.INTERNAL=13]="INTERNAL",_h[_h.UNAVAILABLE=14]="UNAVAILABLE",_h[_h.DATA_LOSS=15]="DATA_LOSS";const Ud=new Oh([4294967295,4294967295],0);function Fd(e){e=(new TextEncoder).encode(e);var t=new Nh;return t.update(e),new Uint8Array(t.digest())}function jd(e){var t=(e=new DataView(e.buffer)).getUint32(0,!0),r=e.getUint32(4,!0),n=e.getUint32(8,!0);e=e.getUint32(12,!0);return[new Oh([t,r],0),new Oh([n,e],0)]}class Bd{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||8<=t)throw new Vd("Invalid padding: "+t);if(r<0)throw new Vd("Invalid hash count: "+r);if(0<e.length&&0===this.hashCount)throw new Vd("Invalid hash count: "+r);if(0===e.length&&0!==t)throw new Vd("Invalid padding when bitmap length is 0: "+t);this.Te=8*e.length-t,this.Ee=Oh.fromNumber(this.Te)}de(e,t,r){let n=e.add(t.multiply(Oh.fromNumber(r)));return(n=1===n.compare(Ud)?new Oh([n.getBits(0),n.getBits(1)],0):n).modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=Fd(e),[r,n]=jd(t);for(let e=0;e<this.hashCount;e++){const t=this.de(r,n,e);if(!this.Ae(t))return!1}return!0}static create(e,t,r){const n=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new Bd(s,n,t);return r.forEach((e=>i.insert(e))),i}insert(e){if(0!==this.Te){const t=Fd(e),[r,n]=jd(t);for(let e=0;e<this.hashCount;e++){const t=this.de(r,n,e);this.Re(t)}}}Re(e){var t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class Vd extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class zd{constructor(e,t,r,n,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=n,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){var n=new Map;return n.set(e,$d.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new zd(ac.min(),n,new Dc(sc),Zu(),ad())}}class $d{constructor(e,t,r,n,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=n,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new $d(r,t,ad(),ad(),ad())}}class qd{constructor(e,t,r,n){this.Ve=e,this.removedTargetIds=t,this.key=r,this.me=n}}class Hd{constructor(e,t){this.targetId=e,this.fe=t}}class Gd{constructor(e,t,r=Vc.EMPTY_BYTE_STRING,n=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=n}}class Kd{constructor(){this.ge=0,this.pe=Jd(),this.ye=Vc.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){0<e.approximateByteSize()&&(this.Se=!0,this.ye=e)}ve(){let e=ad(),t=ad(),r=ad();return this.pe.forEach(((n,s)=>{switch(s){case 0:e=e.add(n);break;case 2:t=t.add(n);break;case 1:r=r.add(n);break;default:zh()}})),new $d(this.ye,this.we,e,t,r)}Fe(){this.Se=!1,this.pe=Jd()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){--this.ge,$h(0<=this.ge)}Le(){this.Se=!0,this.we=!0}}class Wd{constructor(e){this.Be=e,this.ke=new Map,this.qe=Zu(),this.Qe=Qd(),this.Ke=new Dc(sc)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,(t=>{var r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(t);break;case 3:this.je(t)&&(r.Le(),r.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.Ce(e.resumeToken));break;default:zh()}}))}forEachTarget(e,t){0<e.targetIds.length?e.targetIds.forEach(t):this.ke.forEach(((e,r)=>{this.je(r)&&t(r)}))}Je(e){const t=e.targetId,r=e.fe.count,n=this.Ye(t);if(n){var s=n.target;if(Fu(s))if(0===r){const e=new dc(s.path);this.We(t,e,du.newNoDocument(e,ac.min()))}else $h(1===r);else{const n=this.Ze(t);if(n!==r){const r=this.Xe(e),s=r?this.et(r,e,n):1;if(0!==s){this.He(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}}}}}Xe(e){var t;if(!(t=e.fe.unchangedNames)||!t.bits)return null;var{bits:{bitmap:t="",padding:r=0},hashCount:n=0}=t;let s,i;try{s=Hc(t).toUint8Array()}catch(e){if(e instanceof Bc)return Bh("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new Bd(s,r,n)}catch(e){return Bh(e instanceof Vd?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.Te?null:i}et(e,t,r){return t.fe.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){var r=this.Be.getRemoteKeysForTarget(t);let n=0;return r.forEach((r=>{var s=`projects/${(s=this.Be.nt()).projectId}/databases/${s.database}/documents/`+r.path.canonicalString();e.mightContain(s)||(this.We(t,r,null),n++)})),n}it(e){const t=new Map;this.ke.forEach(((r,n)=>{var s=this.Ye(n);if(s){if(r.current&&Fu(s.target)){const t=new dc(s.target.path);null!==this.qe.get(t)||this.st(n,t)||this.We(n,t,du.newNoDocument(t,e))}r.De&&(t.set(n,r.ve()),r.Fe())}}));let r=ad();this.Qe.forEach(((e,t)=>{let n=!0;t.forEachWhile((e=>!(e=this.Ye(e))||"TargetPurposeLimboResolution"===e.purpose||(n=!1))),n&&(r=r.add(e))})),this.qe.forEach(((t,r)=>r.setReadTime(e)));var n=new zd(e,t,this.Ke,this.qe,r);return this.qe=Zu(),this.Qe=Qd(),this.Ke=new Dc(sc),n}Ue(e,t){var r;this.je(e)&&(r=this.st(e,t.key)?2:0,this.ze(e).Me(t.key,r),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e)))}We(e,t,r){var n;this.je(e)&&(n=this.ze(e),this.st(e,t)?n.Me(t,1):n.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),r)&&(this.qe=this.qe.insert(t,r))}removeTarget(e){this.ke.delete(e)}Ze(e){var t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Kd,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new Uc(sc),this.Qe=this.Qe.insert(e,t)),t}je(e){var t=null!==this.Ye(e);return t||Fh("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){var t=this.ke.get(e);return t&&t.be?null:this.Be._t(e)}He(e){this.ke.set(e,new Kd),this.Be.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}st(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function Qd(){return new Dc(dc.comparator)}function Jd(){return new Dc(dc.comparator)}const Yd={asc:"ASCENDING",desc:"DESCENDING"},Xd={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zd={and:"AND",or:"OR"};class ep{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function tp(e,t){return e.useProto3Json||Rc(t)?t:{value:t}}function rp(e){return $h(!!e),ac.fromTimestamp(function(e){return e=$c(e),new oc(e.seconds,e.nanos)}(e))}function np(e,t){return e=new hc(["projects",e.projectId,"databases",e.database]).child("documents"),void 0===t?e:e.child(t)}function sp(e){return $h(wp(e=hc.fromString(e))),e}function ip(e,t){if((t=sp(t)).get(1)!==e.databaseId.projectId)throw new Gh(Hh.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+e.databaseId.projectId);if(t.get(3)!==e.databaseId.database)throw new Gh(Hh.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+e.databaseId.database);return new dc(lp(t))}function op(e,t){return function(e,t){return np(e,t).canonicalString()}(e.databaseId,t)}function ap(e){return new hc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function lp(e){return $h(4<e.length&&"documents"===e.get(4)),e.popFirst(5)}function hp(e,t){return{documents:[op(e,t.path)]}}function cp(e,t){var r={structuredQuery:{}},n=t.path;let s;null!==t.collectionGroup?(s=n,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=op(e,s);n=function(e){if(0!==e.length)return yp(bu.create(e,"and"))}(t.filters),n&&(r.structuredQuery.where=n),n=function(e){if(0!==e.length)return e.map((e=>({field:mp(e.field),direction:pp(e.dir)})))}(t.orderBy);return null!==(n=(n&&(r.structuredQuery.orderBy=n),tp(e,t.limit)))&&(r.structuredQuery.limit=n),t.startAt&&(r.structuredQuery.startAt={before:(e=t.startAt).inclusive,values:e.position}),t.endAt&&(r.structuredQuery.endAt={before:!(n=t.endAt).inclusive,values:n.position}),{ut:r,parent:s}}function up(e){let t=function(e){return 4===(e=sp(e)).length?hc.emptyPath():lp(e)}(e.parent);var r=e.structuredQuery,n=r.from?r.from.length:0;let s=null;if(0<n){$h(1===n);const e=r.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[],o=(r.where&&(i=function(e){return(e=dp(e))instanceof bu&&ku(e)?e.getFilters():[e]}(r.where)),[]),a=(r.orderBy&&(o=r.orderBy.map((e=>new mu(vp(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))))),null),l=(r.limit&&(a=function(e){return Rc(e="object"==typeof e?e.value:e)?null:e}(r.limit)),null),h=(r.startAt&&(n=!!(e=r.startAt).before,e=e.values||[],l=new pu(e,n)),null);return r.endAt&&(n=!(e=r.endAt).before,e=e.values||[],h=new pu(e,n)),function(e,t,r,n,s,i,o,a){return new ju(e,t,r,n,s,i,o,a)}(t,s,o,i,a,"F",l,h)}function dp(e){var t;if(void 0===e.unaryFilter)return void 0!==e.fieldFilter?(t=e,wu.create(vp(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return zh()}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?(t=e,bu.create(t.compositeFilter.filters.map((e=>dp(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return zh()}}(t.compositeFilter.op))):zh();var r=e;switch(r.unaryFilter.op){case"IS_NAN":var n=vp(r.unaryFilter.field);return wu.create(n,"==",{doubleValue:NaN});case"IS_NULL":return n=vp(r.unaryFilter.field),wu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=vp(r.unaryFilter.field),wu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return n=vp(r.unaryFilter.field),wu.create(n,"!=",{nullValue:"NULL_VALUE"});default:return zh()}}function pp(e){return Yd[e]}function fp(e){return Xd[e]}function gp(e){return Zd[e]}function mp(e){return{fieldPath:e.canonicalString()}}function vp(e){return uc.fromServerFormat(e.fieldPath)}function yp(e){if(e instanceof wu){var t=e;if("=="===t.op){if(lu(t.value))return{unaryFilter:{field:mp(t.field),op:"IS_NAN"}};if(au(t.value))return{unaryFilter:{field:mp(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(lu(t.value))return{unaryFilter:{field:mp(t.field),op:"IS_NOT_NAN"}};if(au(t.value))return{unaryFilter:{field:mp(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mp(t.field),op:fp(t.op),value:t.value}}}return e instanceof bu?1===(e=(t=e).getFilters().map((e=>yp(e)))).length?e[0]:{compositeFilter:{op:gp(t.op),filters:e}}:zh()}function wp(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)}class bp{constructor(e,t,r,n,s=ac.min(),i=ac.min(),o=Vc.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=n,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new bp(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bp(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bp(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class _p{constructor(e){this.ct=e}}function kp(e){var t=up({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qu(t,t.limit,"L"):t}class Ep{constructor(){this._n=new Tp}addToCollectionParentIndex(e,t){return this._n.add(t),wc.resolve()}getCollectionParents(e,t){return wc.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return wc.resolve()}deleteFieldIndex(e,t){return wc.resolve()}deleteAllFieldIndexes(e){return wc.resolve()}createTargetIndexes(e,t){return wc.resolve()}getDocumentsMatchingTarget(e,t){return wc.resolve(null)}getIndexType(e,t){return wc.resolve(0)}getFieldIndexes(e,t){return wc.resolve([])}getNextCollectionGroupToUpdate(e){return wc.resolve(null)}getMinOffset(e,t){return wc.resolve(fc.min())}getMinOffsetFromCollectionGroup(e,t){return wc.resolve(fc.min())}updateCollectionGroup(e,t,r){return wc.resolve()}updateIndexEntries(e,t){return wc.resolve()}}class Tp{constructor(){this.index={}}add(e){var t=e.lastSegment(),r=(e=e.popLast(),this.index[t]||new Uc(hc.comparator)),n=!r.has(e);return this.index[t]=r.add(e),n}has(e){var t=e.lastSegment();e=e.popLast();return(t=this.index[t])&&t.has(e)}getEntries(e){return(this.index[e]||new Uc(hc.comparator)).toArray()}}class xp{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new xp(0)}static Ln(){return new xp(-1)}}class Ip{constructor(){this.changes=new Yu((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,du.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();var r=this.changes.get(t);return void 0!==r?wc.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Cp{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Sp{constructor(e,t,r,n){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=n}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((n=>(r=n,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==r&&xd(r.mutation,e,jc.empty(),oc.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ad()).next((()=>t))))}getLocalViewOfDocuments(e,t,r=ad()){const n=nd();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,r).next((e=>{let t=td();return e.forEach(((e,r)=>{t=t.insert(e,r.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const r=nd();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,ad())))}populateOverlays(e,t,r){const n=[];return r.forEach((e=>{t.has(e)||n.push(e)})),this.documentOverlayCache.getOverlays(e,n).next((e=>{e.forEach(((e,r)=>{t.set(e,r)}))}))}computeViews(e,t,r,n){let s=Zu();const i=id(),o=id();return t.forEach(((e,t)=>{var o=r.get(t.key);n.has(t.key)&&(void 0===o||o.mutation instanceof Sd)?s=s.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),xd(o.mutation,t,o.mutation.getFieldMask(),oc.now())):i.set(t.key,jc.empty())})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>o.set(e,new Cp(t,null!=(t=i.get(e))?t:null)))),o)))}recalculateAndSaveOverlays(e,t){const r=id();let n=new Dc(((e,t)=>e-t)),s=ad();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{var i,o=t.get(e);null!==o&&(i=r.get(e)||jc.empty(),i=s.applyToLocalView(o,i),r.set(e,i),o=(n.get(s.batchId)||ad()).add(e),n=n.insert(s.batchId,o))}))})).next((()=>{for(var i=[],o=n.getReverseIterator();o.hasNext();){const n=o.getNext(),a=n.key,l=n.value,h=sd();l.forEach((e=>{var n;s.has(e)||(null!==(n=Ed(t.get(e),r.get(e)))&&h.set(e,n),s=s.add(e))})),i.push(this.documentOverlayCache.saveOverlays(e,a,h))}return wc.waitFor(i)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,r,n){return s=t,dc.isDocumentKey(s.path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,n):this.getDocumentsMatchingCollectionQuery(e,t,r,n);var s}getNextDocuments(e,t,r,n){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,n).next((s=>{var i=0<n-s.size?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,n-s.size):wc.resolve(nd());let o=-1,a=s;return i.next((t=>wc.forEach(t,((t,r)=>(o<r.largestBatchId&&(o=r.largestBatchId),s.get(t)?wc.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,a,t,ad()))).next((e=>({batchId:o,changes:rd(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new dc(t)).next((e=>{let t=td();return e.isFoundDocument()?t.insert(e.key,e):t}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,n){const s=t.collectionGroup;let i=td();return this.indexManager.getCollectionParents(e,s).next((o=>wc.forEach(o,(o=>{a=t,o=o.child(s);var a;o=new ju(o,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt);return this.getDocumentsMatchingCollectionQuery(e,o,r,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,r,n){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,n)))).next((e=>{s.forEach(((t,r)=>{r=r.getKey(),null===e.get(r)&&(e=e.insert(r,du.newInvalidDocument(r)))}));let r=td();return e.forEach(((e,n)=>{var i=s.get(e);void 0!==i&&xd(i.mutation,n,jc.empty(),oc.now()),Wu(t,n)&&(r=r.insert(e,n))})),r}))}}class Ap{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return wc.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,{id:t.id,version:t.version,createTime:rp(t.createTime)}),wc.resolve()}getNamedQuery(e,t){return wc.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,{name:t.name,query:kp(t.bundledQuery),readTime:rp(t.readTime)}),wc.resolve()}}class Rp{constructor(){this.overlays=new Dc(dc.comparator),this.hr=new Map}getOverlay(e,t){return wc.resolve(this.overlays.get(t))}getOverlays(e,t){const r=nd();return wc.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&r.set(t,e)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((r,n)=>{this.ht(e,t,n)})),wc.resolve()}removeOverlaysForBatchId(e,t,r){var n=this.hr.get(r);return void 0!==n&&(n.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(r)),wc.resolve()}getOverlaysForCollection(e,t,r){const n=nd(),s=t.length+1,i=new dc(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>r&&n.set(e.getKey(),e)}return wc.resolve(n)}getOverlaysForCollectionGroup(e,t,r,n){let s=new Dc(((e,t)=>e-t));for(var i=this.overlays.getIterator();i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=s.get(e.largestBatchId);null===t&&(t=nd(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=nd(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=n)););return wc.resolve(o)}ht(e,t,r){var n=this.overlays.get(r.key);if(null!==n){const e=this.hr.get(n.largestBatchId).delete(r.key);this.hr.set(n.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new Dd(t,r));let s=this.hr.get(t);void 0===s&&(s=ad(),this.hr.set(t,s)),this.hr.set(t,s.add(r.key))}}class Np{constructor(){this.Pr=new Uc(Op.Ir),this.Tr=new Uc(Op.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){e=new Op(e,t),this.Pr=this.Pr.add(e),this.Tr=this.Tr.add(e)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new Op(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new dc(new hc([])),r=new Op(t,e),n=new Op(t,e+1),s=[];return this.Tr.forEachInRange([r,n],(e=>{this.Ar(e),s.push(e.key)})),s}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){var t=new dc(new hc([])),r=new Op(t,e);t=new Op(t,e+1);let n=ad();return this.Tr.forEachInRange([r,t],(e=>{n=n.add(e.key)})),n}containsKey(e){var t=new Op(e,0);return null!==(t=this.Pr.firstAfterOrEqual(t))&&e.isEqual(t.key)}}class Op{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return dc.comparator(e.key,t.key)||sc(e.pr,t.pr)}static Er(e,t){return sc(e.pr,t.pr)||dc.comparator(e.key,t.key)}}class Pp{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new Uc(Op.Ir)}checkEmpty(e){return wc.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,n){var s=this.yr;this.yr++,0<this.mutationQueue.length&&this.mutationQueue[this.mutationQueue.length-1],t=new Pd(s,t,r,n);this.mutationQueue.push(t);for(const t of n)this.wr=this.wr.add(new Op(t.key,s)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return wc.resolve(t)}lookupMutationBatch(e,t){return wc.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){return t=(t=this.br(t+1))<0?0:t,wc.resolve(this.mutationQueue.length>t?this.mutationQueue[t]:null)}getHighestUnacknowledgedBatchId(){return wc.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return wc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Op(t,0),n=new Op(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,n],(e=>{e=this.Sr(e.pr),s.push(e)})),wc.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Uc(sc);return t.forEach((e=>{var t=new Op(e,0);e=new Op(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,e],(e=>{r=r.add(e.pr)}))})),wc.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,n=r.length+1;let s=r;dc.isDocumentKey(s)||(s=s.child("")),t=new Op(new dc(s),0);let i=new Uc(sc);return this.wr.forEachWhile((e=>{var t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===n&&(i=i.add(e.pr)),!0)}),t),wc.resolve(this.Dr(i))}Dr(e){const t=[];return e.forEach((e=>{null!==(e=this.Sr(e))&&t.push(e)})),t}removeMutationBatch(e,t){$h(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.wr;return wc.forEach(t.mutations,(n=>{var s=new Op(n.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,n.key)})).next((()=>{this.wr=r}))}Mn(e){}containsKey(e,t){var r=new Op(t,0);r=this.wr.firstAfterOrEqual(r);return wc.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,wc.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){return(e=this.br(e))<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Dp{constructor(e){this.vr=e,this.docs=new Dc(dc.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){var r=t.key,n=(n=this.docs.get(r))?n.size:0,s=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-n,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){var r=this.docs.get(t);return wc.resolve(r?r.document.mutableCopy():du.newInvalidDocument(t))}getEntries(e,t){let r=Zu();return t.forEach((e=>{var t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():du.newInvalidDocument(e))})),wc.resolve(r)}getDocumentsMatchingQuery(e,t,r,n){let s=Zu();const i=t.path,o=new dc(i.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||gc(pc(o),r)<=0||(n.has(o.key)||Wu(t,o))&&(s=s.insert(o.key,o.mutableCopy()))}return wc.resolve(s)}getAllFromCollectionGroup(e,t,r,n){zh()}Fr(e,t){return wc.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Lp(this)}getSize(e){return wc.resolve(this.size)}}class Lp extends Ip{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((r,n)=>{n.isValidDocument()?t.push(this.ar.addEntry(e,n)):this.ar.removeEntry(r)})),wc.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class Mp{constructor(e){this.persistence=e,this.Mr=new Yu((e=>Mu(e)),Uu),this.lastRemoteSnapshotVersion=ac.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Np,this.targetCount=0,this.Lr=xp.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,r)=>t(r))),wc.resolve()}getLastRemoteSnapshotVersion(e){return wc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return wc.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),wc.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),wc.resolve()}qn(e){this.Mr.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Lr=new xp(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,wc.resolve()}updateTargetData(e,t){return this.qn(t),wc.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),--this.targetCount,wc.resolve()}removeTargets(e,t,r){let n=0;const s=[];return this.Mr.forEach(((i,o)=>{o.sequenceNumber<=t&&null===r.get(o.targetId)&&(this.Mr.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),n++)})),wc.waitFor(s).next((()=>n))}getTargetCount(e){return wc.resolve(this.targetCount)}getTargetData(e,t){return t=this.Mr.get(t)||null,wc.resolve(t)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),wc.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);const n=this.persistence.referenceDelegate,s=[];return n&&t.forEach((t=>{s.push(n.markPotentiallyOrphaned(e,t))})),wc.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),wc.resolve()}getMatchingKeysForTargetId(e,t){return t=this.Nr.gr(t),wc.resolve(t)}containsKey(e,t){return wc.resolve(this.Nr.containsKey(t))}}class Up{constructor(e,t){this.Br={},this.overlays={},this.kr=new Ac(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Mp(this),this.indexManager=new Ep,this.remoteDocumentCache=new Dp(e=e=>this.referenceDelegate.Kr(e)),this.serializer=new _p(t),this.$r=new Ap(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Rp,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new Pp(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){Fh("MemoryPersistence","Starting transaction:",e);const n=new Fp(this.kr.next());return this.referenceDelegate.Ur(),r(n).next((e=>this.referenceDelegate.Wr(n).next((()=>e)))).toPromise().then((e=>(n.raiseOnCommittedEvent(),e)))}Gr(e,t){return wc.or(Object.values(this.Br).map((r=>()=>r.containsKey(e,t))))}}class Fp extends vc{constructor(e){super(),this.currentSequenceNumber=e}}class jp{constructor(e){this.persistence=e,this.zr=new Np,this.jr=null}static Hr(e){return new jp(e)}get Jr(){if(this.jr)return this.jr;throw zh()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),wc.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),wc.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),wc.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>r.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return wc.forEach(this.Jr,(r=>{const n=dc.fromPath(r);return this.Yr(e,n).next((e=>{e||t.removeEntry(n,ac.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return wc.or([()=>wc.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class Bp{constructor(e,t,r,n){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=n}static Ki(e,t){let r=ad(),n=ad();for(const e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:n=n.add(e.doc.key)}return new Bp(e,t.fromCache,r,n)}}class Vp{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class zp{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=es()?8:0<_c.v(Zn())?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,n){const s={result:null};return this.ji(e,t).next((e=>{s.result=e})).next((()=>{if(!s.result)return this.Hi(e,t,n,r).next((e=>{s.result=e}))})).next((()=>{if(!s.result){const r=new Vp;return this.Ji(e,t,r).next((n=>{if(s.result=n,this.Ui)return this.Yi(e,t,r,n.size)}))}})).next((()=>s.result))}Yi(e,t,r,n){return r.documentReadCount<this.Wi?(Uh()<=vn.DEBUG&&Fh("QueryEngine","SDK will not create cache indexes for query:",Ku(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),wc.resolve()):(Uh()<=vn.DEBUG&&Fh("QueryEngine","Query:",Ku(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.Gi*n?(Uh()<=vn.DEBUG&&Fh("QueryEngine","The SDK decides to create cache indexes for query:",Ku(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,$u(t))):wc.resolve())}ji(e,t){if(Vu(t))return wc.resolve(null);let r=$u(t);return this.indexManager.getIndexType(e,r).next((n=>0===n?null:(null!==t.limit&&1===n&&(t=qu(t,null,"F"),r=$u(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((n=>{const s=ad(...n);return this.zi.getDocuments(e,s).next((n=>this.indexManager.getMinOffset(e,r).next((r=>{var i=this.Zi(t,n);return this.Xi(t,i,s,r.readTime)?this.ji(e,qu(t,null,"F")):this.es(e,i,t,r)}))))})))))}Hi(e,t,r,n){return Vu(t)||n.isEqual(ac.min())?wc.resolve(null):this.zi.getDocuments(e,r).next((s=>(s=this.Zi(t,s),this.Xi(t,s,r,n)?wc.resolve(null):(Uh()<=vn.DEBUG&&Fh("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ku(t)),this.es(e,s,t,function(e,t){var r=e.toTimestamp().seconds;return e=e.toTimestamp().nanoseconds+1,r=ac.fromTimestamp(1e9===e?new oc(r+1,0):new oc(r,e)),new fc(r,dc.empty(),t)}(n,-1)).next((e=>e))))))}Zi(e,t){let r=new Uc(Qu(e));return t.forEach(((t,n)=>{Wu(e,n)&&(r=r.add(n))})),r}Xi(e,t,r,n){return null!==e.limit&&(r.size!==t.size||!!(r="F"===e.limitType?t.last():t.first())&&(r.hasPendingWrites||0<r.version.compareTo(n)))}Ji(e,t,r){return Uh()<=vn.DEBUG&&Fh("QueryEngine","Using full collection scan to execute query:",Ku(t)),this.zi.getDocumentsMatchingQuery(e,t,fc.min(),r)}es(e,t,r,n){return this.zi.getDocumentsMatchingQuery(e,r,n).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class $p{constructor(e,t,r,n){this.persistence=e,this.ts=t,this.serializer=n,this.ns=new Dc(sc),this.rs=new Yu((e=>Mu(e)),Uu),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Sp(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}async function qp(e,t){const r=qh(e);return r.persistence.runTransaction("Handle user change","readonly",(e=>{let n;return r.mutationQueue.getAllMutationBatches(e).next((s=>(n=s,r._s(t),r.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],i=[];let o=ad();for(const e of n){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return r.localDocuments.getDocuments(e,o).next((e=>({us:e,removedBatchIds:s,addedBatchIds:i})))}))}))}function Hp(e){const t=qh(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function Gp(e,t){const r=qh(e),n=t.snapshotVersion;let s=r.ns;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=r.os.newChangeBuffer({trackRemovals:!0}),o=(s=r.ns,[]);t.targetChanges.forEach(((i,a)=>{var l,h,c=s.get(a);if(c){o.push(r.Qr.removeMatchingKeys(e,i.removedDocuments,a).next((()=>r.Qr.addMatchingKeys(e,i.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(Vc.EMPTY_BYTE_STRING,ac.min()).withLastLimboFreeSnapshotVersion(ac.min()):0<i.resumeToken.approximateByteSize()&&(u=u.withResumeToken(i.resumeToken,n)),s=s.insert(a,u),l=u,h=i,(0===c.resumeToken.approximateByteSize()||3e8<=l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()||0<h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size)&&o.push(r.Qr.updateTargetData(e,u))}}));let a=Zu(),l=ad();if(t.documentUpdates.forEach((n=>{t.resolvedLimboDocuments.has(n)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(e,n))})),o.push(function(e,t,r){let n=ad(),s=ad();return r.forEach((e=>n=n.add(e))),t.getEntries(e,n).next((e=>{let n=Zu();return r.forEach(((r,i)=>{var o=e.get(r);i.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(r)),i.isNoDocument()&&i.version.isEqual(ac.min())?(t.removeEntry(r,i.readTime),n=n.insert(r,i)):!o.isValidDocument()||0<i.version.compareTo(o.version)||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),n=n.insert(r,i)):Fh("LocalStore","Ignoring outdated watch update for ",r,". Current version:",o.version," Watch version:",i.version)})),{cs:n,ls:s}}))}(e,i,t.documentUpdates).next((e=>{a=e.cs,l=e.ls}))),!n.isEqual(ac.min())){const t=r.Qr.getLastRemoteSnapshotVersion(e).next((t=>r.Qr.setTargetsMetadata(e,e.currentSequenceNumber,n)));o.push(t)}return wc.waitFor(o).next((()=>i.apply(e))).next((()=>r.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(r.ns=s,e)))}async function Kp(e,t,r){const n=qh(e),s=n.ns.get(t),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(e=>n.persistence.referenceDelegate.removeTarget(e,s)))}catch(e){if(!Tc(e))throw e;Fh("LocalStore",`Failed to update sequence numbers for target ${t}: `+e)}n.ns=n.ns.remove(t),n.rs.delete(s.target)}function Wp(e,t,r){const n=qh(e);let s=ac.min(),i=ad();return n.persistence.runTransaction("Execute query","readwrite",(e=>{return o=n,a=e,l=$u(t),(void 0!==(h=(o=qh(o)).rs.get(l))?wc.resolve(o.ns.get(h)):o.Qr.getTargetData(a,l)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,n.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>n.ts.getDocumentsMatchingQuery(e,t,r?s:ac.min(),r?i:ad()))).next((e=>(function(e,t,r){let n=e.ss.get(t)||ac.min();r.forEach(((e,t)=>{0<t.readTime.compareTo(n)&&(n=t.readTime)})),e.ss.set(t,n)}(n,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,hs:i})));var o,a,l,h}))}class Qp{constructor(){this.activeTargetIds=ld}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jp{constructor(){this.no=new Qp,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Qp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Yp{io(e){}shutdown(){}}class Xp{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Fh("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Fh("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Zp=null;function ef(){return null===Zp?Zp=268435456+Math.round(2147483648*Math.random()):Zp++,"0x"+Zp.toString(16)}const tf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rf{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const nf="WebChannelConnection";class sf extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),n=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${r}/databases/`+n,this.yo="(default)"===this.databaseId.database?"project_id="+r:`project_id=${r}&database_id=`+n}get wo(){return!1}So(e,t,r,n,s){const i=ef(),o=this.bo(e,t.toUriEncodedString());return Fh("RestConnection",`Sending RPC '${e}' ${i}:`,o,r),t={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo},this.Do(t,n,s),this.Co(e,o,t,r).then((t=>(Fh("RestConnection",`Received RPC '${e}' ${i}: `,t),t)),(t=>{throw Bh("RestConnection",`RPC '${e}' ${i} failed with error: `,t,"url: ",o,"request:",r),t}))}vo(e,t,r,n,s,i){return this.So(e,t,r,n,s)}Do(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Lh,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,r)=>e[r]=t)),r&&r.headers.forEach(((t,r)=>e[r]=t))}bo(e,t){return e=tf[e],this.fo+`/v1/${t}:`+e}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,r,n){const s=ef();return new Promise(((i,o)=>{const a=new Rh;a.setWithCredentials(!0),a.listenOnce(xh.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case Th.NO_ERROR:var t=a.getResponseJson();Fh(nf,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case Th.TIMEOUT:Fh(nf,`RPC '${e}' ${s} timed out`),o(new Gh(Hh.DEADLINE_EXCEEDED,"Request time out"));break;case Th.HTTP_ERROR:var r=a.getStatus();if(Fh(nf,`RPC '${e}' ${s} failed with status:`,r,"response text:",a.getResponseText()),0<r){let e=a.getResponseJson();var n=null==(e=Array.isArray(e)?e[0]:e)?void 0:e.error;if(n&&n.status&&n.message){const e=function(e){return e=e.toLowerCase().replace(/_/g,"-"),0<=Object.values(Hh).indexOf(e)?e:Hh.UNKNOWN}(n.status);o(new Gh(e,n.message))}else o(new Gh(Hh.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Gh(Hh.UNAVAILABLE,"Connection failed."));break;default:zh()}}finally{Fh(nf,`RPC '${e}' ${s} completed.`)}}));var l=JSON.stringify(n);Fh(nf,`RPC '${e}' ${s} sending request:`,n),a.send(t,"POST",l,r,15)}))}Fo(e,t,r){const n=ef(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=new Jl,o=Wo(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/`+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0,t=s.join(""),Fh(nf,`Creating RPC '${e}' stream ${n}: `+t,a);const h=i.createWebChannel(t,a);let c=!1,u=!1;const d=new rf({lo:t=>{u?Fh(nf,`Not sending because RPC '${e}' stream ${n} is closed:`,t):(c||(Fh(nf,`Opening RPC '${e}' stream ${n} transport.`),h.open(),c=!0),Fh(nf,`RPC '${e}' stream ${n} sending:`,t),h.send(t))},ho:()=>h.close()}),p=(e,t,r)=>{e.listen(t,(e=>{try{r(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(h,Ah.EventType.OPEN,(()=>{u||Fh(nf,`RPC '${e}' stream ${n} transport opened.`)})),p(h,Ah.EventType.CLOSE,(()=>{u||(u=!0,Fh(nf,`RPC '${e}' stream ${n} transport closed`),d.Vo())})),p(h,Ah.EventType.ERROR,(t=>{u||(u=!0,Bh(nf,`RPC '${e}' stream ${n} transport errored:`,t),d.Vo(new Gh(Hh.UNAVAILABLE,"The operation could not be completed")))})),p(h,Ah.EventType.MESSAGE,(t=>{var r;if(!u)if(r=(r=($h(!!(t=t.data[0])),t)).error||(null==(r=r[0])?void 0:r.error)){Fh(nf,`RPC '${e}' stream ${n} received error:`,r);const t=r.status;let s=function(e){if(void 0!==(e=bh[e]))return Md(e)}(t),i=r.message;void 0===s&&(s=Hh.INTERNAL,i="Unknown error status: "+t+" with message "+r.message),u=!0,d.Vo(new Gh(s,i)),h.close()}else Fh(nf,`RPC '${e}' stream ${n} received:`,t),d.mo(t)})),p(o,Ih.STAT_EVENT,(t=>{t.stat===Ch?Fh(nf,`RPC '${e}' stream ${n} detected buffering proxy`):t.stat===Sh&&Fh(nf,`RPC '${e}' stream ${n} detected no buffering proxy`)})),setTimeout((()=>{d.Ro()}),0),d}}function of(){return"undefined"!=typeof document?document:null}function af(e){return new ep(e,!0)}class lf{constructor(e,t,r=1e3,n=1.5,s=6e4){this.oi=e,this.timerId=t,this.Mo=r,this.xo=n,this.Oo=s,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();var t=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Bo),n=Math.max(0,t-r);0<n&&Fh("ExponentialBackoff",`Backing off for ${n} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,n,(()=>(this.Bo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class hf{constructor(e,t,r,n,s,i,o,a){this.oi=e,this.$o=r,this.Uo=n,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new lf(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===Hh.RESOURCE_EXHAUSTED?(jh(t.toString()),jh("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===Hh.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,r])=>{this.Wo===t&&this.o_(e,r)}),(t=>{e((()=>{var e=new Gh(Hh.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const r=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{r((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{r((()=>this.__(e)))})),this.stream.onMessage((e=>{r((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return Fh("PersistentStream","close with error: "+e),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(Fh("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class cf extends hf{constructor(e,t,r,n,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,n,i),this.serializer=s}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();var t=function(e,t){let r;if("targetChange"in t){t.targetChange;var n="NO_CHANGE"===(n=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===n?1:"REMOVE"===n?2:"CURRENT"===n?3:"RESET"===n?4:zh(),s=t.targetChange.targetIds||[],i=(i=t.targetChange.resumeToken,e.useProto3Json?($h(void 0===i||"string"==typeof i),Vc.fromBase64String(i||"")):($h(void 0===i||i instanceof Buffer||i instanceof Uint8Array),Vc.fromUint8Array(i||new Uint8Array))),o=(a=t.targetChange.cause)&&(o=void 0===a.code?Hh.UNKNOWN:Md(a.code),new Gh(o,a.message||""));r=new Gd(n,s,i,o||null)}else if("documentChange"in t){t.documentChange,(a=t.documentChange).document,a.document.name,a.document.updateTime,n=ip(e,a.document.name),s=rp(a.document.updateTime),i=a.document.createTime?rp(a.document.createTime):ac.min();var a,l=new uu({mapValue:{fields:a.document.fields}}),h=(s=du.newFoundDocument(n,s,i,l),l=a.targetIds||[],a.removedTargetIds||[]);r=new qd(l,h,s.key,s)}else if("documentDelete"in t)t.documentDelete,(l=t.documentDelete).document,h=ip(e,l.document),s=l.readTime?rp(l.readTime):ac.min(),h=du.newNoDocument(h,s),s=l.removedTargetIds||[],r=new qd([],s,h.key,h);else if("documentRemove"in t)t.documentRemove,(l=t.documentRemove).document,s=ip(e,l.document),h=l.removedTargetIds||[],r=new qd([],h,s,null);else{if(!("filter"in t))return zh();{t.filter;const e=t.filter;e.targetId;var{count:l=0,unchangedNames:h}=e;s=new Ld(l,h),t=e.targetId,r=new Hd(t,s)}}return r}(this.serializer,e);e=!("targetChange"in e)||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ac.min():rp(e.readTime);return this.listener.u_(t,e)}c_(e){var t={};t.database=ap(this.serializer),t.addTarget=function(e,t){var r;const n=t.target;if((r=Fu(n)?{documents:hp(e,n)}:{query:cp(e,n).ut}).targetId=t.targetId,0<t.resumeToken.approximateByteSize()){r.resumeToken=function(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}(e,t.resumeToken);const n=tp(e,t.expectedCount);null!==n&&(r.expectedCount=n)}else if(0<t.snapshotVersion.compareTo(ac.min())){r.readTime=function(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}(e,t.snapshotVersion.toTimestamp());const n=tp(e,t.expectedCount);null!==n&&(r.expectedCount=n)}return r}(this.serializer,e),e=function(e,t){return t=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return zh()}}(t.purpose),null==t?null:{"goog-listen-tags":t}}(this.serializer,e);e&&(t.labels=e),this.t_(t)}l_(e){var t={};t.database=ap(this.serializer),t.removeTarget=e,this.t_(t)}}class uf extends class{}{constructor(e,t,r,n){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=n,this.A_=!1}R_(){if(this.A_)throw new Gh(Hh.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,r,n){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,i])=>this.connection.So(e,np(t,r),n,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Hh.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Gh(Hh.UNKNOWN,e.toString())}))}vo(e,t,r,n,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.vo(e,np(t,r),n,i,o,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Hh.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Gh(Hh.UNKNOWN,e.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class df{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,1<=this.m_&&(this.b_(),this.w_("Connection failed 1 times. Most recent error: "+e.toString()),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){e=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`,this.g_?(jh(e),this.g_=!1):Fh("OnlineStateTracker",e)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class pf{constructor(e,t,r,n,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io((e=>{r.enqueueAndForget((async()=>{var e;kf(this)&&(Fh("RemoteStore","Restarting streams for network reachability change."),(e=qh(e=this)).v_.add(4),await gf(e),e.x_.set("Unknown"),e.v_.delete(4),await ff(e))}))})),this.x_=new df(r,n)}}async function ff(e){if(kf(e))for(const t of e.F_)await t(!0)}async function gf(e){for(const t of e.F_)await t(!1)}function mf(e,t){(e=qh(e)).C_.has(t.targetId)||(e.C_.set(t.targetId,t),_f(e)?bf(e):Af(e).Jo()&&yf(e,t))}function vf(e,t){var r=Af(e=qh(e));e.C_.delete(t),r.Jo()&&wf(e,t),0===e.C_.size&&(r.Jo()?r.Xo():kf(e)&&e.x_.set("Unknown"))}function yf(e,t){var r;e.O_.Oe(t.targetId),(0<t.resumeToken.approximateByteSize()||0<t.snapshotVersion.compareTo(ac.min()))&&(r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size,t=t.withExpectedCount(r)),Af(e).c_(t)}function wf(e,t){e.O_.Oe(t),Af(e).l_(t)}function bf(e){e.O_=new Wd({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Af(e).start(),e.x_.p_()}function _f(e){return kf(e)&&!Af(e).Ho()&&0<e.C_.size}function kf(e){return 0===qh(e).v_.size}function Ef(e){e.O_=void 0}async function Tf(e){e.C_.forEach(((t,r)=>{yf(e,t)}))}async function xf(e,t){Ef(e),_f(e)?(e.x_.S_(t),bf(e)):e.x_.set("Unknown")}async function If(e,t,r){if(e.x_.set("Online"),t instanceof Gd&&2===t.state&&t.cause)try{!async function(e,t){var r=t.cause;for(const n of t.targetIds)e.C_.has(n)&&(await e.remoteSyncer.rejectListen(n,r),e.C_.delete(n),e.O_.removeTarget(n))}(e,t)}catch(r){Fh("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Cf(e,r)}else if(t instanceof qd?e.O_.$e(t):t instanceof Hd?e.O_.Je(t):e.O_.Ge(t),!r.isEqual(ac.min()))try{const t=await Hp(e.localStore);0<=r.compareTo(t)&&(s=r,(i=(n=e).O_.it(s)).targetChanges.forEach(((e,t)=>{var r;0<e.resumeToken.approximateByteSize()&&(r=n.C_.get(t))&&n.C_.set(t,r.withResumeToken(e.resumeToken,s))})),i.targetMismatches.forEach(((e,t)=>{var r=n.C_.get(e);r&&(n.C_.set(e,r.withResumeToken(Vc.EMPTY_BYTE_STRING,r.snapshotVersion)),wf(n,e),e=new bp(r.target,e,t,r.sequenceNumber),yf(n,e))})),await n.remoteSyncer.applyRemoteEvent(i))}catch(t){Fh("RemoteStore","Failed to raise snapshot:",t),await Cf(e,t)}var n,s,i}async function Cf(e,t,r){if(!Tc(t))throw t;e.v_.add(1),await gf(e),e.x_.set("Offline"),r=r||(()=>Hp(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Fh("RemoteStore","Retrying IndexedDB access"),await r(),e.v_.delete(1),await ff(e)}))}async function Sf(e,t){var r=((e=qh(e)).asyncQueue.verifyOperationInProgress(),Fh("RemoteStore","RemoteStore received new credentials"),kf(e));e.v_.add(3),await gf(e),r&&e.x_.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.v_.delete(3),await ff(e)}function Af(e){return e.N_||(e.N_=function(e,t,r){return(e=qh(e)).R_(),new cf(t,e.connection,e.authCredentials,e.appCheckCredentials,e.serializer,r)}(e.datastore,e.asyncQueue,{Po:Tf.bind(null,e),To:xf.bind(null,e),u_:If.bind(null,e)}),e.F_.push((async t=>{t?(e.N_.Zo(),_f(e)?bf(e):e.x_.set("Unknown")):(await e.N_.stop(),Ef(e))}))),e.N_}class Rf{constructor(e,t,r,n,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=n,this.removalCallback=s,this.deferred=new Kh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,n,s){var i=Date.now()+r;return(e=new Rf(e,t,i,n,s)).start(r),e}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Gh(Hh.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nf(e,t){if(jh("AsyncQueue",t+": "+e),Tc(e))return new Gh(Hh.UNAVAILABLE,t+": "+e);throw e}class Of{constructor(e){this.comparator=e?(t,r)=>e(t,r)||dc.comparator(t.key,r.key):(e,t)=>dc.comparator(e.key,t.key),this.keyedMap=td(),this.sortedSet=new Dc(this.comparator)}static emptySet(e){return new Of(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){return(e=this.keyedMap.get(e))?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Of))return!1;if(this.size!==e.size)return!1;for(var t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();t.hasNext();){const e=t.getNext().key,n=r.getNext().key;if(!e.isEqual(n))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){var r=new Of;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Pf{constructor(){this.B_=new Dc(dc.comparator)}track(e){var t=e.doc.key,r=this.B_.get(t);!r||0!==e.type&&3===r.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==r.type?this.B_=this.B_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.B_=this.B_.remove(t):1===e.type&&2===r.type?this.B_=this.B_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):zh()}k_(){const e=[];return this.B_.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Df{constructor(e,t,r,n,s,i,o,a,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=n,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,n,s){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new Df(e,t,Of.emptySet(t),i,r,n,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==r[e].type||!t[e].doc.isEqual(r[e].doc))return!1;return!0}}class Lf{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some((e=>e.U_()))}}class Mf{constructor(){this.queries=new Yu((e=>Gu(e)),Hu),this.onlineState="Unknown",this.W_=new Set}}function Uf(e,t){var r=qh(e);let n=!1;for(const e of t){const t=e.query,s=r.queries.get(t);if(s){for(const t of s.Q_)t.z_(e)&&(n=!0);s.q_=e}}n&&jf(r)}function Ff(e,t,r){var n=(e=qh(e)).queries.get(t);if(n)for(const e of n.Q_)e.onError(r);e.queries.delete(t)}function jf(e){e.W_.forEach((e=>{e.next()}))}(Eh=kh=kh||{}).j_="default",Eh.Cache="cache";class Bf{constructor(e,t,r){this.query=e,this.H_=t,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=r||{}}z_(e){if(!this.options.includeMetadataChanges){const t=[];for(const r of e.docChanges)3!==r.type&&t.push(r);e=new Df(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),t=!0):this.X_(e,this.onlineState)&&(this.ea(e),t=!0),this.Y_=e,t}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let t=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),t=!0),t}X_(e,t){return!e.fromCache||!this.U_()||(!this.options.ta||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Z_(e){var t;return 0<e.docChanges.length||(t=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites,!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges)}ea(e){e=Df.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==kh.Cache}}class Vf{constructor(e){this.key=e}}class zf{constructor(e){this.key=e}}class $f{constructor(e,t){this.query=e,this.ua=t,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=ad(),this.mutatedKeys=ad(),this.ha=Qu(e),this.Pa=new Of(this.ha)}get Ia(){return this.ua}Ta(e,t){const r=t?t.Ea:new Pf,n=(t||this).Pa;let s=(t||this).mutatedKeys,i=n,o=!1;const a="F"===this.query.limitType&&n.size===this.query.limit?n.last():null,l="L"===this.query.limitType&&n.size===this.query.limit?n.first():null;if(e.inorderTraversal(((e,t)=>{var h=n.get(e),c=(t=Wu(this.query,t)?t:null,!!h&&this.mutatedKeys.has(h.key)),u=!!t&&(t.hasLocalMutations||this.mutatedKeys.has(t.key)&&t.hasCommittedMutations);let d=!1;h&&t?h.data.isEqual(t.data)?c!==u&&(r.track({type:3,doc:t}),d=!0):!this.da(h,t)&&(r.track({type:2,doc:t}),d=!0,a&&0<this.ha(t,a)||l&&this.ha(t,l)<0)&&(o=!0):!h&&t?(r.track({type:0,doc:t}),d=!0):h&&!t&&(r.track({type:1,doc:h}),d=!0,a||l)&&(o=!0),d&&(s=t?(i=i.add(t),u?s.add(e):s.delete(e)):(i=i.delete(e),s.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),r.track({type:1,doc:e})}return{Pa:i,Ea:r,Xi:o,mutatedKeys:s}}da(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,n){var s=this.Pa,i=(this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys,e.Ea.k_()),o=(t=(i.sort(((e,t)=>{return r=e.type,n=t.type,(s=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zh()}})(r)-s(n)||this.ha(e.doc,t.doc);var r,n,s})),this.Aa(r),n=null!=n&&n,t&&!n?this.Ra():[]),(n=0===this.la.size&&this.current&&!n?1:0)!==this.ca);return this.ca=n,0!==i.length||o?{snapshot:new Df(this.query,e.Pa,s,i,e.mutatedKeys,0==n,o,!1,!!r&&0<r.resumeToken.approximateByteSize()),Va:t}:{Va:t}}G_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new Pf,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach((e=>this.ua=this.ua.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ua=this.ua.delete(e))),this.current=e.current)}Ra(){if(!this.current)return[];const e=this.la,t=(this.la=ad(),this.Pa.forEach((e=>{this.ma(e.key)&&(this.la=this.la.add(e.key))})),[]);return e.forEach((e=>{this.la.has(e)||t.push(new zf(e))})),this.la.forEach((r=>{e.has(r)||t.push(new Vf(r))})),t}fa(e){return this.ua=e.hs,this.la=ad(),e=this.Ta(e.documents),this.applyChanges(e,!0)}ga(){return Df.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,0===this.ca,this.hasCachedResults)}}class qf{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Hf{constructor(e){this.key=e,this.pa=!1}}class Gf{constructor(e,t,r,n,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=n,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.ya={},this.wa=new Yu((e=>Gu(e)),Hu),this.Sa=new Map,this.ba=new Set,this.Da=new Dc(dc.comparator),this.Ca=new Map,this.va=new Np,this.Fa={},this.Ma=new Map,this.xa=xp.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}async function Kf(e,t,r=!0){var n=(e=hg(e)).wa.get(t);return n?(e.sharedClientState.addLocalQueryTarget(n.targetId),n.view.ga()):await Qf(e,t,r,!0)}async function Wf(e,t){await Qf(hg(e),t,!0,!1)}async function Qf(e,t,r,n){var s=await function(e,t){const r=qh(e);return r.persistence.runTransaction("Allocate target","readwrite",(e=>{let n;return r.Qr.getTargetData(e,t).next((s=>s?(n=s,wc.resolve(n)):r.Qr.allocateTargetId(e).next((s=>(n=new bp(t,s,"TargetPurposeListen",e.currentSequenceNumber),r.Qr.addTargetData(e,n).next((()=>n)))))))})).then((e=>{var n=r.ns.get(e.targetId);return(null===n||0<e.snapshotVersion.compareTo(n.snapshotVersion))&&(r.ns=r.ns.insert(e.targetId,e),r.rs.set(t,e.targetId)),e}))}(e.localStore,$u(t)),i=s.targetId,o=r?e.sharedClientState.addLocalQueryTarget(i):"not-current";let a;return n&&(a=await async function(e,t,r,n,s){e.Na=(t,r,n)=>async function(e,t,r,n){let s=t.view.Ta(r);return s.Xi&&(s=await Wp(e.localStore,t.query,!1).then((({documents:e})=>t.view.Ta(e,s)))),r=n&&n.targetChanges.get(t.targetId),n=n&&null!=n.targetMismatches.get(t.targetId),r=t.view.applyChanges(s,e.isPrimaryClient,r,n),ng(e,t.targetId,r.Va),r.snapshot}(e,t,r,n);var i=await Wp(e.localStore,t,!0),o=new $f(t,i.hs);i=o.Ta(i.documents),n=$d.createSynthesizedTargetChangeForCurrentChange(r,n&&"Offline"!==e.onlineState,s),s=o.applyChanges(i,e.isPrimaryClient,n),ng(e,r,s.Va),i=new qf(t,r,o);return e.wa.set(t,i),e.Sa.has(r)?e.Sa.get(r).push(t):e.Sa.set(r,[t]),s.snapshot}(e,t,i,"current"===o,s.resumeToken)),e.isPrimaryClient&&r&&mf(e.remoteStore,s),a}async function Jf(e,t,r){const n=qh(e),s=n.wa.get(t),i=n.Sa.get(s.targetId);1<i.length?(n.Sa.set(s.targetId,i.filter((e=>!Hu(e,t)))),n.wa.delete(t)):n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Kp(n.localStore,s.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(s.targetId),r&&vf(n.remoteStore,s.targetId),tg(n,s.targetId)})).catch(yc)):(tg(n,s.targetId),await Kp(n.localStore,s.targetId,!0))}async function Yf(e,t){t=(e=qh(e)).wa.get(t);var r=e.Sa.get(t.targetId);e.isPrimaryClient&&1===r.length&&(e.sharedClientState.removeLocalQueryTarget(t.targetId),vf(e.remoteStore,t.targetId))}async function Xf(e,t){const r=qh(e);try{const e=await Gp(r.localStore,t);t.targetChanges.forEach(((e,t)=>{(t=r.Ca.get(t))&&($h(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),0<e.addedDocuments.size?t.pa=!0:0<e.modifiedDocuments.size?$h(t.pa):0<e.removedDocuments.size&&($h(t.pa),t.pa=!1))})),await og(r,e,t)}catch(e){await yc(e)}}function Zf(e,t,r){var n=qh(e);if(n.isPrimaryClient&&0===r||!n.isPrimaryClient&&1===r){const e=[];n.wa.forEach(((r,n)=>{(n=n.view.G_(t)).snapshot&&e.push(n.snapshot)}));{r=n.eventManager;var s=t;(r=qh(r)).onlineState=s;let e=!1;r.queries.forEach(((t,r)=>{for(const t of r.Q_)t.G_(s)&&(e=!0)})),e&&jf(r)}e.length&&n.ya.u_(e),n.onlineState=t,n.isPrimaryClient&&n.sharedClientState.setOnlineState(t)}}async function eg(e,t,r){const n=qh(e),s=(n.sharedClientState.updateQueryState(t,"rejected",r),n.Ca.get(t)),i=s&&s.key;if(i){let e=new Dc(dc.comparator);e=e.insert(i,du.newNoDocument(i,ac.min()));const r=ad().add(i),s=new zd(ac.min(),new Map,new Dc(sc),e,r);await Xf(n,s),n.Da=n.Da.remove(i),n.Ca.delete(t),ig(n)}else await Kp(n.localStore,t,!1).then((()=>tg(n,t,r))).catch(yc)}function tg(e,t,r=null){e.sharedClientState.removeLocalQueryTarget(t);for(const n of e.Sa.get(t))e.wa.delete(n),r&&e.ya.La(n,r);e.Sa.delete(t),e.isPrimaryClient&&e.va.Vr(t).forEach((t=>{e.va.containsKey(t)||rg(e,t)}))}function rg(e,t){e.ba.delete(t.path.canonicalString());var r=e.Da.get(t);null!==r&&(vf(e.remoteStore,r),e.Da=e.Da.remove(t),e.Ca.delete(r),ig(e))}function ng(e,t,r){for(const n of r)n instanceof Vf?(e.va.addReference(n.key,t),sg(e,n)):n instanceof zf?(Fh("SyncEngine","Document no longer in limbo: "+n.key),e.va.removeReference(n.key,t),e.va.containsKey(n.key)||rg(e,n.key)):zh()}function sg(e,t){var r=(t=t.key).path.canonicalString();e.Da.get(t)||e.ba.has(r)||(Fh("SyncEngine","New document in limbo: "+t),e.ba.add(r),ig(e))}function ig(e){for(;0<e.ba.size&&e.Da.size<e.maxConcurrentLimboResolutions;){var t=e.ba.values().next().value,r=(t=(e.ba.delete(t),new dc(hc.fromString(t))),e.xa.next());e.Ca.set(r,new Hf(t)),e.Da=e.Da.insert(t,r),mf(e.remoteStore,new bp($u(Bu(t.path)),r,"TargetPurposeLimboResolution",Ac._e))}}async function og(e,t,r){const n=qh(e),s=[],i=[],o=[];if(!n.wa.isEmpty()){n.wa.forEach(((e,a)=>{o.push(n.Na(a,t,r).then((e=>{(e||r)&&n.isPrimaryClient&&n.sharedClientState.updateQueryState(a.targetId,null!=e&&e.fromCache?"not-current":"current"),e&&(s.push(e),e=Bp.Ki(a.targetId,e),i.push(e))})))})),await Promise.all(o),n.ya.u_(s);{var a=n.localStore,l=i;const e=qh(a);try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>wc.forEach(l,(r=>wc.forEach(r.qi,(n=>e.persistence.referenceDelegate.addReference(t,r.targetId,n))).next((()=>wc.forEach(r.Qi,(n=>e.persistence.referenceDelegate.removeReference(t,r.targetId,n)))))))))}catch(a){if(!Tc(a))throw a;Fh("LocalStore","Failed to update sequence numbers: "+a)}for(const t of l){const r=t.targetId;if(!t.fromCache){const t=e.ns.get(r),n=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(n);e.ns=e.ns.insert(r,s)}}}}}async function ag(e,t){var r,n=qh(e);if(!n.currentUser.isEqual(t)){Fh("SyncEngine","User change. New user:",t.toKey());const e=await qp(n.localStore,t);n.currentUser=t,"'waitForPendingWrites' promise is rejected due to a user change.",(r=n).Ma.forEach((e=>{e.forEach((e=>{e.reject(new Gh(Hh.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),r.Ma.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await og(n,e.us)}}function lg(e,t){const r=qh(e),n=r.Ca.get(t);if(n&&n.pa)return ad().add(n.key);{let e=ad();const n=r.Sa.get(t);if(n)for(const t of n){const n=r.wa.get(t);e=e.unionWith(n.view.Ia)}return e}}function hg(e){return(e=qh(e)).remoteStore.remoteSyncer.applyRemoteEvent=Xf.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=lg.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=eg.bind(null,e),e.ya.u_=Uf.bind(null,e.eventManager),e.ya.La=Ff.bind(null,e.eventManager),e}class cg{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=af(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return function(e,t,r,n){return new $p(e,t,r,n)}(this.persistence,new zp,e.initialUser,this.serializer)}createPersistence(e){return new Up(jp.Hr,this.serializer)}createSharedClientState(e){return new Jp}async terminate(){var e;null!=(e=this.gcScheduler)&&e.stop(),null!=(e=this.indexBackfillerScheduler)&&e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ug{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Zf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ag.bind(null,this.syncEngine),await async function(e,t){e=qh(e),t?(e.v_.delete(2),await ff(e)):(e.v_.add(2),await gf(e),e.x_.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Mf}createDatastore(e){var t,r=af(e.databaseInfo.databaseId),n=(n=e.databaseInfo,new sf(n));return t=e.authCredentials,e=e.appCheckCredentials,new uf(t,e,n,r)}createRemoteStore(e){return t=this.localStore,r=this.datastore,e=e.asyncQueue,n=e=>Zf(this.syncEngine,e,0),s=new(Xp.D()?Xp:Yp),new pf(t,r,e,n,s);var t,r,n,s}createSyncEngine(e,t){var r=this.localStore,n=this.remoteStore,s=this.eventManager,i=this.sharedClientState,o=e.initialUser;e=e.maxConcurrentLimboResolutions;return r=new Gf(r,n,s,i,o,e),t&&(r.Oa=!0),r}async terminate(){var e=this.remoteStore;e=qh(e),Fh("RemoteStore","RemoteStore shutting down."),e.v_.add(5),await gf(e),e.M_.shutdown(),e.x_.set("Unknown"),await 0,null!=(e=this.datastore)&&e.terminate()}}class dg{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):jh("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class pg{constructor(e,t,r,n){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=n,this.user=Dh.UNAUTHENTICATED,this.clientId=nc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,(async e=>{Fh("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(r,(e=>(Fh("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Gh(Hh.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Kh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){var t=Nf(r,"Failed to shutdown persistence");e.reject(t)}})),e.promise}}async function fg(e,t){e.asyncQueue.verifyOperationInProgress(),Fh("FirestoreClient","Initializing OfflineComponentProvider");var r=e.configuration;await t.initialize(r);let n=r.initialUser;e.setCredentialChangeListener((async e=>{n.isEqual(e)||(await qp(t.localStore,e),n=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function gg(e,t){e.asyncQueue.verifyOperationInProgress();var r=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Fh("FirestoreClient","Using user provided OfflineComponentProvider");try{await fg(e,e._uninitializedComponentsProvider._offline)}catch(r){var t=r;if(!function(e){return"FirebaseError"===e.name?e.code===Hh.FAILED_PRECONDITION||e.code===Hh.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(t))throw t;Bh("Error using user provided cache. Falling back to memory cache: "+t),await fg(e,new cg)}}else Fh("FirestoreClient","Using default OfflineComponentProvider"),await fg(e,new cg);return e._offlineComponents}(e);Fh("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener((e=>Sf(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,r)=>Sf(t.remoteStore,r))),e._onlineComponents=t}async function mg(e){var t=(e=await async function(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Fh("FirestoreClient","Using user provided OnlineComponentProvider"),await gg(e,e._uninitializedComponentsProvider._online)):(Fh("FirestoreClient","Using default OnlineComponentProvider"),await gg(e,new ug))),e._onlineComponents}(e)).eventManager;return t.onListen=Kf.bind(null,e.syncEngine),t.onUnlisten=Jf.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Wf.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Yf.bind(null,e.syncEngine),t}function vg(e,t,r={}){const n=new Kh;return e.asyncQueue.enqueueAndForget((async()=>{{var s=await mg(e),i=e.asyncQueue,o=t,a=r,l=n;const h=new dg({next:e=>{i.enqueueAndForget((()=>async function(e,t){var r=qh(e),n=t.query;let s=3;var i=r.queries.get(n);if(i){const e=i.Q_.indexOf(t);0<=e&&(i.Q_.splice(e,1),0===i.Q_.length?s=t.U_()?0:1:!i.K_()&&t.U_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}(s,c)));var t=e.docs.has(o);!t&&e.fromCache?l.reject(new Gh(Hh.UNAVAILABLE,"Failed to get document because the client is offline.")):t&&e.fromCache&&a&&"server"===a.source?l.reject(new Gh(Hh.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(e)},error:e=>l.reject(e)}),c=new Bf(Bu(o.path),h,{includeMetadataChanges:!0,ta:!0});return async function(e,t){const r=qh(e);let n=3;var s=t.query;let i=r.queries.get(s);i?!i.K_()&&t.U_()&&(n=2):(i=new Lf,n=t.U_()?0:1);try{switch(n){case 0:i.q_=await r.onListen(s,!0);break;case 1:i.q_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(e){const r=Nf(e,`Initialization of query '${Ku(t.query)}' failed`);return void t.onError(r)}r.queries.set(s,i),i.Q_.push(t),t.G_(r.onlineState),i.q_&&t.z_(i.q_)&&jf(r)}(s,c)}})),n.promise}function yg(e){var t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const wg=new Map;function bg(e){if(!dc.isDocumentKey(e))throw new Gh(Hh.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function _g(e,t){if((e="_delegate"in e?e._delegate:e)instanceof t)return e;if(t.name===e.constructor.name)throw new Gh(Hh.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw e=function(e){var t;return void 0===e?"undefined":null===e?"null":"string"==typeof e?(20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e)):"number"==typeof e||"boolean"==typeof e?""+e:"object"==typeof e?e instanceof Array?"an array":(t=(t=e).constructor?t.constructor.name:null)?`a custom ${t} object`:"an object":"function"==typeof e?"a function":zh()}(e),new Gh(Hh.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: `+e)}class kg{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new Gh(Hh.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null==(t=e.ssl)||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Gh(Hh.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,n){if(!0===t&&!0===n)throw new Gh(Hh.INVALID_ARGUMENT,e+` and ${r} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yg(null!=(t=e.experimentalLongPollingOptions)?t:{});var t=this.experimentalLongPollingOptions;if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new Gh(Hh.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<5)throw new Gh(Hh.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is 5)`);if(30<t.timeoutSeconds)throw new Gh(Hh.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is 30)`)}this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,r}}class Eg{constructor(e,t,r,n){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kg({}),this._settingsFrozen=!1}get app(){if(this._app)return this._app;throw new Gh(Hh.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available")}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Gh(Hh.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kg(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Qh;switch(e.type){case"firstParty":return new Zh(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Gh(Hh.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return this,(e=wg.get(this))&&(Fh("ComponentProvider","Removing Datastore"),wg.delete(this),e.terminate()),Promise.resolve();var e}}class Tg{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Tg(this.firestore,e,this._query)}}class xg{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ig(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new xg(this.firestore,e,this._key)}}class Ig extends Tg{constructor(e,t,r){super(e,t,Bu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){var e=this._path.popLast();return e.isEmpty()?null:new xg(this.firestore,null,new dc(e))}withConverter(e){return new Ig(this.firestore,e,this._path)}}function Cg(e,t,...r){var n;if(e=cs(e),function(e,t,r){if(!r)throw new Gh(Hh.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}("doc","path",t=1===arguments.length?nc.newId():t),e instanceof Eg)return bg(n=hc.fromString(t,...r)),new xg(e,null,new dc(n));if(e instanceof xg||e instanceof Ig)return bg(n=e._path.child(hc.fromString(t,...r))),new xg(e.firestore,e instanceof Ig?e.converter:null,new dc(n));throw new Gh(Hh.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore")}class Sg{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new lf(this,"async_queue_retry"),this.cu=()=>{var e=of();e&&Fh("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};var e=of();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){this.iu||(this.iu=!0,this.au=e||!1,(e=of())&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.cu))}enqueue(e){if(this.lu(),this.iu)return new Promise((()=>{}));const t=new Kh;return this.hu((()=>this.iu&&this.au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.ru.push(e),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!Tc(e))throw e;Fh("AsyncQueue","Operation failed with retryable error: "+e)}0<this.ru.length&&this.jo.qo((()=>this.Pu()))}}hu(e){var t=this.nu.then((()=>(this._u=!0,e().catch((e=>{throw this.ou=e,this._u=!1,jh("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:t}(e)),e})).then((e=>(this._u=!1,e))))));return this.nu=t}enqueueAfterDelay(e,t,r){return this.lu(),-1<this.uu.indexOf(e)&&(t=0),e=Rf.createAndSchedule(this,e,t,r,(e=>this.Iu(e))),this.su.push(e),e}lu(){this.ou&&zh()}verifyOperationInProgress(){}async Tu(){for(var e;await(e=this.nu),e!==this.nu;);}Eu(e){for(const t of this.su)if(t.timerId===e)return!0;return!1}du(e){return this.Tu().then((()=>{this.su.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.su)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tu()}))}Au(e){this.uu.push(e)}Iu(e){e=this.su.indexOf(e),this.su.splice(e,1)}}class Ag extends Eg{constructor(e,t,r,n){super(e,t,r,n),this.type="firestore",this._queue=new Sg,this._persistenceKey=(null==n?void 0:n.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Rg(this),this._firestoreClient.terminate()}}function Rg(e){var t,r,n,s=e._freezeSettings(),i=(i=e._databaseId,t=(null==(t=e._app)?void 0:t.options.appId)||"",r=e._persistenceKey,new Qc(i,t,r,(n=s).host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling,yg(n.experimentalLongPollingOptions),n.useFetchStreams));e._firestoreClient=new pg(e._authCredentials,e._appCheckCredentials,e._queue,i),null!=(t=s.localCache)&&t._offlineComponentProvider&&null!=(r=s.localCache)&&r._onlineComponentProvider&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}class Ng{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ng(Vc.fromBase64String(e))}catch(e){throw new Gh(Hh.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ng(Vc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Og{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Gh(Hh.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new uc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Pg{constructor(e,t){if(!isFinite(e)||e<-90||90<e)throw new Gh(Hh.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new Gh(Hh.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return sc(this._lat,e._lat)||sc(this._long,e._long)}}const Dg=new RegExp("[~\\*/\\[\\]]");function Lg(e,t,r,n,s){var i=n&&!n.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`,l=(r&&(a+=" (via `toFirestore()`)"),a+=". ","");return(i||o)&&(l+=" (found",i&&(l+=" in field "+n),o&&(l+=" in document "+s),l+=")"),new Gh(Hh.INVALID_ARGUMENT,a+e+l)}class Mg{constructor(e,t,r,n,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=n,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xg(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){var e;if(this._document)return this._converter?(e=new Ug(this._firestore,this._userDataWriter,this._key,this._document,null),this._converter.fromFirestore(e)):this._userDataWriter.convertValue(this._document.data.value)}get(e){if(this._document&&null!==(e=this._document.data.field(Fg("DocumentSnapshot.get",e))))return this._userDataWriter.convertValue(e)}}class Ug extends Mg{data(){return super.data()}}function Fg(e,t){return"string"==typeof t?function(e,t,r){if(0<=t.search(Dg))throw Lg(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new Og(...t.split("."))._internalPath}catch(n){throw Lg(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}(e,t):(t instanceof Og?t:t._delegate)._internalPath}class jg{convertValue(e,t="none"){switch(Xc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qc(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Hc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw zh()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Pc(e,((e,n)=>{r[e]=this.convertValue(n,t)})),r}convertGeoPoint(e){return new Pg(qc(e.latitude),qc(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":var r=Kc(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Wc(e));default:return null}}convertTimestamp(e){return e=$c(e),new oc(e.seconds,e.nanos)}convertDocumentKey(e,t){var r=($h(wp(e=hc.fromString(e))),new Jc(e.get(1),e.get(3)));e=new dc(e.popFirst(5));return r.isEqual(t)||jh(`Document ${e} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),e}}class Bg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vg extends Mg{constructor(e,t,r,n,s,i){super(e,t,r,n,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){var t;if(this._document)return this._converter?(t=new zg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null),this._converter.fromFirestore(t,e)):this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}get(e,t={}){if(this._document&&null!==(e=this._document.data.field(Fg("DocumentSnapshot.get",e))))return this._userDataWriter.convertValue(e,t.serverTimestamps)}}class zg extends Vg{data(e={}){return super.data(e)}}function $g(e){e=_g(e,xg);const t=_g(e.firestore,Ag);return vg(function(e){return e._firestoreClient||Rg(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}(t),e._key).then((r=>function(e,t,r){var n=r.docs.get(t._key),s=new qg(e);return new Vg(e,s,t._key,n,new Bg(r.hasPendingWrites,r.fromCache),t.converter)}(t,e,r)))}class qg extends jg{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ng(e)}convertReference(e){return e=this.convertDocumentKey(e,this.firestore._databaseId),new xg(this.firestore,null,e)}}!function(e,t=!0){Lh=Zs,Ws(new us("firestore",((e,{instanceIdentifier:r,options:n})=>{var s=e.getProvider("app").getImmediate();e=new Ag(new Yh(e.getProvider("auth-internal")),new tc(e.getProvider("app-check-internal")),function(e,t){if(Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))return new Jc(e.options.projectId,t);throw new Gh(Hh.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}(s,r),s);return n=Object.assign({useFetchStreams:t},n),e._setSettings(n),e}),"PUBLIC").setMultipleInstances(!0)),ri(Ph,"4.6.0",e),ri(Ph,"4.6.0","esm2017")}();function Hg(e,t){var r={};for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(r[s[n]]=e[s[n]]);return r}function Gg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}ri("firebase","10.11.0","app");const Kg=Gg,Wg=new ns("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Qg=new bs("@firebase/auth");function Jg(e,...t){Qg.logLevel<=vn.ERROR&&Qg.error(`Auth (${Zs}): `+e,...t)}function Yg(e,...t){throw tm(e,...t)}function Xg(e,...t){return tm(e,...t)}function Zg(e,t,r){return r=Object.assign(Object.assign({},Kg()),{[t]:r}),new ns("auth","Firebase",r).create(t,{appName:e.name})}function em(e){return Zg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tm(e,...t){var r,n;return"string"!=typeof e?(r=t[0],(n=[...t.slice(1)])[0]&&(n[0].appName=e.name),e._errorFactory.create(r,...n)):Wg.create(e,...t)}function rm(e,t,...r){if(!e)throw tm(t,...r)}function nm(e){throw Jg(e="INTERNAL ASSERTION FAILED: "+e),new Error(e)}function sm(e,t){e||nm(t)}function im(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.href)||""}function om(){var e;return"undefined"!=typeof self&&(null==(e=self.location)?void 0:e.protocol)||null}function am(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===om()||"https:"===om()||function(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class lm{constructor(e,t){sm((this.shortDelay=e)<(this.longDelay=t),"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Zn())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return am()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function hm(e,t){return sm(e.emulator,"Emulator should always be set here"),e=e.emulator.url,t?""+e+(t.startsWith("/")?t.slice(1):t):e}class cm{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl||("undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void nm("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill"))}static headers(){return this.headersImpl||("undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void nm("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill"))}static response(){return this.responseImpl||("undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void nm("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill"))}}const um={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},dm=new lm(3e4,6e4);function pm(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function fm(e,t,r,n,s={}){return gm(e,s,(async()=>{let s={},i={};n&&("GET"===t?i=n:s={body:JSON.stringify(n)});var o=as(Object.assign({key:e.config.apiKey},i)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),cm.fetch()(mm(e,e.config.apiHost,r,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},s))}))}async function gm(e,t,r){e._canInitEmulator=!1,t=Object.assign(Object.assign({},um),t);try{var n=new vm(e),s=await Promise.race([r(),n.promise]),i=(n.clearNetworkTimeout(),await s.json());if("needConfirmation"in i)throw ym(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;var[o,a]=(s.ok?i.errorMessage:i.error.message).split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===o)throw ym(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===o)throw ym(e,"email-already-in-use",i);if("USER_DISABLED"===o)throw ym(e,"user-disabled",i);var l=t[o]||o.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw Zg(e,l,a);Yg(e,l)}catch(t){if(t instanceof rs)throw t;Yg(e,"network-request-failed",{message:String(t)})}}function mm(e,t,r,n){return t=""+t+r+"?"+n,e.config.emulator?hm(e.config,t):e.config.apiScheme+"://"+t}class vm{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Xg(this.auth,"network-request-failed"))),dm.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function ym(e,t,r){var n={appName:e.name};return(e=(r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber),Xg(e,t,n))).customData._tokenResponse=r,e}async function wm(e,t){return fm(e,"POST","/v1/accounts:lookup",t)}function bm(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function _m(e){return 1e3*Number(e)}function km(e){var[e,t,r]=e.split(".");if(void 0===e||void 0===t||void 0===r)return Jg("JWT malformed, contained fewer than 3 sections"),null;try{var n=qn(t);return n?JSON.parse(n):(Jg("Failed to decode base64 JWT payload"),null)}catch(e){return Jg("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function Em(e){return rm(e=km(e),"internal-error"),rm(void 0!==e.exp,"internal-error"),rm(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function Tm(e,t,r=!1){if(r)return t;try{return await t}catch(t){throw t instanceof rs&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class xm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId)&&clearTimeout(this.timerId)}getInterval(e){return e?(e=this.errorBackoff,this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e):(this.errorBackoff=3e4,e=(null!=(e=this.user.stsTokenManager.expirationTime)?e:0)-Date.now()-3e5,Math.max(0,e))}schedule(e=!1){this.isRunning&&(e=this.getInterval(e),this.timerId=setTimeout((async()=>{await this.iteration()}),e))}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Im{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=bm(this.lastLoginAt),this.creationTime=bm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Cm(e){var t=e.auth,r=await e.getIdToken(),n=(t=(rm(null==(r=await Tm(e,wm(t,{idToken:r})))?void 0:r.users.length,t,"internal-error"),r.users[0]),r=(e._notifyReloadListener(t),null!=(r=t.providerUserInfo)&&r.length?Sm(t.providerUserInfo):[]),r=function(e,t){return[...e.filter((e=>!t.some((t=>t.providerId===e.providerId)))),...t]}(e.providerData,r),e.isAnonymous),s=!(e.email&&t.passwordHash||null!=r&&r.length);n=!!n&&s,s={uid:t.localId,displayName:t.displayName||null,photoURL:t.photoUrl||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,tenantId:t.tenantId||null,providerData:r,metadata:new Im(t.createdAt,t.lastLoginAt),isAnonymous:n};Object.assign(e,s)}function Sm(e){return e.map((e=>({providerId:e.providerId,uid:(e=Hg(e,["providerId"])).rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null})))}class Am{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rm(e.idToken,"internal-error"),rm(void 0!==e.idToken,"internal-error"),rm(void 0!==e.refreshToken,"internal-error");var t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):Em(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){rm(0!==e.length,"internal-error");var t=Em(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(rm(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){var{accessToken:e,refreshToken:t,expiresIn:r}=await async function(e,t){var r=await gm(e,{},(async()=>{var r,n=as({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:r}=e.config,s=mm(e,s,"/v1/token","key="+r);return(r=await e._getAdditionalHeaders())["Content-Type"]="application/x-www-form-urlencoded",cm.fetch()(s,{method:"POST",headers:r,body:n})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}(e,t);this.updateTokensAndExpiration(e,t,Number(r))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){var{refreshToken:t,accessToken:r,expirationTime:n}=t,s=new Am;return t&&(rm("string"==typeof t,"internal-error",{appName:e}),s.refreshToken=t),r&&(rm("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),n&&(rm("number"==typeof n,"internal-error",{appName:e}),s.expirationTime=n),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Am,this.toJSON())}_performRefresh(){return nm("not implemented")}}function Rm(e,t){rm("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Nm{constructor(e){var{uid:t,auth:r,stsTokenManager:n}=e;e=Hg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=e.displayName||null,this.email=e.email||null,this.emailVerified=e.emailVerified||!1,this.phoneNumber=e.phoneNumber||null,this.photoURL=e.photoURL||null,this.isAnonymous=e.isAnonymous||!1,this.tenantId=e.tenantId||null,this.providerData=e.providerData?[...e.providerData]:[],this.metadata=new Im(e.createdAt||void 0,e.lastLoginAt||void 0)}async getIdToken(e){return rm(e=await Tm(this,this.stsTokenManager.getToken(this.auth,e)),this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(e){return async function(e,t=!1){e=cs(e);var r=km(t=await e.getIdToken(t)),n=null==(rm(r&&r.exp&&r.auth_time&&r.iat,e.auth,"internal-error"),e="object"==typeof r.firebase?r.firebase:void 0)?void 0:e.sign_in_provider;return{claims:r,token:t,authTime:bm(_m(r.auth_time)),issuedAtTime:bm(_m(r.iat)),expirationTime:bm(_m(r.exp)),signInProvider:n||null,signInSecondFactor:(null==e?void 0:e.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){e=cs(e),await Cm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(e){this!==e&&(rm(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return(e=new Nm(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))).metadata._copy(this.metadata),e}_onReload(e){rm(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Cm(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){var e;return Js(this.auth.app)?Promise.reject(em(this.auth)):(e=await this.getIdToken(),await Tm(this,async function(e,t){return fm(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut())}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r=null!=(r=t.displayName)?r:void 0,n=null!=(n=t.email)?n:void 0,s=null!=(s=t.phoneNumber)?s:void 0,i=null!=(i=t.photoURL)?i:void 0,o=null!=(o=t.tenantId)?o:void 0,a=null!=(a=t._redirectEventId)?a:void 0,l=null!=(l=t.createdAt)?l:void 0,h=null!=(h=t.lastLoginAt)?h:void 0,{uid:t,emailVerified:c,isAnonymous:u,providerData:d,stsTokenManager:p}=t,p=(rm(t&&p,e,"internal-error"),Am.fromJSON(this.name,p));rm("string"==typeof t,e,"internal-error"),Rm(r,e.name),Rm(n,e.name),rm("boolean"==typeof c,e,"internal-error"),rm("boolean"==typeof u,e,"internal-error"),Rm(s,e.name),Rm(i,e.name),Rm(o,e.name),Rm(a,e.name),Rm(l,e.name),Rm(h,e.name),t=new Nm({uid:t,auth:e,email:n,emailVerified:c,displayName:r,isAnonymous:u,photoURL:i,phoneNumber:s,tenantId:o,stsTokenManager:p,createdAt:l,lastLoginAt:h});return d&&Array.isArray(d)&&(t.providerData=d.map((e=>Object.assign({},e)))),a&&(t._redirectEventId=a),t}static async _fromIdTokenResponse(e,t,r=!1){var n=new Am;n.updateFromServerResponse(t),t=new Nm({uid:t.localId,auth:e,stsTokenManager:n,isAnonymous:r});return await Cm(t),t}static async _fromGetAccountInfoResponse(e,t,r){var n=(rm(void 0!==(t=t.users[0]).localId,"internal-error"),void 0!==t.providerUserInfo?Sm(t.providerUserInfo):[]),s=!(t.email&&t.passwordHash||null!=n&&n.length),i=new Am;i.updateFromIdToken(r),r=new Nm({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:s}),e={uid:t.localId,displayName:t.displayName||null,photoURL:t.photoUrl||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,tenantId:t.tenantId||null,providerData:n,metadata:new Im(t.createdAt,t.lastLoginAt),isAnonymous:!(t.email&&t.passwordHash||null!=n&&n.length)};return Object.assign(r,e),r}}const Om=new Map;function Pm(e){sm(e instanceof Function,"Expected a class definition");var t=Om.get(e);return t?sm(t instanceof e,"Instance stored in cache mismatched with class"):(t=new e,Om.set(e,t)),t}class Dm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){return void 0===(e=this.storage[e])?null:e}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Dm.type="NONE";const Lm=Dm;function Mm(e,t,r){return`firebase:${e}:${t}:`+r}class Um{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;var{config:e,name:r}=this.auth;this.fullUserKey=Mm(this.userKey,e.apiKey,r),this.fullPersistenceKey=Mm("persistence",e.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){var e=await this.persistence._get(this.fullUserKey);return e?Nm._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){var t;if(this.persistence!==e)return t=await this.getCurrentUser(),await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Um(Pm(Lm),e,r);var n=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=n[0]||Pm(Lm);const i=Mm(r,e.config.apiKey,e.name);let o=null;for(const r of t)try{var a=await r._get(i);if(a){var l=Nm._fromJSON(e,a);r!==s&&(o=l),s=r;break}}catch(e){}return n=n.filter((e=>e._shouldAllowMigration)),s._shouldAllowMigration&&n.length&&(s=n[0],o&&await s._set(i,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(i)}catch(e){}})))),new Um(s,e,r)}}function Fm(e){var t=e.toLowerCase();return t.includes("opera/")||t.includes("opr/")||t.includes("opios/")?"Opera":zm(t)?"IEMobile":t.includes("msie")||t.includes("trident/")?"IE":t.includes("edge/")?"Edge":jm(t)?"Firefox":t.includes("silk/")?"Silk":qm(t)?"Blackberry":Hm(t)?"Webos":Bm(t)?"Safari":!t.includes("chrome/")&&!Vm(t)||t.includes("edge/")?$m(t)?"Android":2===(null==(t=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))?void 0:t.length)?t[1]:"Other":"Chrome"}function jm(e=Zn()){return/firefox\//i.test(e)}function Bm(e=Zn()){return(e=e.toLowerCase()).includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Vm(e=Zn()){return/crios\//i.test(e)}function zm(e=Zn()){return/iemobile/i.test(e)}function $m(e=Zn()){return/android/i.test(e)}function qm(e=Zn()){return/blackberry/i.test(e)}function Hm(e=Zn()){return/webos/i.test(e)}function Gm(e=Zn()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Km(){return function(){var e=Zn();return 0<=e.indexOf("MSIE ")||0<=e.indexOf("Trident/")}()&&10===document.documentMode}function Wm(e=Zn()){return Gm(e)||$m(e)||Hm(e)||qm(e)||/windows phone/i.test(e)||zm(e)}function Qm(e,t=[]){let r;switch(e){case"Browser":r=Fm(Zn());break;case"Worker":r=Fm(Zn())+"-"+e;break;default:r=e}return t=t.length?t.join(","):"FirebaseCore-web",`${r}/JsCore/${Zs}/`+t}class Jm{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){var r=t=>new Promise(((r,n)=>{try{r(e(t))}catch(r){n(r)}}));r.onAbort=t,this.queue.push(r);const n=this.queue.length-1;return()=>{this.queue[n]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser!==e){var t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(e){t.reverse();for(const r of t)try{r()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}}class Ym{constructor(e){var t,r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!=(t=r.minPasswordLength)?t:6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!=(r=null==(t=e.allowedNonAlphanumericCharacters)?void 0:t.join(""))?r:"",this.forceUpgradeOnSignin=null!=(t=e.forceUpgradeOnSignin)&&t,this.schemaVersion=e.schemaVersion}validatePassword(e){var t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=null==(e=t.meetsMinPasswordLength)||e),t.isValid&&(t.isValid=null==(e=t.meetsMaxPasswordLength)||e),t.isValid&&(t.isValid=null==(e=t.containsLowercaseLetter)||e),t.isValid&&(t.isValid=null==(e=t.containsUppercaseLetter)||e),t.isValid&&(t.isValid=null==(e=t.containsNumericCharacter)||e),t.isValid&&(t.isValid=null==(e=t.containsNonAlphanumericCharacter)||e),t}validatePasswordLengthOptions(e,t){var r=this.customStrengthOptions.minPasswordLength,n=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),n&&(t.meetsMaxPasswordLength=e.length<=n)}validatePasswordCharacterOptions(e,t){var r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let n=0;n<e.length;n++)r=e.charAt(n),this.updatePasswordCharacterOptionsStatuses(t,"a"<=r&&r<="z","A"<=r&&r<="Z","0"<=r&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,n,s){this.customStrengthOptions.containsLowercaseLetter&&!e.containsLowercaseLetter&&(e.containsLowercaseLetter=t),this.customStrengthOptions.containsUppercaseLetter&&!e.containsUppercaseLetter&&(e.containsUppercaseLetter=r),this.customStrengthOptions.containsNumericCharacter&&!e.containsNumericCharacter&&(e.containsNumericCharacter=n),this.customStrengthOptions.containsNonAlphanumericCharacter&&!e.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter=s)}}class Xm{constructor(e,t,r,n){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ev(this),this.idTokenSubscription=new ev(this),this.beforeStateQueue=new Jm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wg,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Pm(t)),this._initializationPromise=this.queue((async()=>{var r;if(!this._deleted&&(this.persistenceManager=await Um.create(this,e),!this._deleted)){if(null!=(r=this._popupRedirectResolver)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null==(r=this.currentUser)?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){var e;!this._deleted&&(e=await this.assertedPersistence.getCurrentUser(),this.currentUser||e)&&(this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),await this.currentUser.getIdToken()):await this._updateCurrentUser(e,!0))}async initializeCurrentUserFromIdToken(e){try{var t=await wm(this,{idToken:e}),r=await Nm._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Js(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}var t,r,n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain&&(await this.getOrInitRedirectPersistenceManager(),t=null==(t=this.redirectUser)?void 0:t._redirectEventId,r=null==s?void 0:s._redirectEventId,e=await this.tryRedirectSignIn(e),t&&t!==r||null==e||!e.user||(s=e.user,i=!0)),!s)return this.directlySetCurrentUser(null);if(s._redirectEventId)return rm(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s);if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(e){s=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Cm(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){var e;return"undefined"!=typeof navigator&&((e=navigator).languages&&e.languages[0]||e.language)||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){return Js(this.app)?Promise.reject(em(this)):((e=e?cs(e):null)&&rm(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this)))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&rm(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Js(this.app)?Promise.reject(em(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Js(this.app)?Promise.reject(em(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Pm(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();var t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){var e=await async function(e,t={}){return fm(e,"GET","/v2/passwordPolicy",pm(e,t))}(this);e=new Ym(e);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ns("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged((()=>{r(),e()}),t)}}))}async revokeAccessToken(e){this.currentUser&&(e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()},null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(e,t){return fm(e,"POST","/v2/accounts:revokeToken",pm(e,t))}(this,e))}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null==(e=this._currentUser)?void 0:e.toJSON()}}async _setRedirectUser(e,t){return t=await this.getOrInitRedirectPersistenceManager(t),null===e?t.removeCurrentUser():t.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){return this.redirectPersistenceManager||(rm(e=e&&Pm(e)||this._popupRedirectResolver,this,"argument-error"),this.redirectPersistenceManager=await Um.create(this,[Pm(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()),this.redirectPersistenceManager}async _redirectUserForId(e){var t;return this._isInitialized&&await this.queue((async()=>{})),(null==(t=this._currentUser)?void 0:t._redirectEventId)===e?this._currentUser:(null==(t=this.redirectUser)?void 0:t._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:`+this.name}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e;this._isInitialized&&(this.idTokenSubscription.next(this.currentUser),e=null!=(e=null==(e=this.currentUser)?void 0:e.uid)?e:null,this.lastNotifiedUid!==e)&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,n){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let i=!1;var o=this._isInitialized?Promise.resolve():this._initializationPromise;if(rm(o,this,"internal-error"),o.then((()=>{i||s(this.currentUser)})),"function"==typeof t){const s=e.addObserver(t,r,n);return()=>{i=!0,s()}}{const r=e.addObserver(t);return()=>{i=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),(this.currentUser=e)?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rm(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e,t={"X-Client-Version":this.clientVersion};return(e=((e=(this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId),await(null==(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))?void 0:e.getHeartbeatsHeader())))&&(t["X-Firebase-Client"]=e),await this._getAppCheckToken()))&&(t["X-Firebase-AppCheck"]=e),t}async _getAppCheckToken(){var e=await(null==(e=this.appCheckServiceProvider.getImmediate({optional:!0}))?void 0:e.getToken());return null!=e&&e.error&&function(e,...t){Qg.logLevel<=vn.WARN&&Qg.warn(`Auth (${Zs}): `+e,...t)}("Error while retrieving App Check token: "+e.error),null==e?void 0:e.token}}function Zm(e){return cs(e)}class ev{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){return(e=new ls(e,t)).subscribe.bind(e)}((e=>this.observer=e))}get next(){return rm(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let tv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rv(e,t,r){rm((e=Zm(e))._canInitEmulator,e,"emulator-config-failed"),rm(/^https?:\/\//.test(t),e,"invalid-emulator-scheme"),r=!(null==r||!r.disableWarnings);var n=nv(t),{host:t,port:s}=function(e){var t=nv(e);e=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));return e?(t=e[2].split("@").pop()||"",(e=/^(\[[^\]]+\])(:|$)/.exec(t))?{host:e=e[1],port:sv(t.substr(e.length+1))}:([e,t]=t.split(":"),{host:e,port:sv(t)})):{host:"",port:null}}(t);e.config.emulator={url:n+`//${t}${null===s?"":":"+s}/`},e.settings.appVerificationDisabledForTesting=!0,e.emulatorConfig=Object.freeze({host:t,port:s,protocol:n.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function nv(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function sv(e){return!e||(e=Number(e),isNaN(e))?null:e}class iv{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return nm("not implemented")}_getIdTokenResponse(e){return nm("not implemented")}_linkToIdToken(e,t){return nm("not implemented")}_getReauthenticationResolver(e){return nm("not implemented")}}async function ov(e,t){return async function(e,t,r,n,s={}){return"mfaPendingCredential"in(t=await fm(e,t,r,n,s))&&Yg(e,"multi-factor-auth-required",{_serverResponse:t}),t}(e,"POST","/v1/accounts:signInWithIdp",pm(e,t))}class av extends iv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){var t=new av(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Yg("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){e="string"==typeof e?JSON.parse(e):e;var{providerId:t,signInMethod:r}=e;e=Hg(e,["providerId","signInMethod"]);return t&&r?((t=new av(t,r)).idToken=e.idToken||void 0,t.accessToken=e.accessToken||void 0,t.secret=e.secret,t.nonce=e.nonce,t.pendingToken=e.pendingToken||null,t):null}_getIdTokenResponse(e){return ov(e,this.buildRequest())}_linkToIdToken(e,t){var r=this.buildRequest();return r.idToken=t,ov(e,r)}_getReauthenticationResolver(e){var t=this.buildRequest();return t.autoCreate=!1,ov(e,t)}buildRequest(){var e,t={requestUri:"http://localhost",returnSecureToken:!0};return this.pendingToken?t.pendingToken=this.pendingToken:(e={},this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=as(e)),t}}class lv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class hv extends lv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class cv extends hv{constructor(){super("facebook.com")}static credential(e){return av._fromParams({providerId:cv.PROVIDER_ID,signInMethod:cv.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cv.credentialFromTaggedObject(e)}static credentialFromError(e){return cv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return cv.credential(e.oauthAccessToken)}catch(e){return null}}}cv.FACEBOOK_SIGN_IN_METHOD="facebook.com",cv.PROVIDER_ID="facebook.com";class uv extends hv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return av._fromParams({providerId:uv.PROVIDER_ID,signInMethod:uv.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return uv.credentialFromTaggedObject(e)}static credentialFromError(e){return uv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{oauthIdToken:e,oauthAccessToken:t}=e;if(!e&&!t)return null;try{return uv.credential(e,t)}catch(e){return null}}}uv.GOOGLE_SIGN_IN_METHOD="google.com",uv.PROVIDER_ID="google.com";class dv extends hv{constructor(){super("github.com")}static credential(e){return av._fromParams({providerId:dv.PROVIDER_ID,signInMethod:dv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return dv.credentialFromTaggedObject(e)}static credentialFromError(e){return dv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return dv.credential(e.oauthAccessToken)}catch(e){return null}}}dv.GITHUB_SIGN_IN_METHOD="github.com",dv.PROVIDER_ID="github.com";class pv extends hv{constructor(){super("twitter.com")}static credential(e,t){return av._fromParams({providerId:pv.PROVIDER_ID,signInMethod:pv.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return pv.credentialFromTaggedObject(e)}static credentialFromError(e){return pv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;var{oauthAccessToken:e,oauthTokenSecret:t}=e;if(!e||!t)return null;try{return pv.credential(e,t)}catch(e){return null}}}pv.TWITTER_SIGN_IN_METHOD="twitter.com",pv.PROVIDER_ID="twitter.com";class fv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,n=!1){return e=await Nm._fromIdTokenResponse(e,r,n),n=gv(r),new fv({user:e,providerId:n,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);var n=gv(r);return new fv({user:e,providerId:n,_tokenResponse:r,operationType:t})}}function gv(e){return e.providerId||("phoneNumber"in e?"phone":null)}class mv extends rs{constructor(e,t,r,n){super(t.code,t.message),this.operationType=r,this.user=n,Object.setPrototypeOf(this,mv.prototype),this.customData={appName:e.name,tenantId:null!=(n=e.tenantId)?n:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,n){return new mv(e,t,r,n)}}function vv(e,t,r,n){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch((r=>{if("auth/multi-factor-auth-required"===r.code)throw mv._fromErrorAndOperation(e,r,t,n);throw r}))}const yv="__sak";class wv{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yv,"1"),this.storage.removeItem(yv),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){return e=this.storage.getItem(e),Promise.resolve(e?JSON.parse(e):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class bv extends wv{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){var e=Zn();return Bm(e)||Gm(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=Wm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){var t=this.storage.getItem(n),r=this.localCache[n];t!==r&&e(n,r,t)}}onStorageEvent(e,t=!1){if(e.key){const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}var r=()=>{var e=this.storage.getItem(n);!t&&this.localCache[n]===e||this.notifyListeners(n,e)};const s=this.storage.getItem(n);Km()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}else this.forAllChangedKeys(((e,t,r)=>{this.notifyListeners(e,r)}))}notifyListeners(e,t){if(this.localCache[e]=t,e=this.listeners[e])for(const r of Array.from(e))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size)&&delete this.listeners[e],0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){var t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}bv.type="LOCAL";const _v=bv;class kv extends wv{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kv.type="SESSION";const Ev=kv;class Tv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){var t=this.receivers.find((t=>t.isListeningto(e)));return t||(t=new Tv(e),this.receivers.push(t),t)}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:n,data:s}=t.data;null!=(e=this.handlersMap[n])&&e.size&&(t.ports[0].postMessage({status:"ack",eventId:r,eventType:n}),e=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(Array.from(e).map((async e=>e(t.origin,s)))),t.ports[0].postMessage({status:"done",eventId:r,eventType:n,response:e}))}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function xv(e="",t=10){let r="";for(let e=0;e<t;e++)r+=Math.floor(10*Math.random());return e+r}Tv.receivers=[];class Iv{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const n="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!n)throw new Error("connection_unavailable");let s,i;return new Promise(((o,a)=>{const l=xv("",20),h=(n.port1.start(),setTimeout((()=>{a(new Error("unsupported_event"))}),r));i={messageChannel:n,onMessage(e){var t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(h),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(h),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(i),n.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[n.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function Cv(){return window}function Sv(){return void 0!==Cv().WorkerGlobalScope&&"function"==typeof Cv().importScripts}const Av="firebaseLocalStorageDb",Rv="firebaseLocalStorage",Nv="fbase_key";class Ov{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Pv(e,t){return e.transaction([Rv],t?"readwrite":"readonly").objectStore(Rv)}function Dv(){const e=indexedDB.open(Av,1);return new Promise(((t,r)=>{e.addEventListener("error",(()=>{r(e.error)})),e.addEventListener("upgradeneeded",(()=>{var t=e.result;try{t.createObjectStore(Rv,{keyPath:Nv})}catch(t){r(t)}})),e.addEventListener("success",(async()=>{var r=e.result;r.objectStoreNames.contains(Rv)?t(r):(r.close(),await function(){var e=indexedDB.deleteDatabase(Av);return new Ov(e).toPromise()}(),t(await Dv()))}))}))}async function Lv(e,t,r){return e=Pv(e,!0).put({[Nv]:t,value:r}),new Ov(e).toPromise()}function Mv(e,t){return e=Pv(e,!0).delete(t),new Ov(e).toPromise()}class Uv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Dv()),this.db}async _withRetries(e){let t=0;for(;;)try{return await e(await this._openDb())}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Sv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Tv._getInstance(Sv()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;this.activeServiceWorker=await async function(){if(null===navigator||void 0===navigator||!navigator.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),this.activeServiceWorker&&(this.sender=new Iv(this.activeServiceWorker),t=await this.sender._send("ping",{},800))&&null!=(e=t[0])&&e.fulfilled&&null!=(e=t[0])&&e.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null==(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{var e;return!!indexedDB&&(await Lv(e=await Dv(),yv,"1"),await Mv(e,yv),!0)}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((r=>Lv(r,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){var t=await this._withRetries((t=>async function(e,t){return e=Pv(e,!1).get(t),void 0===(t=await new Ov(e).toPromise())?null:t.value}(t,e)));return this.localCache[e]=t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Mv(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){var e=await this._withRetries((e=>(e=Pv(e,!1).getAll(),new Ov(e).toPromise())));if(!e)return[];if(0!==this.pendingWrites)return[];var t=[],r=new Set;if(0!==e.length)for(var{fbase_key:n,value:s}of e)r.add(n),JSON.stringify(this.localCache[n])!==JSON.stringify(s)&&(this.notifyListeners(n,s),t.push(n));for(const e of Object.keys(this.localCache))this.localCache[e]&&!r.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){if(this.localCache[e]=t,e=this.listeners[e])for(const r of Array.from(e))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size)&&delete this.listeners[e],0===Object.keys(this.listeners).length&&this.stopPolling()}}Uv.type="LOCAL";const Fv=Uv;new lm(3e4,6e4);class jv extends iv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ov(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ov(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ov(e,this._buildIdpRequest())}_buildIdpRequest(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Bv(e){return async function(e,t,r=!1){return Js(e.app)?Promise.reject(em(e)):(t=await vv(e,"signIn",t),t=await fv._fromIdTokenResponse(e,"signIn",t),r||await e._updateCurrentUser(t.user),t)}(e.auth,new jv(e),e.bypassAuthState)}function Vv(e){var{auth:t,user:r}=e;return rm(r,t,"internal-error"),async function(e,t,r=!1){var n=e.auth;if(Js(n.app))return Promise.reject(em(n));var s="reauthenticate";try{var i=await Tm(e,vv(n,s,t,e),r),o=(rm(i.idToken,n,"internal-error"),km(i.idToken)),a=(rm(o,n,"internal-error"),o).sub;return rm(e.uid===a,n,"user-mismatch"),fv._forOperation(e,s,i)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&Yg(n,"user-mismatch"),e}}(r,new jv(e),e.bypassAuthState)}async function zv(e){var{auth:t,user:r}=e;return rm(r,t,"internal-error"),async function(e,t,r=!1){return t=await Tm(e,t._linkToIdToken(e.auth,await e.getIdToken()),r),fv._forOperation(e,"link",t)}(r,new jv(e),e.bypassAuthState)}class $v{constructor(e,t,r,n,s=!1){this.auth=e,this.resolver=r,this.user=n,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){var{urlResponse:e,sessionId:t,postBody:r,tenantId:n,error:s,type:i}=e;if(s)this.reject(s);else{s={auth:this.auth,requestUri:e,sessionId:t,tenantId:n||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(s))}catch(e){this.reject(e)}}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Bv;case"linkViaPopup":case"linkViaRedirect":return zv;case"reauthViaPopup":case"reauthViaRedirect":return Vv;default:Yg(this.auth,"internal-error")}}resolve(e){sm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){sm(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const qv=new lm(2e3,1e4);class Hv extends $v{constructor(e,t,r,n,s){super(e,t,n,s),this.provider=r,this.authWindow=null,this.pollId=null,Hv.currentPopupAction&&Hv.currentPopupAction.cancel(),Hv.currentPopupAction=this}async executeNotNull(){var e=await this.execute();return rm(e,this.auth,"internal-error"),e}async onExecution(){sm(1===this.filter.length,"Popup operations only handle one event");var e=xv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Xg(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null==(e=this.authWindow)?void 0:e.associatedEvent)||null}cancel(){this.reject(Xg(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hv.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!=(t=null==(t=this.authWindow)?void 0:t.window)&&t.closed?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Xg(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,qv.get())};e()}}Hv.currentPopupAction=null;const Gv="pendingRedirect",Kv=new Map;class Wv extends $v{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Kv.get(this.auth._key());if(!e){try{const t=await async function(e,t){var r;t=function(e){return Mm(Gv,e.config.apiKey,e.name)}(t),e=function(e){return Pm(e._redirectPersistence)}(e);return!!await e._isAvailable()&&(r="true"===await e._get(t),await e._remove(t),r)}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Kv.set(this.auth._key(),e)}return this.bypassAuthState||Kv.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type)this.resolve(null);else if(e.eventId){var t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}function Qv(e,t){Kv.set(e._key(),t)}async function Jv(e,t,r=!1){var n;return Js(e.app)?Promise.reject(em(e)):(n=function(e,t){return t?Pm(t):(rm(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(e=Zm(e),t),(n=await new Wv(e,n,r).execute())&&!r&&(delete n.user._redirectEventId,await e._persistUserIfCurrent(n.user),await e._setRedirectUser(null,t)),n)}class Yv{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zv(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t)||(this.queuedRedirectEvent=e,t=!0),t}sendToConsumer(e,t){var r;e.error&&!Zv(e)?(r=(null==(r=e.error.code)?void 0:r.split("auth/")[1])||"internal-error",t.onError(Xg(this.auth,r))):t.onAuthEvent(e)}isEventForConsumer(e,t){var r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xv(e))}saveEventToCache(e){this.cachedEventUids.add(Xv(e)),this.lastProcessedEventTime=Date.now()}}function Xv(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Zv({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const ey=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ty=/^https?/;async function ry(e){if(!e.config.emulator){var t=(await async function(e,t={}){return fm(e,"GET","/v1/projects",t)}(e)).authorizedDomains;for(const r of t)try{if(ny(r))return}catch(e){}Yg(e,"unauthorized-domain")}}function ny(e){var t,r=im(),{protocol:n,hostname:s}=new URL(r);return e.startsWith("chrome-extension://")?""===(t=new URL(e)).hostname&&""===s?"chrome-extension:"===n&&e.replace("chrome-extension://","")===r.replace("chrome-extension://",""):"chrome-extension:"===n&&t.hostname===s:!!ty.test(n)&&(ey.test(e)?s===e:(r=e.replace(/\./g,"\\."),new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)))}const sy=new lm(3e4,6e4);function iy(){var e=Cv().___jsl;if(null!=e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function oy(e){return new Promise(((t,r)=>{var n;function s(){iy(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{iy(),r(Xg(e,"network-request-failed"))},timeout:sy.get()})}if(null!=(n=null==(n=Cv().gapi)?void 0:n.iframes)&&n.Iframe)t(gapi.iframes.getContext());else{if(null==(n=Cv().gapi)||!n.load)return n=function(e){return"__"+e+Math.floor(1e6*Math.random())}("iframefcb"),Cv()[n]=()=>{gapi.load?s():r(Xg(e,"network-request-failed"))},function(e){return tv.loadJS(e)}(tv.gapiScript+"?onload="+n).catch((e=>r(e)));s()}})).catch((e=>{throw ay=null,e}))}let ay=null;const ly=new lm(5e3,15e3),hy="__/auth/iframe",cy="emulator/auth/iframe",uy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},dy=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function py(e){var t,r=(rm((n=e.config).authDomain,e,"auth-domain-config-required"),n.emulator?hm(n,cy):`https://${e.config.authDomain}/`+hy),n={apiKey:n.apiKey,appName:e.name,v:Zs};return(t=((t=dy.get(e.config.apiHost))&&(n.eid=t),e._getFrameworks())).length&&(n.fw=t.join(",")),r+"?"+as(n).slice(1)}async function fy(e){var t=await function(e){return ay=ay||oy(e)}(e),r=Cv().gapi;return rm(r,e,"internal-error"),t.open({where:document.body,url:py(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:uy,dontclear:!0},(t=>new Promise((async(r,n)=>{await t.restyle({setHideOnLeave:!1});const s=Xg(e,"network-request-failed"),i=Cv().setTimeout((()=>{n(s)}),ly.get());function o(){Cv().clearTimeout(i),r(t)}t.ping(o).then(o,(()=>{n(s)}))}))))}const gy={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class my{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function vy(e,t,r,n=500,s=600){var i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";if(n=Object.assign(Object.assign({},gy),{width:n.toString(),height:s.toString(),top:i,left:o}),s=Zn().toLowerCase(),r&&(a=Vm(s)?"_blank":r),jm(s)&&(t=t||"http://localhost",n.scrollbars="yes"),i=Object.entries(n).reduce(((e,[t,r])=>""+e+t+`=${r},`),""),function(e=Zn()){return Gm(e)&&!(null==(e=window.navigator)||!e.standalone)}(s)&&"_self"!==a)return function(e,t){var r=document.createElement("a");r.href=e,r.target=t,e=document.createEvent("MouseEvent");e.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(e)}(t||"",a),new my(null);rm(o=window.open(t||"",a,i),e,"popup-blocked");try{o.focus()}catch(e){}return new my(o)}const yy="__/auth/handler",wy="emulator/auth/handler",by=encodeURIComponent("fac");async function _y(e,t,r,n,s,i){rm(e.config.authDomain,e,"auth-domain-config-required"),rm(e.config.apiKey,e,"invalid-api-key");var o={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:n,v:Zs,eventId:s};if(t instanceof lv)for(var[a,l]of(t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(i||{})))o[a]=l;t instanceof hv&&0<(r=t.getScopes().filter((e=>""!==e))).length&&(o.scopes=r.join(",")),e.tenantId&&(o.tid=e.tenantId);var h=o;for(const e of Object.keys(h))void 0===h[e]&&delete h[e];return s=(n=await e._getAppCheckToken())?`#${by}=`+encodeURIComponent(n):"",function({config:e}){return e.emulator?hm(e,wy):`https://${e.authDomain}/`+yy}(e)+"?"+as(h).slice(1)+s}const ky="webStorageSupport";const Ey=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ev,this._completeRedirectFn=Jv,this._overrideRedirectResult=Qv}async _openPopup(e,t,r,n){sm(null==(s=this.eventManagers[e._key()])?void 0:s.manager,"_initialize() not called before _openPopup()");var s=await _y(e,t,r,im(),n);return vy(e,s,xv())}async _openRedirect(e,t,r,n){return await this._originValidation(e),function(e){Cv().location.href=e}(await _y(e,t,r,im(),n)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:r}=this.eventManagers[t];return e?Promise.resolve(e):(sm(r,"If manager is not set, promise should be"),r)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch((()=>{delete this.eventManagers[t]})),r}async initAndGetManager(e){var t=await fy(e);const r=new Yv(e);return t.register("authEvent",(t=>(rm(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:r.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ky,{type:ky},(r=>{void 0!==(r=null==(r=null==r?void 0:r[0])?void 0:r[ky])&&t(!!r),Yg(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ry(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Wm()||Bm()||Gm()}};var Ty,xy,Iy="@firebase/auth",Cy="1.7.1";class Sy{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null==(e=this.auth.currentUser)?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){var t;this.assertAuthConfigured(),this.internalListeners.has(e)||(t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)})),this.internalListeners.set(e,t),this.updateProactiveRefresh())}removeAuthTokenListener(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){rm(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){0<this.internalListeners.size?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ay=Jn("authIdTokenMaxAge")||300;let Ry=null;function Ny(e=ti()){var t=Qs(e,"auth");if(t.isInitialized())return t.getImmediate();const r=function(e,t){if((e=Qs(e,"auth")).isInitialized()){const r=e.getImmediate();if(is(e.getOptions(),null!=t?t:{}))return r;Yg(r,"already-initialized")}return e.initialize({options:t})}(e,{popupRedirectResolver:Ey,persistence:[Fv,_v,Ev]});if((t=Jn("authTokenSyncURL"))&&"boolean"==typeof isSecureContext&&isSecureContext&&(e=new URL(t,location.origin),location.origin===e.origin)){const t=(e=>async t=>{var r=(t=t&&await t.getIdTokenResult())&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;r&&r>Ay||(r=null==t?void 0:t.token,Ry!==r&&(Ry=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer "+r}:{}})))})(e.toString());(function(e,t,r){cs(e).beforeAuthStateChanged(t,r)})(r,t,(()=>t(r.currentUser))),function(e,t,r,n){cs(e).onIdTokenChanged(t,r,n)}(r,(e=>t(e)))}return(t=Kn("auth"))&&rv(r,"http://"+t),r}var Oy;(function(e){tv=e})({loadJS:e=>new Promise(((t,r)=>{var n=document.createElement("script");n.setAttribute("src",e),n.onload=t,n.onerror=e=>{var t=Xg("internal-error");t.customData=e,r(t)},n.type="text/javascript",n.charset="UTF-8",function(){var e;return null!=(e=null==(e=document.getElementsByTagName("head"))?void 0:e[0])?e:document}().appendChild(n)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Oy="Browser",Ws(new us("auth",((e,{options:t})=>{var r,n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),{apiKey:i,authDomain:r}=(e=e.getProvider("app-check-internal"),n.options),i=(rm(i&&!i.includes(":"),"invalid-api-key",{appName:n.name}),{apiKey:i,authDomain:r,clientPlatform:Oy,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qm(Oy)});return function(e,t){var r=(null==t?void 0:t.persistence)||[];r=(Array.isArray(r)?r:[r]).map(Pm),null!=t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(r=new Xm(n,s,e,i),t),r}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,r)=>{e.getProvider("auth-internal").initialize()}))),Ws(new us("auth-internal",(e=>(e=Zm(e.getProvider("auth").getImmediate()),new Sy(e))),"PRIVATE").setInstantiationMode("EXPLICIT")),ri(Iy,Cy,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Oy)),ri(Iy,Cy,"esm2017");const Py="firebasestorage.googleapis.com";class Dy extends rs{constructor(e,t,r=0){super(Ly(e),`Firebase Storage: ${t} (${Ly(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Dy.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ly(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage}}function Ly(e){return"storage/"+e}function My(){return new Dy(Ty.CANCELED,"User canceled the upload/download.")}function Uy(e){return new Dy(Ty.INVALID_ARGUMENT,e)}function Fy(){return new Dy(Ty.APP_DELETED,"The Firebase app was deleted.")}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Ty=Ty||{});class jy{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=jy.makeFromUrl(e,t)}catch(t){return new jy(e,"")}if(""===r.path)return r;throw function(e){return new Dy(Ty.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}(e)}static makeFromUrl(e,t){let r=null;var n="([A-Za-z0-9.\\-_]+)",s=new RegExp("^gs://"+n+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}var o=t.replace(/[.]/g,"\\."),a=(o=new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${n}/o(/([^?#]*).*)?$`,"i"),t=t===Py?"(?:storage.googleapis.com|storage.cloud.google.com)":t,[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:o,indices:{bucket:1,path:3},postModify:i},{regex:new RegExp(`^https?://${t}/${n}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:i}]);for(let t=0;t<a.length;t++){var l=a[t],h=l.regex.exec(e);if(h){var c=h[l.indices.bucket];let e=h[l.indices.path];e=e||"",r=new jy(c,e),l.postModify(r);break}}if(null==r)throw function(e){return new Dy(Ty.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return r}}class By{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=0){}}function Vy(e,t,r,n){if(n<t)throw Uy(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r<n)throw Uy(`Invalid value for '${e}'. Expected ${r} or less.`)}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(xy=xy||{});class zy{constructor(e,t,r,n,s,i,o,a,l,h,c,u=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=n,this.successCodes_=s,this.additionalRetryCodes_=i,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=h,this.connectionFactory_=c,this.retry=u,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){var e=(e,t)=>{var r=this.resolve_,n=this.reject_,s=t.connection;if(t.wasSuccessCode)try{var i=this.callback_(s,s.getResponse());!function(e){return void 0!==e}(i)?r():r(i)}catch(e){n(e)}else null!==s?((i=new Dy(Ty.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")).serverResponse=s.getErrorText(),this.errorCallback_?n(this.errorCallback_(s,i)):n(i)):t.canceled?n((this.appDelete_?Fy:My)()):n(new Dy(Ty.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))};this.canceled_?e(0,new $y(!1,null,!0)):this.backoffId_=function(e,t,r){let n=1,s=null,i=null,o=!1,a=0;function l(){return 2===a}let h=!1;function c(...e){h||(h=!0,t.apply(null,e))}function u(t){s=setTimeout((()=>{s=null,e(p,l())}),t)}function d(){i&&clearTimeout(i)}function p(e,...t){if(h)d();else if(e)d(),c.call(null,e,...t);else if(l()||o)d(),c.call(null,e,...t);else{let e;n<64&&(n*=2),u(e=1===a?(a=2,0):1e3*(n+Math.random()))}}let f=!1;function g(e){f||(f=!0,d(),h)||(null!==s?(e||(a=2),clearTimeout(s),u(0)):e||(a=1))}return u(0),i=setTimeout((()=>{g(o=!0)}),r),g}(((e,t)=>{if(t)e(!1,new $y(!1,null,!0));else{const t=this.connectionFactory_(),r=(this.pendingConnection_=t,e=>{var t=e.loaded;e=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,e)});null!==this.progressCallback_&&t.addUploadProgressListener(r),t.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&t.removeUploadProgressListener(r),this.pendingConnection_=null;var n=t.getErrorCode()===xy.NO_ERROR,s=t.getStatus();!n||function(e,t){var r=500<=e&&e<600,n=-1!==[408,429].indexOf(e);return t=-1!==t.indexOf(e),r||n||t}(s,this.additionalRetryCodes_)&&this.retry?(n=t.getErrorCode()===xy.ABORT,e(!1,new $y(!1,null,n))):(n=-1!==this.successCodes_.indexOf(s),e(!0,new $y(n,t)))}))}}),e,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class $y{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function qy(e,t,r,n,s,i,o=!0){var a=function(e){var t=encodeURIComponent;let r="?";for(const n in e)e.hasOwnProperty(n)&&(r=r+(t(n)+"=")+t(e[n])+"&");return r.slice(0,-1)}(e.urlParams),l=(a=e.url+a,Object.assign({},e.headers));return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&0<t.length&&(e.Authorization="Firebase "+t)}(l,r),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(l,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,n),new zy(a,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,o)}class Hy{constructor(e,t){this._service=e,this._location=t instanceof jy?t:jy.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Hy(e,t)}get root(){var e=new jy(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}(this._location.path)}get storage(){return this._service}get parent(){var e=function(e){var t;return 0===e.length?null:-1===(t=e.lastIndexOf("/"))?"":e.slice(0,t)}(this._location.path);return null===e?null:(e=new jy(this._location.bucket,e),new Hy(this._service,e))}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Dy(Ty.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Gy(e,t){return null==(t=null==t?void 0:t.storageBucket)?null:jy.makeFromBucketSpec(t,e)}class Ky{constructor(e,t,r,n,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=n,this._firebaseVersion=s,this._bucket=null,this._host=Py,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=n?jy.makeFromBucketSpec(n,this._host):Gy(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=jy.makeFromBucketSpec(this._url,e):this._bucket=Gy(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Vy("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Vy("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;var e=this._authProvider.getImmediate({optional:!0});return e&&null!==(e=await e.getToken())?e.accessToken:null}async _getAppCheckToken(){var e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Hy(this,e)}_makeRequest(e,t,r,n,s=!0){if(this._deleted)return new By(Fy());{const i=qy(e,this._appId,r,n,t,this._firebaseVersion,s);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(e,t){var[r,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,n).getPromise()}}const Wy="@firebase/storage",Qy="0.12.4",Jy="storage";function Yy(e,{instanceIdentifier:t}){var r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal");e=e.getProvider("app-check-internal");return new Ky(r,n,e,t,Zs)}Ws(new us(Jy,Yy,"PUBLIC").setMultipleInstances(!0)),ri(Wy,Qy,""),ri(Wy,Qy,"esm2017");const Xy=ne('<div class="job-bubble"><div class="job-message"><p>'),Zy=ne('<div class="job-bubble"><div class="job-listings">'),ew=ne('<a href="https://www.linkedin.com/jobs/" target="_blank" rel="noopener noreferrer"><div class="job-card-wrapper"><div class="job-card"><h2></h2><p>Company: </p><p>Wage: '),tw=ne('<div class="choice-buttons-row"><button class="ai-setting">Regular Chat</button><button class="ai-setting">Job Search'),rw=ne('<div class="api-data-container"><div class="card-container">'),nw=ne('<div class="w-full flex flex-row flex-wrap px-5 py-[10px] gap-2">'),sw=ne('<div class="loading-jobs-message-container">Loading Opportunities...'),iw=ne('<div class="w-full flex items-center justify-start gap-2 px-5 pt-2 border-t border-[#eeeeee]">'),ow=ne('<div><div class="flex flex-col w-full h-full justify-start z-0"><div class="overflow-y-scroll flex flex-col flex-grow min-w-full w-full px-3 pt-[70px] relative scrollable-container chatbot-chat-view scroll-smooth"></div><div class="w-full px-5 pt-2 pb-1">'),aw=ne('<div class="absolute top-0 left-0 bottom-0 right-0 w-full h-full z-50">'),lw=ne('<div class="absolute top-0 left-0 bottom-0 right-0 flex flex-col items-center justify-center bg-black/60 backdrop-blur-sm text-white z-40 gap-2 border-2 border-dashed"><h2 class="text-xl font-semibold">Drop here to upload'),hw=ne("<span>"),cw=ne("<span>Max Allowed Size: <!> MB"),uw=ne("<div>"),dw=ne('<span class="px-3 whitespace-pre-wrap font-semibold max-w-full">'),pw=ne("<span>Clear"),fw=ne('<div class="flex flex-row items-center w-full h-[50px] absolute top-0 left-0 z-10"><div>'),gw=ne('<a href="https://www.indeed.com/" target="_blank" rel="noopener noreferrer"><div class="job-card-wrapper"> <div class="job-card"><h2></h2><p>Company: </p><p>Wage: '),mw=ne('<button class="group w-12 h-12 flex items-center justify-center relative rounded-[10px] overflow-hidden transition-colors duration-200"><img class="w-full h-full bg-cover"><span class="absolute hidden group-hover:flex items-center justify-center z-10 w-full h-full top-0 left-0 bg-black/10 rounded-[10px] transition-colors duration-200">'),vw=ne('<div class="inline-flex basis-auto flex-grow-0 flex-shrink-0 justify-between items-center rounded-xl h-12 p-1 mr-1 bg-gray-500"><audio class="block bg-cover bg-center w-full h-full rounded-none text-transparent" controls></audio><button class="w-7 h-7 flex items-center justify-center bg-transparent p-1">'),yw=ne('<div class="w-full flex items-center justify-between p-4 border border-[#eeeeee]"><div class="w-full flex items-center justify-between gap-3"><span class="text-base">To record audio, use modern browsers like Chrome or Firefox that support audio recording.</span><button class="py-2 px-4 justify-center flex items-center bg-red-500 text-white rounded-md" type="button">Okay'),ww=ne("<span>Send"),bw=ne('<div class="h-[58px] flex items-center justify-between chatbot-input border border-[#eeeeee]" data-testid="input"><div class="flex items-center gap-3 px-4 py-2"><span></span><span></span></div><div class="flex items-center">'),_w=ne('<span class="ml-1.5">Sending...'),kw=ei({apiKey:"AIzaSyDx9f_iIwwM5wouSTT3QntFlwHcbNEqirA",authDomain:"conectado-33186.firebaseapp.com",projectId:"conectado-33186",storageBucket:"conectado-33186.appspot.com",messagingSenderId:"239868035366",appId:"1:239868035366:web:62488feeeb1231890481e7",measurementId:"G-902KJ2QKXM"}),Ew=function(e,t){return t="string"==typeof e?e:t||"(default)",(e=Qs("object"==typeof e?e:ti(),"firestore").getImmediate({identifier:t}))._initialized||(t=Wn("firestore"))&&function(e,t,r,n={}){const s=(e=_g(e,Eg))._getSettings(),i=t+":"+r;if("firestore.googleapis.com"!==s.host&&s.host!==i&&Bh("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:i,ssl:!1})),n.mockUserToken){let r,s;if("string"==typeof n.mockUserToken)r=n.mockUserToken,s=Dh.MOCK_USER;else{r=Xn(n.mockUserToken,null==(t=e._app)?void 0:t.options.projectId);const i=n.mockUserToken.sub||n.mockUserToken.user_id;if(!i)throw new Gh(Hh.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new Dh(i)}e._authCredentials=new Jh(new Wh(r,s))}}(e,...t),e}(kw),Tw=(function(e=ti(),t){e=Qs(e=cs(e),Jy).getImmediate({identifier:t}),(t=Wn("storage"))&&function(e,t,r,n={}){!function(e,t,r,n={}){e.host=t+":"+r,e._protocol="http",(t=n.mockUserToken)&&(e._overrideAuthToken="string"==typeof t?t:Xn(t,e.app.options.projectId))}(e,t,r,n)}(e,...t)}(kw),Ny(kw)),xw=(function(e,t){cs(e).setPersistence(t)}(Tw,_v),"Need career assistance? Ask me anything!");async function Iw(e){return e=await(await fetch("http://localhost:3000/api/v1/prediction/a32245d2-2b55-4580-bd33-b4e046a07c84",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json(),console.log("Jobs",e),e}const Cw=e=>{const[t,r]=_(null),[n,s]=_("9d890834-eb87-4909-930f-d420fa53a52a"),[i,o]=_(!1),[a,l]=_(""),h=(console.log("User ID:",e.userID),E((async()=>{var e=Ny().currentUser;if(e)try{var t=await $g(Cg(Ew,"Users",e.uid));t.exists()&&t.data().career?(console.log("Career found:",t.data().cateerField),console.log("User:",t.data()),l(t.data().careerField)):console.log("No such document or career not set!")}catch(e){console.error("Error getting document:",e)}else console.log("User not logged in!")})),E((async()=>{if(a()){o(!0);try{var e=await Iw({question:a()}),n=JSON.parse(e.text);r({...e,jobs:n}),console.log("Parsed jobs:",n),console.log("API data:",t())}catch(e){console.error("Error fetching data:",e)}finally{o(!1)}}})),G({showTitle:!0},e));let c,u;const[d,p]=_(""),[f,g]=_(!1),[m,v]=_(!1),[y,w]=_({}),[b,C]=_([{message:"Input a job title to search for opportunities.",type:"apiMessage",jobs:[]}]),[S,A]=_([{message:"Hello! I am G-AI, your personal assistant. How can I help you today?",type:"apiMessage"}],{equals:!1}),[R,N]=_(""),[O,P]=_(!1),[D,L]=_(Le()),[M,U]=_([],{equals:!1}),[F,j]=_(),[B,V]=_([]),[$,q]=_("00:00"),[H,K]=_(!1),[J,Y]=_(!1),[X,Z]=_(!1),[ee,te]=_(!1),re=(I((()=>{if(e?.observersConfig){const{observeUserInput:t,observeLoading:r,observeMessages:n}=e.observersConfig;"function"==typeof t&&T((()=>{t(d())})),"function"==typeof r&&T((()=>{r(f())})),"function"==typeof n&&T((()=>{n(S())}))}})),()=>{setTimeout((()=>{c?.scrollTo(0,c.scrollHeight)}),50)}),ne=e=>{localStorage.setItem(h.chatflowid+"_EXTERNAL",JSON.stringify({chatId:D(),chatHistory:e}))},se=(e,t,r)=>{A((n=>{var s=n.map(((s,i)=>i===n.length-1?{...s,message:s.message+e,sourceDocuments:t,fileAnnotations:r}:s));return ne(s),[...s]}))},ae=e=>{A((t=>{var r=t.map(((r,n)=>n===t.length-1?{...r,sourceDocuments:e}:r));return ne(r),[...r]}))},ce=(e="Oops! There seems to be an error. Please try again.")=>{A((t=>(t=[...t,{message:e,type:"apiMessage"}],ne(t),t))),g(!1),p(""),re()},ue=e=>{pe(e)},de=e=>z(Q,{get when(){return"a32245d2-2b55-4580-bd33-b4e046a07c84"==n()},get children(){return[(he((t=Xy()).firstChild.firstChild,(()=>e.jobMessage.message)),t),z(Q,{get when(){return 0<e.jobMessage.jobs.length},get children(){var t=Zy();return he(t.firstChild,z(W,{get each(){return e.jobMessage.jobs},children:e=>{return(n=(r=(t=ew()).firstChild.firstChild.firstChild).nextSibling).firstChild,(s=n.nextSibling).firstChild,he(r,(()=>e.title)),he(n,(()=>e.company),null),he(s,(()=>e.wage),null),t;var t,r,n,s}})),t}})];var t}}),pe=async e=>{if(p(e),""===e.trim()){var t=0<B().filter((e=>"audio"===e.type)).length;if(!(1<=B().length&&t))return void g(!1)}if(g(!0),re(),"a32245d2-2b55-4580-bd33-b4e046a07c84"===n())(async e=>{o(!0);try{var t=await Iw({question:e}),r=JSON.parse(t.text);const n={message:(console.log("parsedjobs before",r),0<r.length?"Here are the job listings related to: "+e:"No job listings found."),type:"apiMessage",jobs:r};r&&0<r.length?(C((e=>[...e,n])),console.log("parsedjobs after",r)):C((e=>[...e,{message:"No job listings found for your query.",type:"apiMessage",jobs:[]}]))}catch(e){console.error("Error fetching job listings:",e),ce("Failed to fetch job listings. Please try again.")}finally{g(!1),o(!1),p(""),re()}})(e);else{const s=h.welcomeMessage??xw;t=S().filter((e=>e.message!==s));const i=B().map((e=>({data:e.data,type:e.type,name:e.name,mime:e.mime})));B().forEach((e=>URL.revokeObjectURL(e.preview))),V([]),A((t=>[...t,{message:e,type:"userMessage",fileUploads:i}])),t={question:e,history:t,chatId:D(),uploads:i,overrideConfig:h.chatflowConfig,socketIOClientId:O()?R():void 0};try{var r=await(({chatflowid:e,apiHost:t="http://localhost:3000",body:r})=>Ee({method:"POST",url:t+"/api/v1/prediction/"+e,body:r}))({chatflowid:n(),apiHost:h.apiHost,body:t});r.data&&(e=>{e.text||(console.error("API response didn't include expected 'text' field:",e),A((e=>[...e,{message:"Sorry, I didn't understand that. Can you try rephrasing?",type:"apiMessage"}]))),re()})(r.data)}catch(t){console.error("An unexpected error occurred:",t),ce("An unexpected error occurred. Please try again.")}finally{g(!1),p("")}}},fe=()=>{try{localStorage.removeItem(h.chatflowid+"_EXTERNAL"),L(Le()),A([{message:h.welcomeMessage??xw,type:"apiMessage"}])}catch(t){var e=t.response.data||t.response.status+": "+t.response.statusText;console.error("error: "+e)}},ge=(E((()=>{S()&&re()})),E((()=>{h.fontSize&&u&&(u.style.fontSize=h.fontSize+"px")})),E((async()=>{var e=((e=localStorage.getItem(h.chatflowid+"_EXTERNAL"))&&(e=JSON.parse(e),L(e.chatId),e=e.chatHistory.map((e=>{var t={message:e.message,type:e.type};return e.sourceDocuments&&(t.sourceDocuments=e.sourceDocuments),e.fileAnnotations&&(t.fileAnnotations=e.fileAnnotations),e.fileUploads&&(t.fileUploads=e.fileUploads),t})),A([...e])),await(({chatflowid:e,apiHost:t="http://localhost:3000"})=>Ee({method:"GET",url:t+"/api/v1/chatflows-streaming/"+e}))({chatflowid:h.chatflowid,apiHost:h.apiHost})).data;e&&P(e?.isStreaming??!1),e=await(({chatflowid:e,apiHost:t="http://localhost:3000"})=>Ee({method:"GET",url:t+"/api/v1/public-chatbotConfig/"+e}))({chatflowid:h.chatflowid,apiHost:h.apiHost});if(e.data){const t=e.data;if(t.starterPrompts){const e=[];Object.getOwnPropertyNames(t.starterPrompts).forEach((r=>{e.push(t.starterPrompts[r].prompt)})),U(e)}t.uploads&&j(t.uploads)}const t=xn(h.apiHost);return t.on("connect",(()=>{N(t.id)})),t.on("start",(()=>{A((e=>[...e,{message:"",type:"apiMessage"}]))})),t.on("sourceDocuments",ae),t.on("token",se),()=>{p(""),g(!1),A([{message:"I'm sorry, I'm having trouble connecting to the server. Please try again later.",type:"apiMessage"}]),t&&(t.disconnect(),N(""))}})),e=>{try{return new URL(e)}catch(e){}}),me=e=>{const t=e.type.substring(0,e.type.indexOf(";")),r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{const e={data:r.result,preview:"../assets/wave-sound.jpg",type:"audio",name:"audio.wav",mime:t};V((t=>[...t,e]))}},ve=e=>{let t=!1;if(F()&&F()?.isImageUploadAllowed&&F()?.imgUploadSizeAndTypes){const r=e.type,n=e.size/1024/1024;F()?.imgUploadSizeAndTypes.map((e=>{e.fileTypes.includes(r)&&n<=e.maxUploadSize&&(t=!0)}))}return t||alert("Cannot upload file. Kindly check the allowed file types and maximum allowed size."),t},ye=async e=>{if((e=e.target.files)&&0!==e.length){var t=[];for(const r of e){if(!1===ve(r))return;const e=new FileReader,n=r.name;t.push(new Promise((t=>{e.onload=e=>{e?.target?.result&&(e=e.target.result,t({data:e,preview:URL.createObjectURL(r),type:"file",name:n,mime:r.type}))},e.readAsDataURL(r)})))}const r=await Promise.all(t);V((e=>[...e,...r]))}},we=e=>{F()?.isImageUploadAllowed&&(e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?te(!0):"dragleave"===e.type&&te(!1))},be=async e=>{if(F()?.isImageUploadAllowed){e.preventDefault(),te(!1);var t=[];if(e.dataTransfer&&0<e.dataTransfer.files.length){for(const r of e.dataTransfer.files){if(!1===ve(r))return;const e=new FileReader,n=r.name;t.push(new Promise((t=>{e.onload=e=>{if(e?.target?.result){let s;e=e.target.result,r.type.startsWith("audio/")?s="../assets/wave-sound.jpg":r.type.startsWith("image/")&&(s=URL.createObjectURL(r)),t({data:e,preview:s,type:"file",name:n,mime:r.type})}},e.readAsDataURL(r)})))}const r=await Promise.all(t);V((e=>[...e,...r]))}if(e.dataTransfer&&e.dataTransfer.items)for(const t of e.dataTransfer.items)"string"===t.kind&&t.type.match("^text/uri-list")?t.getAsString((e=>{const t={data:e,preview:e,type:"url",name:e.substring(e.lastIndexOf("/")+1),mime:""};V((e=>[...e,t]))})):"string"===t.kind&&t.type.match("^text/html")&&t.getAsString((e=>{if(-1!==e.indexOf("href")){const t={data:e=(e=e.substring(e.indexOf("href")+6)).substring(0,e.indexOf('"')),preview:e,type:"url",name:e.substring(e.lastIndexOf("/")+1),mime:""};V((e=>[...e,t]))}}))}},_e=e=>{"file"===e.type&&URL.revokeObjectURL(e.preview),V(B().filter((t=>t!==e)))},ke=()=>{K(!0),Mn(K,Y,q)},Te=()=>{J||(jn.cancel(),clearInterval(Ln)),K(!1),Y(!1)},xe=async()=>{Z(!0),Un(me)};return E(function(e,t,r){const n=Array.isArray(e);let s,i=r&&r.defer;return r=>{let o;if(n){o=Array(e.length);for(let t=0;t<e.length;t++)o[t]=e[t]()}else o=e();var a;if(!i)return a=x((()=>t(o,s,r))),s=o,a;i=!1}}(B,(e=>{var t=0<e.filter((e=>"audio"===e.type)).length;return 1<=e.length&&t&&(K(!1),Y(!1),ue("")),()=>{V([])}}))),[(()=>{const r=ow(),o=r.firstChild,a=o.firstChild,l=a.nextSibling;r.addEventListener("dragenter",we);var p=("function"==typeof(p=u)?le(p,r):u=r,he(r,(()=>{const e=T((()=>!!ee()));return()=>{return e()&&((t=aw()).addEventListener("drop",be),t.addEventListener("dragover",we),t.addEventListener("dragend",we),t.addEventListener("dragleave",we),t.addEventListener("dragenter",we),t);var t}})(),o),he(r,(()=>{const e=T((()=>!(!ee()||!F()?.isImageUploadAllowed)));return()=>e()&&(()=>{const e=lw();return e.firstChild,he(e,z(W,{get each(){return F()?.imgUploadSizeAndTypes},children:e=>{return[(he(r=hw(),(()=>e.fileTypes?.join(", "))),r),(r=cw(),(t=r.firstChild.nextSibling).nextSibling,he(r,(()=>e.maxUploadSize),t),r)];var t,r}}),null),k((()=>null!=h.bubbleBackgroundColor?e.style.setProperty("border-color",h.bubbleBackgroundColor):e.style.removeProperty("border-color"))),e})()})(),o),he(r,(()=>{const e=T((()=>!!h.showTitle));return()=>{if(e()){const e=fw(),t=e.firstChild;return he(e,z(Q,{get when(){return h.titleAvatarSrc},get children(){return[((e=uw()).style.setProperty("width","15px"),e),z(Et,{get initialAvatarSrc(){return h.titleAvatarSrc}})];var e}}),t),he(e,z(Q,{get when(){return h.title},get children(){var e=dw();return he(e,(()=>h.title)),e}}),t),t.style.setProperty("flex","1"),he(e,z(st,{get sendButtonColor(){return h.bubbleTextColor},type:"button",get isDisabled(){return 1===S().length},class:"my-2 ml-2","on:click":fe,get children(){var e=pw();return e.style.setProperty("font-family","Poppins, sans-serif"),e}}),null),k((t=>{var r=h.bubbleBackgroundColor,n=h.bubbleTextColor,s=h.isFullPage?"0px":"6px",i=h.isFullPage?"0px":"6px";return r!==t._v$&&(null!=(t._v$=r)?e.style.setProperty("background",r):e.style.removeProperty("background")),n!==t._v$2&&(null!=(t._v$2=n)?e.style.setProperty("color",n):e.style.removeProperty("color")),s!==t._v$3&&(null!=(t._v$3=s)?e.style.setProperty("border-top-left-radius",s):e.style.removeProperty("border-top-left-radius")),i!==t._v$4&&(null!=(t._v$4=i)?e.style.setProperty("border-top-right-radius",i):e.style.removeProperty("border-top-right-radius")),t}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),e}return null}})(),o),c);return"function"==typeof p?le(p,a):c=a,he(a,z(Q,{get when(){return 0<=S.length},get children(){var e=tw(),t=e.firstChild,r=t.nextSibling;return t.$$click=()=>s("9d890834-eb87-4909-930f-d420fa53a52a"),r.$$click=()=>s("a32245d2-2b55-4580-bd33-b4e046a07c84"),e}}),null),he(a,z(Q,{get when(){return"a32245d2-2b55-4580-bd33-b4e046a07c84"==n()},get children(){var e=rw();return he(e.firstChild,z(W,{get each(){return t()?.jobs},children:e=>{return(n=(r=(t=gw()).firstChild.firstChild.nextSibling.firstChild).nextSibling).firstChild,(s=n.nextSibling).firstChild,he(r,(()=>e.title)),he(n,(()=>e.company),null),he(s,(()=>e.wage),null),t;var t,r,n,s}})),e}}),null),he(a,z(W,{get each(){return b()},children:e=>z(de,{jobMessage:e})}),null),he(a,z(Q,{get when(){return"9d890834-eb87-4909-930f-d420fa53a52a"==n()},get children(){return z(W,{get each(){return[...S()]},children:(e,t)=>[T((()=>{const t=T((()=>"userMessage"===e.type));return()=>t()&&z(qt,{message:e,get apiHost(){return h.apiHost},get chatflowid(){return h.chatflowid},get chatId(){return D()},get backgroundColor(){return h.userMessage?.backgroundColor},get textColor(){return h.userMessage?.textColor},get showAvatar(){return h.userMessage?.showAvatar},get avatarSrc(){return h.userMessage?.avatarSrc}})})()),T((()=>{const t=T((()=>"apiMessage"===e.type));return()=>t()&&z(Kt,{get message(){return e.message},get fileAnnotations(){return e.fileAnnotations},get apiHost(){return h.apiHost},get backgroundColor(){return h.botMessage?.backgroundColor},get textColor(){return h.botMessage?.textColor},get showAvatar(){return h.botMessage?.showAvatar},get avatarSrc(){return h.botMessage?.avatarSrc}})})()),T((()=>{const r=T((()=>!("userMessage"!==e.type||!f()||t()!==S().length-1)));return()=>r()&&z(Yt,{})})()),T((()=>{const r=T((()=>!("apiMessage"!==e.type||""!==e.message||!f()||t()!==S().length-1)));return()=>r()&&z(Yt,{})})()),T((()=>{const t=T((()=>!(!e.sourceDocuments||!e.sourceDocuments.length)));return()=>{return t()&&((r=uw()).style.setProperty("display","flex"),r.style.setProperty("flex-direction","row"),r.style.setProperty("width","100%"),he(r,z(W,{get each(){return[...(e=>{const t=[],r=[];return e.sourceDocuments.forEach((e=>{ge(e.metadata.source)&&!t.includes(e.metadata.source)?(t.push(e.metadata.source),r.push(e)):ge(e.metadata.source)||r.push(e)})),r})(e)]},children:e=>{const t=ge(e.metadata.source);return z(Zt,{get pageContent(){return t?t.pathname:e.pageContent},get metadata(){return e.metadata},onSourceClick:()=>{t?window.open(e.metadata.source,"_blank"):(w(e),v(!0))}})}})),r);var r}})())]})}}),null),he(a,z(Q,{get when(){return T((()=>1===S().length))()&&"9d890834-eb87-4909-930f-d420fa53a52a"==n()},get children(){return z(Q,{get when(){return 0<M().length},get children(){var e=nw();return he(e,z(W,{get each(){return[...M()]},children:e=>z(tr,{prompt:e,onPromptClick:()=>ue(e)})})),e}})}}),null),he(a,z(Q,{get when(){return T((()=>!!i()))()&&"a32245d2-2b55-4580-bd33-b4e046a07c84"==n()},get children(){return sw()}}),null),he(o,z(Q,{get when(){return 0<B().length},get children(){var t=iw();return he(t,z(W,{get each(){return[...B()]},children:t=>T((()=>{const r=T((()=>!!t.mime.startsWith("image/")));return()=>(r()?()=>{const e=mw(),r=e.firstChild,n=r.nextSibling;return e.$$click=()=>_e(t),he(n,z(Xe,{})),k((()=>ie(r,"src",t.data))),e}:()=>{const r=vw(),n=r.firstChild,s=n.nextSibling;return s.$$click=()=>_e(t),he(s,z(Xe,{color:"white"})),k((s=>{var i=`${c?e.isFullPage?c?.offsetWidth/4:c?.offsetWidth/2:"200"}px`,o=t.data;return i!==s._v$5&&(null!=(s._v$5=i)?r.style.setProperty("width",i):r.style.removeProperty("width")),o!==s._v$6&&ie(n,"src",s._v$6=o),s}),{_v$5:void 0,_v$6:void 0}),r})()})())})),t}}),l),he(l,(()=>{const e=T((()=>!!H()));return()=>e()?T((()=>{const e=T((()=>!!J()));return()=>{if(e())return(t=yw()).firstChild.firstChild.nextSibling.$$click=()=>Te(),t;{const e=bw(),t=e.firstChild,r=t.firstChild,n=r.nextSibling,s=t.nextSibling;return e.style.setProperty("margin","auto"),he(r,z(qe,{color:"red"})),he(n,(()=>$()||"00:00")),he(t,(()=>{const e=T((()=>!!X()));return()=>e()&&_w()})(),null),he(s,z(Nn,{get buttonColor(){return h.textInput?.sendButtonColor},type:"button",class:"m-0","on:click":Te,get children(){var e=ww();return e.style.setProperty("font-family","Poppins, sans-serif"),e}}),null),he(s,z(nt,{get sendButtonColor(){return h.textInput?.sendButtonColor},type:"button",get isDisabled(){return f()},class:"m-0","on:click":xe,get children(){var e=ww();return e.style.setProperty("font-family","Poppins, sans-serif"),e}}),null),k((t=>{var r=h.textInput?.backgroundColor??"#0F2D52",n=h.textInput?.textColor??"#303235";return r!==t._v$7&&(null!=(t._v$7=r)?e.style.setProperty("background-color",r):e.style.removeProperty("background-color")),n!==t._v$8&&(null!=(t._v$8=n)?e.style.setProperty("color",n):e.style.removeProperty("color")),t}),{_v$7:void 0,_v$8:void 0}),e}var t}})()):z(wt,{get backgroundColor(){return h.textInput?.backgroundColor},get textColor(){return h.textInput?.textColor},get placeholder(){return h.textInput?.placeholder},get sendButtonColor(){return h.textInput?.sendButtonColor},get fontSize(){return h.fontSize},get disabled(){return f()},get defaultValue(){return d()},onSubmit:pe,get uploadsConfig(){return F()},setPreviews:V,onMicrophoneClicked:ke,handleFileChange:ye})})()),k((()=>oe(r,"relative flex w-full h-full text-base overflow-hidden bg-cover bg-center flex-col items-center chatbot-container "+h.class))),r})(),T((()=>{const e=T((()=>!!m()));return()=>e()&&z(An,{get isOpen(){return m()},get value(){return y()},onClose:()=>v(!1)})})())]},Sw=(se(["click"]),ne("<style>")),Aw=ne('<div part="bot">'),Rw=e=>{const[t]=K(e,["theme"]),[r,n]=_(!1),[s,i]=_(!1);var o;return C((()=>{i(!1)})),[(he(o=Sw(),be),o),z(Ce,G((()=>t.theme?.button),{toggleBot:()=>{r()?n(!1):(s()||i(!0),n(!0))},get isBotOpened(){return r()}})),(()=>{const n=Aw();return n.style.setProperty("transition","transform 200ms cubic-bezier(0, 1.2, 1, 1), opacity 150ms ease-out"),n.style.setProperty("transform-origin","bottom right"),n.style.setProperty("box-shadow","rgb(0 0 0 / 16%) 0px 5px 40px"),n.style.setProperty("z-index","42424242"),he(n,z(Q,{get when(){return s()},get children(){return z(Cw,{get badgeBackgroundColor(){return t.theme?.chatWindow?.backgroundColor},get bubbleBackgroundColor(){return t.theme?.button?.backgroundColor??"#3B81F6"},get bubbleTextColor(){return t.theme?.button?.iconColor??"white"},get showTitle(){return t.theme?.chatWindow?.showTitle},get title(){return t.theme?.chatWindow?.title},get titleAvatarSrc(){return t.theme?.chatWindow?.titleAvatarSrc},get welcomeMessage(){return t.theme?.chatWindow?.welcomeMessage},get poweredByTextColor(){return t.theme?.chatWindow?.poweredByTextColor},get textInput(){return t.theme?.chatWindow?.textInput},get botMessage(){return t.theme?.chatWindow?.botMessage},get userMessage(){return t.theme?.chatWindow?.userMessage},get fontSize(){return t.theme?.chatWindow?.fontSize},get chatflowid(){return e.chatflowid},get chatflowConfig(){return e.chatflowConfig},get apiHost(){return e.apiHost},get observersConfig(){return e.observersConfig}})}})),k((s=>{var i=t.theme?.chatWindow?.height?t.theme?.chatWindow?.height.toString()+"px":"calc(100% - 100px)",o=t.theme?.chatWindow?.width?t.theme?.chatWindow?.width.toString()+"px":void 0,a=r()?"scale3d(1, 1, 1)":"scale3d(0, 0, 1)",l=t.theme?.chatWindow?.backgroundColor||"#ffffff",h="fixed sm:right-5 rounded-lg w-full sm:w-[400px] max-h-[704px]"+(r()?" opacity-1":" opacity-0 pointer-events-none")+("large"===e.theme?.button?.size?" bottom-24":" bottom-20");return i!==s._v$&&(null!=(s._v$=i)?n.style.setProperty("height",i):n.style.removeProperty("height")),o!==s._v$2&&(null!=(s._v$2=o)?n.style.setProperty("width",o):n.style.removeProperty("width")),a!==s._v$3&&(null!=(s._v$3=a)?n.style.setProperty("transform",a):n.style.removeProperty("transform")),l!==s._v$4&&(null!=(s._v$4=l)?n.style.setProperty("background-color",l):n.style.removeProperty("background-color")),h!==s._v$5&&oe(n,s._v$5=h),s}),{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0}),n})()]},Nw=ne("<style>"),Ow=ne("<div>"),Pw=(e,{element:t})=>{const[r,n]=_(!1),s=new IntersectionObserver((e=>{e.some((e=>e.isIntersecting))&&n(!0)}));return I((()=>{s.observe(t)})),C((()=>{s.disconnect()})),[(he(i=Nw(),be),i),z(Q,{get when(){return r()},get children(){const t=Ow();return t.style.setProperty("margin","0px"),he(t,z(Cw,{get badgeBackgroundColor(){return e.theme?.chatWindow?.backgroundColor},get bubbleBackgroundColor(){return e.theme?.button?.backgroundColor??"#3B81F6"},get bubbleTextColor(){return e.theme?.button?.iconColor??"white"},get showTitle(){return e.theme?.chatWindow?.showTitle},get title(){return e.theme?.chatWindow?.title},get titleAvatarSrc(){return e.theme?.chatWindow?.titleAvatarSrc},get welcomeMessage(){return e.theme?.chatWindow?.welcomeMessage},get poweredByTextColor(){return e.theme?.chatWindow?.poweredByTextColor},get textInput(){return e.theme?.chatWindow?.textInput},get botMessage(){return e.theme?.chatWindow?.botMessage},get userMessage(){return e.theme?.chatWindow?.userMessage},get fontSize(){return e.theme?.chatWindow?.fontSize},get chatflowid(){return e.chatflowid},get chatflowConfig(){return e.chatflowConfig},get apiHost(){return e.apiHost},isFullPage:!0,get observersConfig(){return e.observersConfig}})),k((r=>{var n=e.theme?.chatWindow?.backgroundColor||"#ffffff",s=e.theme?.chatWindow?.height?e.theme?.chatWindow?.height.toString()+"px":"100vh",i=e.theme?.chatWindow?.width?e.theme?.chatWindow?.width.toString()+"px":"100%";return n!==r._v$&&(null!=(r._v$=n)?t.style.setProperty("background-color",n):t.style.removeProperty("background-color")),s!==r._v$2&&(null!=(r._v$2=s)?t.style.setProperty("height",s):t.style.removeProperty("height")),i!==r._v$3&&(null!=(r._v$3=i)?t.style.setProperty("width",i):t.style.removeProperty("width")),r}),{_v$:void 0,_v$2:void 0,_v$3:void 0}),t}})];var i};let Dw;const Lw=e=>{Uw();var t=e.id?document.getElementById(e.id):document.querySelector("flowise-fullchatbot");if(!t)throw new Error("<flowise-fullchatbot> element not found.");Object.assign(t,e),Dw=t},Mw=e=>{Uw();var t=document.createElement("flowise-chatbot");Object.assign(t,e),document.body.appendChild(t),Dw=t},Uw=()=>{Dw?.remove()},Fw=("undefined"!=typeof window&&(ye("flowise-fullchatbot",we,Pw),ye("flowise-chatbot",we,Rw)),{initFull:Lw,init:Mw,destroy:Uw});(e=>{"undefined"!=typeof window&&(window.Chatbot={...e})})(Fw);export{Fw as default};
